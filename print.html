<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Documentation Club Robot Insa Toulouse</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="outils_communs/index.html"><strong aria-hidden="true">2.</strong> ‚öôÔ∏è Outils Communs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="outils_communs/git.html"><strong aria-hidden="true">2.1.</strong> Git</a></li><li class="chapter-item expanded "><a href="outils_communs/dual_boot.html"><strong aria-hidden="true">2.2.</strong> Dual Boot</a></li><li class="chapter-item expanded "><a href="outils_communs/ide.html"><strong aria-hidden="true">2.3.</strong> IntelliJ et STM32Cube</a></li></ol></li><li class="chapter-item expanded "><a href="management/index.html"><strong aria-hidden="true">3.</strong> üßë‚Äçüíº Organisation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="management/gestion_de_projet.html"><strong aria-hidden="true">3.1.</strong> Gestion de projet</a></li><li class="chapter-item expanded "><a href="management/gestion_de_lequipe.html"><strong aria-hidden="true">3.2.</strong> Gestion de l'√©quipe</a></li><li class="chapter-item expanded "><a href="management/gestion_de_la_communication.html"><strong aria-hidden="true">3.3.</strong> Gestion de la communication</a></li><li class="chapter-item expanded "><a href="management/gestion_de_la_documentation.html"><strong aria-hidden="true">3.4.</strong> Gestion de la documentation</a></li></ol></li><li class="chapter-item expanded "><a href="regles_cdf_2024.html"><strong aria-hidden="true">4.</strong> üìè R√®gles Coupe de France 2024</a></li><li class="chapter-item expanded "><a href="architecture.html"><strong aria-hidden="true">5.</strong> üìà Architecture du projet</a></li><li class="chapter-item expanded "><a href="informatique/index.html"><strong aria-hidden="true">6.</strong> üíª Informatique</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="informatique/mise_en_place/index.html"><strong aria-hidden="true">6.1.</strong> Mise en place</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="informatique/mise_en_place/connexion_a_la_raspberry.html"><strong aria-hidden="true">6.1.1.</strong> Connexion √† la Raspberry</a></li><li class="chapter-item expanded "><a href="informatique/mise_en_place/ide.html"><strong aria-hidden="true">6.1.2.</strong> IDE</a></li><li class="chapter-item expanded "><a href="informatique/mise_en_place/repertoire_de_travail.html"><strong aria-hidden="true">6.1.3.</strong> R√©pertoire de travail</a></li><li class="chapter-item expanded "><a href="informatique/mise_en_place/python.html"><strong aria-hidden="true">6.1.4.</strong> Python</a></li><li class="chapter-item expanded "><a href="informatique/mise_en_place/ros2_dev_container_setup.html"><strong aria-hidden="true">6.1.5.</strong> ROS2 dev environment</a></li></ol></li><li class="chapter-item expanded "><a href="informatique/architecture.html"><strong aria-hidden="true">6.2.</strong> Architecture du code</a></li><li class="chapter-item expanded "><a href="informatique/communication.html"><strong aria-hidden="true">6.3.</strong> Communication avec le hardware</a></li><li class="chapter-item expanded "><a href="informatique/lidar.html"><strong aria-hidden="true">6.4.</strong> D√©tection de l'adversaire : LIDAR</a></li><li class="chapter-item expanded "><a href="informatique/robot.html"><strong aria-hidden="true">6.5.</strong> Cr√©ation d'un robot</a></li><li class="chapter-item expanded "><a href="informatique/ros2-random-issues.html"><strong aria-hidden="true">6.6.</strong> ROS2 issues</a></li></ol></li><li class="chapter-item expanded "><a href="elec_soft/index.html"><strong aria-hidden="true">7.</strong> üë®‚Äçüíª Electronique Logicielle</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="elec_soft/organisation/index.html"><strong aria-hidden="true">7.1.</strong> Organisation du code</a></li><li class="chapter-item expanded "><a href="elec_soft/rust.html"><strong aria-hidden="true">7.2.</strong> Guide d'utilisation Rust</a></li><li class="chapter-item expanded "><a href="elec_soft/c.html"><strong aria-hidden="true">7.3.</strong> Guide d'utilisation C</a></li><li class="chapter-item expanded "><a href="elec_soft/compilation.html"><strong aria-hidden="true">7.4.</strong> Comment compiler</a></li><li class="chapter-item expanded "><a href="elec_soft/flashage.html"><strong aria-hidden="true">7.5.</strong> Comment flasher</a></li><li class="chapter-item expanded "><a href="elec_soft/debug.html"><strong aria-hidden="true">7.6.</strong> Comment debugger</a></li><li class="chapter-item expanded "><a href="elec_soft/modules/index.html"><strong aria-hidden="true">7.7.</strong> Communication des modules avec l'info</a></li></ol></li><li class="chapter-item expanded "><a href="elec_hard/index.html"><strong aria-hidden="true">8.</strong> ‚ö° Electronique Mat√©rielle (Elec-hard)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="elec_hard/introduction.html"><strong aria-hidden="true">8.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="elec_hard/Etapes-design.html"><strong aria-hidden="true">8.2.</strong> Proc√©d√© de design</a></li><li class="chapter-item expanded "><a href="elec_hard/PCB.html"><strong aria-hidden="true">8.3.</strong> Qu'est-ce qu'un PCB ?</a></li><li class="chapter-item expanded "><a href="elec_hard/KiCad.html"><strong aria-hidden="true">8.4.</strong> Une introduction au KiCad</a></li><li class="chapter-item expanded "><a href="elec_hard/Fabrication.html"><strong aria-hidden="true">8.5.</strong> Fabrication</a></li><li class="chapter-item expanded "><a href="elec_hard/design-rules.html"><strong aria-hidden="true">8.6.</strong> R√®gles de jeu - checklist</a></li><li class="chapter-item expanded "><a href="elec_hard/autres/index.html"><strong aria-hidden="true">8.7.</strong> Autres</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="elec_hard/autres/Moteur-Pas_a_pas.html"><strong aria-hidden="true">8.7.1.</strong> Moteur pas √† pas</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="mecanique/index.html"><strong aria-hidden="true">9.</strong> ü¶æ M√©canique</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="mecanique/creo.html"><strong aria-hidden="true">9.1.</strong> Guide d'utilisation Creo</a></li><li class="chapter-item expanded "><a href="mecanique/decoupeuse_laser.html"><strong aria-hidden="true">9.2.</strong> Utilisation de la d√©coupeuse laser</a></li><li class="chapter-item expanded "><a href="mecanique/imprimante_3d.html"><strong aria-hidden="true">9.3.</strong> Utilisation de l'imprimante 3D</a></li><li class="chapter-item expanded "><a href="mecanique/fraiseuse.html"><strong aria-hidden="true">9.4.</strong> Utilisation de la fraiseuse</a></li><li class="chapter-item expanded "><a href="mecanique/robot/index.html"><strong aria-hidden="true">9.5.</strong> Robot</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="mecanique/robot/base_roulante.html"><strong aria-hidden="true">9.5.1.</strong> Base roulante</a></li><li class="chapter-item expanded "><a href="mecanique/robot/bras_robotique.html"><strong aria-hidden="true">9.5.2.</strong> Bras robotique</a></li><li class="chapter-item expanded "><a href="mecanique/robot/conception_modulaire.html"><strong aria-hidden="true">9.5.3.</strong> Conception modulaire</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="retour_dexperiences/index.html"><strong aria-hidden="true">10.</strong> üí°Retour d'exp√©riences</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="retour_dexperiences/retour_dexperiences/cdf_2024.html"><strong aria-hidden="true">10.1.</strong> Ann√©e 2023-2024</a></li><li class="chapter-item expanded "><a href="retour_dexperiences/retour_dexperiences/cdf_2023.html"><strong aria-hidden="true">10.2.</strong> Ann√©e 2022-2023</a></li><li class="chapter-item expanded "><a href="retour_dexperiences/retour_dexperiences/cdf_2022.html"><strong aria-hidden="true">10.3.</strong> Ann√©e 2021-2022</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/doc-pre-2021-index.html"><strong aria-hidden="true">11.</strong> üìö Doc pre-2021</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/intro.html"><strong aria-hidden="true">11.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="pre_2021/outils_communs/index.html"><strong aria-hidden="true">11.2.</strong> Outils Communs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/outils_communs/dual_boot.html"><strong aria-hidden="true">11.2.1.</strong> Dual Boot</a></li><li class="chapter-item expanded "><a href="pre_2021/outils_communs/git.html"><strong aria-hidden="true">11.2.2.</strong> Git</a></li><li class="chapter-item expanded "><a href="pre_2021/outils_communs/ide.html"><strong aria-hidden="true">11.2.3.</strong> CLion</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/info/index.html"><strong aria-hidden="true">11.3.</strong> Informatique</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/info/mise_en_place/index.html"><strong aria-hidden="true">11.3.1.</strong> Mise en place</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/info/mise_en_place/ide.html"><strong aria-hidden="true">11.3.1.1.</strong> IDE</a></li><li class="chapter-item expanded "><a href="pre_2021/info/mise_en_place/repertoire_de_travail.html"><strong aria-hidden="true">11.3.1.2.</strong> R√©pertoire de travail</a></li><li class="chapter-item expanded "><a href="pre_2021/info/mise_en_place/compilation.html"><strong aria-hidden="true">11.3.1.3.</strong> Compilation</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/info/outils/index.html"><strong aria-hidden="true">11.3.2.</strong> Prise en main des outils</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/info/outils/cmake.html"><strong aria-hidden="true">11.3.2.1.</strong> CMake</a></li><li class="chapter-item expanded "><a href="pre_2021/info/outils/petrilab.html"><strong aria-hidden="true">11.3.2.2.</strong> PetriLab</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/info/explications/index.html"><strong aria-hidden="true">11.3.3.</strong> Explications du code</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/info/explications/racine.html"><strong aria-hidden="true">11.3.3.1.</strong> Architecture de la racine</a></li><li class="chapter-item expanded "><a href="pre_2021/info/explications/architecture.html"><strong aria-hidden="true">11.3.3.2.</strong> Vue globale du projet</a></li><li class="chapter-item expanded "><a href="pre_2021/info/explications/communication.html"><strong aria-hidden="true">11.3.3.3.</strong> Communication avec le hardware</a></li><li class="chapter-item expanded "><a href="pre_2021/info/explications/lidar.html"><strong aria-hidden="true">11.3.3.4.</strong> D√©tection de l'adversaire : LIDAR</a></li><li class="chapter-item expanded "><a href="pre_2021/info/explications/robot.html"><strong aria-hidden="true">11.3.3.5.</strong> Cr√©ation d'un robot</a></li><li class="chapter-item expanded "><a href="pre_2021/info/explications/simu.html"><strong aria-hidden="true">11.3.3.6.</strong> Architecture du simulateur</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/elec_soft/index.html"><strong aria-hidden="true">11.4.</strong> Electronique Logicielle</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/elec_soft/organisation/index.html"><strong aria-hidden="true">11.4.1.</strong> Organisation du code</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_soft/mise_en_place/index.html"><strong aria-hidden="true">11.4.2.</strong> Mise en place</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/elec_soft/mise_en_place/compile.html"><strong aria-hidden="true">11.4.2.1.</strong> Compilation</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_soft/mise_en_place/repo.html"><strong aria-hidden="true">11.4.2.2.</strong> R√©pertoire de travail</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_soft/mise_en_place/ide.html"><strong aria-hidden="true">11.4.2.3.</strong> IDE</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_soft/mise_en_place/flash.html"><strong aria-hidden="true">11.4.2.4.</strong> Flashage</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/elec_soft/apprendre_rust.html"><strong aria-hidden="true">11.4.3.</strong> Apprendre Rust</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_soft/modules/index.html"><strong aria-hidden="true">11.4.4.</strong> Communication des modules avec l'info</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/elec_mat/index.html"><strong aria-hidden="true">11.5.</strong> Electronique mat√©rielle</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/elec_mat/mise_en_place/tools.html"><strong aria-hidden="true">11.5.1.</strong> Mise en place</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/elec_mat/mise_en_place/folders.html"><strong aria-hidden="true">11.5.1.1.</strong> Organisation</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_mat/mise_en_place/install_git.html"><strong aria-hidden="true">11.5.1.2.</strong> Installation</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/elec_mat/kicad.html"><strong aria-hidden="true">11.5.2.</strong> Pr√©parer ta carte</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_mat/tips&tricks.html"><strong aria-hidden="true">11.5.3.</strong> Conseils et outils usuels</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_mat/production.html"><strong aria-hidden="true">11.5.4.</strong> Tirer une carte</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_mat/references/index.html"><strong aria-hidden="true">11.5.5.</strong> R√©f√©rences</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/elec_mat/references/ethernet.html"><strong aria-hidden="true">11.5.5.1.</strong> Utilisation du module ethernet</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_mat/references/ref_cartes.html"><strong aria-hidden="true">11.5.5.2.</strong> Annexe : liste des cartes du Club</a></li><li class="chapter-item expanded "><a href="pre_2021/elec_mat/references/ref_composants.html"><strong aria-hidden="true">11.5.5.3.</strong> Annexe : liste des composants usuels</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/elec_mat/cablage.html"><strong aria-hidden="true">11.5.6.</strong> Cablage Robot</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/reference/index.html"><strong aria-hidden="true">11.6.</strong> Documents de r√©f√©rence</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/reference/commun.html"><strong aria-hidden="true">11.6.1.</strong> Communs</a></li><li class="chapter-item expanded "><a href="pre_2021/reference/deplacement.html"><strong aria-hidden="true">11.6.2.</strong> Carte d√©placement</a></li><li class="chapter-item expanded "><a href="pre_2021/reference/servomoteur.html"><strong aria-hidden="true">11.6.3.</strong> Carte servomoteur</a></li><li class="chapter-item expanded "><a href="pre_2021/reference/evitement.html"><strong aria-hidden="true">11.6.4.</strong> Carte √©vitement</a></li><li class="chapter-item expanded "><a href="pre_2021/reference/couleur.html"><strong aria-hidden="true">11.6.5.</strong> Carte capteur couleur</a></li><li class="chapter-item expanded "><a href="pre_2021/reference/pompe.html"><strong aria-hidden="true">11.6.6.</strong> Carte pompe √† vide</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/com/index.html"><strong aria-hidden="true">11.7.</strong> Communication (test)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/com/int/index.html"><strong aria-hidden="true">11.7.1.</strong> Interne (entre nous)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/com/int/gitter.html"><strong aria-hidden="true">11.7.1.1.</strong> Gitter</a></li><li class="chapter-item expanded "><a href="pre_2021/com/int/fb.html"><strong aria-hidden="true">11.7.1.2.</strong> Messenger/Facebook</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/com/ext/index.html"><strong aria-hidden="true">11.7.2.</strong> Externe</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pre_2021/com/ext/site.html"><strong aria-hidden="true">11.7.2.1.</strong> Site</a></li><li class="chapter-item expanded "><a href="pre_2021/com/ext/fb.html"><strong aria-hidden="true">11.7.2.2.</strong> Page Facebook</a></li></ol></li><li class="chapter-item expanded "><a href="pre_2021/com/res/md.html"><strong aria-hidden="true">11.7.3.</strong> Ressources & images</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Documentation Club Robot Insa Toulouse</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p><img src="images/com/logo_2021_Club_Robot.svg" alt="" title="Logo du Club Robot" /></p>
<h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Ce site internet contient la documentation du Club Robot de l'INSA Toulouse pour les parties √©lectronique et informatique du robot.</p>
<p>Ce livre est r√©dig√© avec <a href="https://github.com/rust-lang-nursery/mdBook">md-book</a>.</p>
<p>Le but de ce livre est de te guider pour l'installation des diff√©rents outils permettant de programmer au Club Robot.</p>
<p>Ce livre ne documentera pas le code du club, mais peut documenter les diff√©rents fichiers d'un projet. Il est l√† pour servir de r√©f√©rence en cas de probl√®me et de questions vis √† vis d'un fichier.</p>
<p>Sa lecture est pr√©liminaire √† la formation organis√©e en d√©but d'ann√©e, et son but est de nous faire gagner du temps en vous faisant installer √† la maison les outils de d√©vellopement.</p>
<p>Enfin, son √©criture a commenc√© apr√®s Chocobot √† la coupe de france de 2018 (Robot Cities). Temporairement arr√™t√© en 2020, remplac√© par Notion, il est repris en 2023.</p>
<p>Si jamais tu trouves des fautes d'orthographes, des erreurs, des remarques ou toutes autres formes de contribution √† faire n'h√©site <strong>surtout pas</strong>. Les sources de ce livre sont sur <a href="https://github.com/ClubRobotInsat/doc">ce repertoire GitHub</a>, et il n'y a pas besoin de <code>git</code> pour y apporter des modifications simples : l'interface en ligne de github te permet de modifier les fichiers textes et de cr√©er ton premier <em>commit</em> en quelques secondes! Il faut juste penser √† demander aux membres du club d'ajouter ton compte dans la liste des utilisateurs autoris√©s.</p>
<p>Enfin, la phrase la plus importante en informatique √† garder en t√™te durant toute ta formation :</p>
<blockquote>
<p>Le mieux est l'ennemi du bien, surtout au club robot.</p>
</blockquote>
<p><em>Un illustre anonyme</em></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="outils-communs"><a class="header" href="#outils-communs">Outils communs</a></h1>
<p>Cette section r√©pertorie les principaux outils utilis√©s au Club Robot.</p>
<p>Ce tableau t'aidera √† savoir quelles pages t'int√©ressent en fonction de ton p√¥le de pr√©dilection :</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center"></th><th style="text-align: center"><a href="outils_communs/outils_communs/git.html">git</a></th><th style="text-align: center"><a href="outils_communs/outils_communs/ide.html">IntelliJ</a></th><th style="text-align: center"><a href="outils_communs/outils_communs/kicad.html">Kicad</a></th><th style="text-align: center"><a href="outils_communs/outils_communs/creo.html">Creo</a></th></tr></thead><tbody>
<tr><td style="text-align: center">Informatique</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: center">Electronique software</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center"></td></tr>
<tr><td style="text-align: center">Electronique hardware</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center"></td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center"></td></tr>
<tr><td style="text-align: center">M√©canique</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center">‚úîÔ∏è</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="git"><a class="header" href="#git">Git</a></h1>
<p><em>Cette page s'adresse √† tous les membres du Club.</em></p>
<p>On utilise <code>git</code> pour g√©rer les versions de nos projets. C'est un outil tr√®s puissant, mais qui peut √™tre un peu d√©routant au d√©but. Cette page a pour but de te guider dans l'utilisation de <code>git</code> au Club Robot.</p>
<p>Ce choix a de tr√®s nombreux avantages :</p>
<ul>
<li>L'√©volution de tout le code est sauvegard√©e donc on peut rappeler une version ant√©rieure d'un fichier √† tout moment</li>
<li>Si on perd des fichiers ou que l'on se trompe, on peut facilement revenir √† un √©tat stable</li>
<li><code>git</code> permets de collaborer sur un m√™me code, c'est √† dire que plusieurs d√©veloppeurs peuvent participer au code et le logiciel s'occupe de rassembler l'ensemble des modifications</li>
<li>On peut profiter de tous ces avantages avec tr√®s peu de travail suppl√©mentaire</li>
</ul>
<p>On h√©berge nos projets sur <a href="https://github.com/ClubRobotInsat">GitHub</a>. C'est un site qui permet de g√©rer des projets <code>git</code> en ligne. Il est tr√®s pratique car il permet de visualiser les modifications, de g√©rer les diff√©rentes versions, de faire des <em>pull requests</em> pour proposer des modifications, etc.</p>
<p><strong>Si vous n'√™tes pas √† l'aise avec <code>git</code> en ligne de commande, vous pouvez utiliser la version en ligne de GitHub.</strong> Elle est tr√®s bien faite et permet de faire la plupart des choses que l'on fait en ligne de commande.</p>
<h2 id="installation-de-git"><a class="header" href="#installation-de-git">Installation de <code>git</code></a></h2>
<p>Afin de b√©n√©ficier de tous les avantages de <code>git</code>, il n'y a rien de plus simple : il suffit d'ex√©cuter la commande suivante.</p>
<pre><code class="language-bash">sudo apt update
sudo apt install git
</code></pre>
<p><em><strong>Astuce :</strong></em> pour v√©rifier que l'installation d'une application a bien march√©, tu peux appeler la commande <code>which</code> qui te retourne le chemin vers l'ex√©cutable, ou encore l'ex√©cuter avec le flag <code>--version</code> :</p>
<pre><code class="language-bash">$ which git
/usr/bin/git

$ git version
git version 2.34.1
</code></pre>
<h2 id="apprendre-√†-utiliser-git"><a class="header" href="#apprendre-√†-utiliser-git">Apprendre √† utiliser <code>git</code></a></h2>
<h3 id="apprendre-en-ligne"><a class="header" href="#apprendre-en-ligne">Apprendre en ligne</a></h3>
<p><code>git</code> est un logiciel extr√™mement pratique une fois qu'on l'a pris en main. Cependant, il peut √™tre un peu d√©routant au d√©but. Il existe de nombreux tutoriels en ligne pour apprendre √† l'utiliser. En voici quelques uns :</p>
<ul>
<li><a href="https://learngitbranching.js.org/">apprendre visuellement git</a> : un site qui permet d'apprendre √† utiliser <code>git</code> en ligne de commande en visualisant les modifications</li>
<li><a href="https://rogerdudler.github.io/git-guide/index.fr.html">git - petit guide</a> : un guide tr√®s simple pour apprendre les bases de <code>git</code></li>
</ul>
<p>Vu qu'il sait faire de tr√®s nombreuses choses, ce n'est bien s√ªr pas la peine d'apprendre toutes ses commandes par coeur. Voici des <em>Cheat Sheets</em> qui vont te faire gagner du temps :</p>
<ul>
<li><a href="https://services.github.com/on-demand/downloads/github-git-cheat-sheet.pdf">Cheat sheet de GitHub (en)</a></li>
<li><a href="https://services.github.com/on-demand/downloads/fr/github-git-cheat-sheet.pdf">Chear sheet de GitHub (fr)</a></li>
<li><a href="https://www.git-tower.com/blog/git-cheat-sheet/">Cheat sheet de Tower</a></li>
</ul>
<h3 id="ba-ba-des-commandes"><a class="header" href="#ba-ba-des-commandes">B.A.-BA des commandes</a></h3>
<p>Si tu as besoin d'aide pour utiliser <code>git</code>, les forums de <a href="http://stackoverflow.com/">StackOverflow</a> te permettent de r√©pondre √† tes questions les plus complexes.</p>
<p>Ensuite, voici une <a href="https://git-scm.com/docs">documentation d'API</a> des diff√©rentes fonctions.</p>
<p>En g√©n√©ral cependant, tu vas devoir utiliser le m√™me socle de commandes et le but de ce paragraphe est de te lister le <em><strong>template</strong></em> de commandes √† utiliser ; je t'invite n√©anmoins √† aller lire la documentation de chacune de ces commandes pour voir √† quel point elles peuvent √™tre puissantes.</p>
<ol>
<li>
<p>Avant de commencer √† travailler, il faut r√©cup√©rer le travail r√©aliser par les autres d√©veloppeurs. Si tu as d√©j√† des <code>commit</code>s en local, tu peux sp√©cifier le flag <code>--rebase</code> pour avoir une architecture lin√©aire ; sinon <code>git</code> va <code>merge</code>r la branche locale et celle distante m√™me pour des int√©grations triviales.</p>
<ul>
<li><code>git pull [--rebase]</code></li>
</ul>
</li>
<li>
<p>√Ä pr√©sent, √† toi de faire des modifications pour contribuer au d√©p√¥t. Une fois que tu as fini et que tu veux cr√©er un paquet qui contient ta nouveaut√©, il faut demander √† <code>git</code> de rajouter toutes tes modifications int√©ressantes. Tu peux √©galement conna√Ætre les modfications que tu as faites soit fichier par fichier, soit ligne par ligne. Bien s√ªr, tu peux restreindre la recherche √† un document ou √† des fichiers en particulier en les rajoutant √† la fin.</p>
<ul>
<li><code>git status</code> te liste tous les fichiers qui ont √©t√© modifi√©s / supprim√©s / cr√©√©s</li>
<li><code>git diff</code> te montre toutes les additions et d√©l√©tions dans le code pour l'ensemble de ces fichiers</li>
</ul>
</li>
<li>
<p>Il est temps de choisir les modifications que tu veux sauvegarder dans l'arborescence de <code>git</code>. Il y a plusieurs moyens d'y arriver en utilisant <code>git add</code> et <code>git reset</code> :</p>
<ul>
<li><code>git add *</code> te permets d'ajouter TOUTES les modifications, il ne faut donc pas l'utiliser si tu travailles sur plusieurs projets en m√™me temps</li>
<li><code>git add &lt;file 1&gt; [file 2] [...]</code> ajoute les modifications de chaque fichier / dossier dans leur ensemble. Si tu cr√©es un nouveau fichier, il faut utiliser cette m√©thode pour l'ajouter et non pas la suivante.</li>
<li><code>git add -p</code> permets de mixer <code>add</code> et <code>diff</code> ; il s'agit d'une m√©thode particuli√®rement efficace si tu as besoin de sauvegarder seulement quelques lignes et non pas l'ensemble des modifications sur un fichier. Une interface s'ouvre et tu peux choisir d'accepter avec <code>y</code> ou de refuser les modifications avec <code>n</code> ; d'autres commandes sont possibles notamment <code>q</code> pour quitter.</li>
<li><code>git reset</code> te permets d'annuler l'insertion des modifications dans la sauvegarde de <code>git</code> (mais il ne reset pas les modifications du fichier, rassure-toi). Tu peux √©galement lui donner l'argument <code>-p</code> pour acc√©der √† l'interface int√©ractive.</li>
</ul>
</li>
<li>
<p>Tu peux v√©rifier que tu as ajouter les bonnes modifications en appelant de nouveau</p>
<ul>
<li><code>git status</code> pour voir les fichiers</li>
<li><code>git diff --staged</code> pour voir les modifications dans le code</li>
</ul>
</li>
<li>
<p>Il est enfin temps de cr√©er le 'paquet' de modifications, appel√© <code>commit</code>. Afin de pouvoir s'y retrouver plus facilement, les <code>commit</code>s ont chacun un num√©ro unique (appel√© hash ; il a cette t√™te : <code>44bf09d0a2c36585aed1c34ba2e5d958a9379718</code> et est g√©n√©r√© automatiquement) et √©galement un message que tu dois choisir pour expliquer ce √† quoi il sert. C'est tr√®s int√©ressant de cr√©er un <code>commit</code> par fonctionnalit√©, et donc qui modifie √©ventuellement plusieurs fichiers, afin de pouvoir relire l'historique ensuite. Pense donc √† en r√©aliser plusieurs au cours de ton travail, tu pourras facilement revenir √† des versions pr√©c√©dentes ce qui est tr√®s b√©n√©fique !</p>
<ul>
<li><code>git commit -m &lt;message&gt;</code></li>
<li><code>git commit --amend</code> te permets de juste rajouter des modifications au dernier commit pour ne faire qu'un seul paquet avec les anciennes et nouvelles modifs.</li>
</ul>
</li>
<li>
<p>Maintenant que tu as cr√©√© plusieurs <code>commit</code>s, tu peux v√©rifier que tout s'est bien pass√© en faisant appel √† l'historique. Tu pourras y observer le num√©ro de chaque commit, leur auteur, leur date de cr√©ation ainsi que leur message d'accompagnement.</p>
<ul>
<li><code>git log</code></li>
</ul>
</li>
<li>
<p>Enfin, les modifications que tu viens de faire ont pour but d'√™tre partag√©es aux autres d√©veloppeurs et donc envoy√©s sur le d√©p√¥t distant de <a href="https://github.com/orgs/ClubRobotInsat/">github.com</a>. Normalement, si tu as bien suivi les √©tapes de clonage pr√©sent√©es un peu plus bas, tout devrait √™tre d√©j√† configur√© pour n'avoir qu'√† taper ceci :</p>
<ul>
<li><code>git push -u origin &lt;branch&gt;</code> la premi√®re fois pour demander √† envoyer les <code>commit</code>s sur le flux <code>origin</code>, c'est √† dire github, correspondant √† la branche actuelle (par exemple <code>master</code>)</li>
<li><code>git push</code> les fois suivantes ; tout va marcher ensuite √† condition d'avoir une connexion internet :wink:</li>
</ul>
</li>
</ol>
<p>Je n'ai pas parl√© d'un certain nombre de commandes car tu ne devrais pas les utiliser quotidiennement. Voici une liste de fonctione n√©anmoins int√©ressantes dont tu peux aller voir la documentation :</p>
<ul>
<li><code>git branch</code> - notion que je n'ai que tr√®s peu abord√©e, <code>git</code> travaille avec des branches pour faciliter le travail sur plusieurs projets en parall√®le</li>
<li><code>git checkout</code> - permets de se ballader d'une branche √† une autre branche ou √† un commit en particulier</li>
<li><code>git reset</code> - id√©l pour enlever les modifs d'un <code>git add</code> et pour supprimer des <code>commit</code>s foireux pr√©sents localement</li>
<li><code>git revert</code> - applique les modifications compl√©mentaires √† un commit, id√©al pour annuler un commit foireux d√©j√† envoy√© sur le serveur</li>
<li><code>git merge</code> - permets √† deux branches de fusionner ; fonctionnalit√© sympa pour travailler ind√©pendamment sur un projet puis l'int√©grer dans la branche principale une fois qu'il est fonctionnel</li>
<li><code>git rebase</code> - permets de copier des commits pour avoir une arborescence plus lin√©aire</li>
<li><code>git rebase -i</code> - fen√™tre int√©ractive pour r√©organiser les commits comme tu veux</li>
<li><code>cherry-pick</code> - copie un ensemble de commits √† l'endroit actuel, ce qui simplifie l'utilisation d'un <code>git rebase</code></li>
<li><code>git stash</code> - m√©morise des modifications dans un endroit √† part ; √ßa te permets de sauvegarder un travail qui ne compile pas par exemple. Options int√©ressantes : <code>drop</code>, <code>pop</code>, <code>list</code>, <code>show</code>, <code>save &lt;NAME&gt;</code>, <code>-p</code>.</li>
<li><code>git tag</code> - marque permannante sur un commit pour y acc√©der n'importe quand (√† sa cr√©ation, il faut appeler <code>git push --follow-tags</code> pour le partager avec tout le monde).</li>
<li><code>git fetch</code> - t√©l√©charge les infos sur le d√©p√¥t distant ; contrairement √† <code>git pull</code>, aucun <code>merge</code> n'est r√©alis√© entre le d√©p√¥t localement et celui √† distance, donc cette commande est tr√®s peu utilis√©e</li>
</ul>
<h2 id="cr√©ation-dun-compte-github"><a class="header" href="#cr√©ation-dun-compte-github">Cr√©ation d'un compte <a href="https://github.com">GitHub</a></a></h2>
<p>Afin de partager notre travail, on utilise les serveurs de GitHub. Il s'agit d'un service web qui offre une interface graphique √† <code>git</code> tout en permettant de r√©cup√©rer les projets du Club n'importe o√π.</p>
<p>Il faut donc que tu te cr√©es un compte sur le site : <a href="https://github.com/">github.com</a>.</p>
<p>Une fois que c'est fait, demande √† un membre du Club de t'ajouter dans l'organisation <a href="https://github.com/orgs/ClubRobotInsat/">ClubRobotINSAT</a>.</p>
<h2 id="configuration-de-git"><a class="header" href="#configuration-de-git">Configuration de <code>git</code></a></h2>
<p>Il faut configurer ton ordinateur pour qu'il te connaisse, voici comment :</p>
<ol>
<li>Ton nom associ√© aux <code>commit</code>
<ul>
<li><code>git config --global user.name "[ton nom]"</code></li>
</ul>
</li>
<li>Ton adresse mail associ√©e aux <code>commit</code> (de pr√©f√©rence celle utilis√©e lors de la cr√©ation de ton compte GitHub)
<ul>
<li><code>git config --global user.email "[ton adresse mail]"</code></li>
</ul>
</li>
<li>Colorisation des lignes (pas obligatoire mais pratique)
<ul>
<li><code>git config --global color.ui auto</code></li>
</ul>
</li>
</ol>
<h2 id="2-m√©thodes-pour-cloner-les-d√©p√¥ts"><a class="header" href="#2-m√©thodes-pour-cloner-les-d√©p√¥ts">2 m√©thodes pour <code>clone</code>r les d√©p√¥ts</a></h2>
<h3 id="m√©thode-simple-avec-https-d√©pr√©ci√©e"><a class="header" href="#m√©thode-simple-avec-https-d√©pr√©ci√©e">M√©thode simple avec HTTPS (d√©pr√©ci√©e)</a></h3>
<p>Le clonage en HTTPS est le plus simple et le plus couramment utilis√©. Il ne demande que le lien vers le d√©p√¥t pour le cloner, et lorsqu'une authentification est requise (clone d'un d√©p√¥t priv√©, push, ...) il faut entrer son identifiant du serveur git (dans notre cas, <a href="https://github.com">github.com</a>) ainsi que son mot de passe.</p>
<p>Voici comment r√©cup√©rer le code de la partie <code>info</code> :</p>
<pre><code class="language-bash">git clone https://&lt;ton_login_github&gt;@github.com/ClubRobotInsat/info.git
cd info
</code></pre>
<h3 id="m√©thode-alternative-avec-ssh-recommand√©e"><a class="header" href="#m√©thode-alternative-avec-ssh-recommand√©e">M√©thode alternative avec SSH (recommand√©e)</a></h3>
<p><a href="https://github.com">github.com</a> propose une autre fonctionnalit√© acc√©der au serveur par <a href="https://fr.wikipedia.org/wiki/Secure_Shell">SSH</a>. La mise en place de cette m√©thode est un peu plus longue que le simple protocole HTTPS, mais √ßa te permettra de t'affranchir de devoir entrer ton mot de passe et ton identifiant √† chaque int√©raction avec le serveur.</p>
<p>Je te laisse suivre les <a href="https://help.github.com/articles/connecting-to-github-with-ssh/">instructions d√©taill√©es</a> pour ajouter la clef SSH sur github.</p>
<p>Enfin, voici comment r√©cup√©rer un d√©p√¥t :</p>
<pre><code class="language-bash">git clone git@github.com:ClubRobotInsat/info.git
cd info
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dual-boot"><a class="header" href="#dual-boot">Dual Boot</a></h1>
<p>Tu as probablement un ordinateur sous Windows. Cependant, d√©velopper sous ce syst√®me d'exploitation est parfois compliqu√© donc on utilise principalement des syst√®mes Linux au club.</p>
<p>Tu as diff√©rentes mani√®res d'utiliser Linux :</p>
<ul>
<li>Utiliser <a href="https://docs.microsoft.com/fr-fr/windows/wsl/install-win10">WSL</a>, un sous-syst√®me Linux pour Windows (cependant, il n'est pas possible d'utiliser l'interface graphique)</li>
<li>Utiliser <a href="https://www.virtualbox.org/">VirtualBox</a>, une machine virtuelle pour ex√©cuter Linux √† l'int√©rieur de Windows (cependant, ton ordinateur va devoir ex√©cuter deux syst√®mes d'exploitation en m√™me temps donc il y aura des pertes de performance)</li>
<li>Installer un dual boot, c'est √† dire qu'au d√©marrage de ton ordinateur, soit Windows soit Linux va √™tre lanc√©, donc les performances de chaque OS vont √™tre maximales mais ton disque dur aura une partie attribu√©e √† Windows et une autre √† Linux.</li>
</ul>
<h2 id="pr√©liminaires-sous-windows"><a class="header" href="#pr√©liminaires-sous-windows">Pr√©liminaires sous Windows</a></h2>
<p>Avant tout, il faut faire quelques r√©glages sous Windows pour permettre l'installation d'un nouveau syst√®me d'expoitation (Windows n'aime pas trop partager un ordinateur). Pense aussi √† sauvegarder toutes les donn√©es importantes ailleurs que sur ton PC. Je n'ai jamais eu de probl√®me avec une installation de Linux, mais comme d'habitude, quand on joue avec les partitions de son disque dur, on prend des pr√©cautions (panne de courant/batterie pendant une √©tape critique par exemple).</p>
<ul>
<li><strong>D√©sactiver la mise en veille prolong√©e :</strong> par d√©faut, Windows ne s'√©teint pas quand on le lui dit mais rentre en veille prolong√©e. Ceci est totalement inutile depuis qu'il y a des disques SSD, et √ßa emp√®che de d√©marrer sous un autre OS
<ul>
<li>ouvrir un terminal avec les droits administrateur (clic droit sur le logo windows, shell)</li>
<li>entrer la commande <code>powercfg -h off</code></li>
</ul>
</li>
<li><strong>Partitionner le disque dur :</strong> afin d'√©viter tout probl√®me de partionnement √† cause de la fragmentation Windows, il vaut mieux utiliser directement les outils de Windows :
<ul>
<li>appuyer sur <code>Windows + R</code></li>
<li>saisir <code>diskmgmt.msc</code></li>
<li>clic droit sur le volume √† partitionner (<em>Disque 0</em>) et s√©lectionner <code>R√©duire le volume</code></li>
<li>choisir la taille de la partition d√©sir√©e (Ubuntu demande 15Go minimum et recommande 25Go ; si tu as de la place tu peux faire une nouvelle partition √† <code>40Go</code> pour √™tre large)</li>
</ul>
</li>
</ul>
<p>Ton disque dur a maintenant un espace inutilis√©, il est temps de l'utiliser !</p>
<h2 id="choix-du-syst√®me-linux"><a class="header" href="#choix-du-syst√®me-linux">Choix du syst√®me Linux</a></h2>
<p>Il te faut √† pr√©sent choisir quel nouveau syst√®me d'exploitation utiliser. <strong>Linux</strong> est un <a href="https://upload.wikimedia.org/wikipedia/commons/1/1b/Linux_Distribution_Timeline.svg">univers tr√®s vaste</a>, que l'on peut sommairement classer :</p>
<ul>
<li>les syst√®mes bas√©s sur les fichiers <code>.rpm</code>
<ul>
<li>CentOS</li>
<li>Fedora</li>
<li>openSUSE</li>
</ul>
</li>
<li>les syst√®mes d√©rivant de <code>Debian</code>
<ul>
<li><strong>Ubuntu</strong></li>
<li>Kali Linux</li>
</ul>
</li>
<li>les syst√®mes bas√©s sur le <em>packet manager</em> <code>pacman</code>
<ul>
<li>Arch Linux</li>
<li><strong>Manjaro</strong></li>
</ul>
</li>
</ul>
<p>Tu peux demander des conseils aux membres si tu ne sais pas quel OS prendre, ils pourront m√™me t'en faire essayer plusieurs !</p>
<h3 id="ubuntu-2204"><a class="header" href="#ubuntu-2204">Ubuntu 22.04</a></h3>
<p>Si tu n'as aucune id√©e de quel syst√®me choisir, je te conseille <a href="https://www.ubuntu.com/download/desktop">Ubuntu 22</a>, un syst√®me communautaire LTS (<em>Long Term Supported</em>) qui est tr√®s simple √† prendre en main et pour laquelle les nombreux forums r√©pondent √† toutes tes questions.</p>
<p>Pour l'installer, il te suffit de <a href="https://www.ubuntu.com/download/desktop/thank-you?country=US&amp;version=22.04.1&amp;architecture=amd64">t√©l√©charger l'ISO</a> et la mettre sur une clef USB.</p>
<p><strong>! Attention !</strong>
Sauvegarde toutes les donn√©es sur ta cl√© USB avant de continuer ! Ta clef sera effac√©e par la suite (mais tu pourras la r√©initialiser apr√®s avoir install√© Linux, puis remettre tes donn√©es dessus ensuite).</p>
<p>Par "mettre sur une clef USB", on entend "flasher une image disque", mais c'est un terme barbare. Ici il ne te sera expliqu√© que comment faire.
Le moyen le plus simple est d'utiliser <a href="https://etcher.io/">Etcher</a>. C'est un logiciel open source et compatible sur Windows, Mac et Linux. Sa grande qualit√© est d'√™tre <strong>tres</strong> simple √† utiliser.</p>
<p>Une fois install√© et lanc√©, il n'y a litt√©ralement que quatre clics √† faire :</p>
<ul>
<li>"Select Image" t'invite a choisir l'ISO que tu as d√©j√† t√©l√©charg√©.</li>
<li>"Select Drive" te demande de choisir le disque (clef USB dans notre cas) √† flasher. C'est a dire qu'il sera <strong>formatt√©</strong> ( ! toutes les donn√©es dessus seront perdues !) puis que l'ISO y sera correctement install√©. Cette √©tape requiert de savoir ce que l'on fait : il faut √™tre <strong>absolument</strong> certain que le nom et la capacit√© du disque choisi correspondent √† ta clef USB, et <strong>surtout pas √† ton disque dur</strong>. Normalement Etcher est bien fait, et refuse de continuer si choisit un disque √† ne pas toucher, mais il vaut mieux √™tre trop prudent.</li>
<li>"Flash!" lance l'op√©ration et raconte ce qu'il fait √† ta clef au fur et √† mesure.</li>
</ul>
<p>Si tout c'est bien pass√©, ta "Live-USB" est pr√™te √† l'emploi. La suite d√©pend de ton ordinateur et de la distribution que tu veux installer.</p>
<h2 id="installation-sur-ton-ordinateur-dun-dual-boot"><a class="header" href="#installation-sur-ton-ordinateur-dun-dual-boot">Installation sur ton ordinateur d'un dual boot</a></h2>
<p>√Ä pr√©sent que tu es muni.e d'une clef bootable, tu peux la brancher sur ton ordinateur, appuyer sur la touche pour aller dans le BIOS (√ßa d√©pend du constructeur mais tu as de bonnes chances d'y parvenir en spammant <code>√âchap</code>, <code>F2</code>, <code>F9</code> ou <code>F11</code>) puis modifier quelques param√®tres :</p>
<ul>
<li>D√©sactive le <code>UEFI Secure Boot</code></li>
<li>D√©sactive le <code>Fast Start-Up</code></li>
<li>Change l'ordre de priorit√© pour booter afin de lancer ta clef USB en premi√®re</li>
</ul>
<p>Si tu as le moindre probl√®me je te conseille d'aller voir un membre du club, mais si ton √©cran affiche des choses en relation avec Linux et non pas l'√©cran de d√©marrage de Windows c'est gagn√© !</p>
<p>Tu peux choisir de tester l'OS ou alors de l'installer directement. L'interface devrait √™tre assez explicite ; il va juste te falloir r√©aliser une derni√®re manip sur la page des disques.</p>
<p>Pour √™tre s√ªr.e que tout se passe bien, choisis <code>Something else</code> lorsqu'on te demande o√π installer le syst√®me Linux. Ensuite, dans l'espace libre, tu peux attribuer 2Go √† une m√©moire de type <code>swap</code> (ce qui permets de soulager la RAM si tu lances des applications qui consomment trop). Tu peux attribuer le reste de l'espace libre pour Linux avec <code>type: ext4</code> et <code>mount point: /</code> en formatant l'espace pour √©viter tout probl√®me ult√©rieur.</p>
<p>Finalise l'installation et red√©marre ; si tu arrives sur une interface pour choisir entre Linux et Windows (c'est le <code>Grub 2</code>) tout marche comme il faut !!</p>
<h2 id="setup-de-linux"><a class="header" href="#setup-de-linux">Setup de Linux</a></h2>
<p>La premi√®re chose √† faire est de mettre √† jour ton syst√®me.</p>
<ul>
<li><strong>ArchLinux :</strong> <code>sudo pacman -Suy</code></li>
<li><strong>Debian :</strong> <code>sudo apt update &amp;&amp; sudo apt upgrade</code></li>
</ul>
<h3 id="installation-basique"><a class="header" href="#installation-basique">Installation basique</a></h3>
<p>Installons les paquets de base n√©c√©ssaire pour faire fonctionner les diff√©rents outils du club. Ouvre un terminal, et entres :</p>
<pre><code class="language-bash">sudo apt install git curl wget ntfs-3g python3 gcc gdb jetbrains-toolbox
</code></pre>
<p>Les paquets install√©s sont les suivants:</p>
<ul>
<li><code>git</code> : un gestionnaire de version, qui permet de g√©rer les diff√©rentes versions d'un projet</li>
<li><code>curl</code> : un outil pour t√©l√©charger des fichiers depuis un terminal</li>
<li><code>wget</code> : un outil pour t√©l√©charger des fichiers depuis un terminal</li>
<li><code>ntfs-3g</code> : un outil pour lire et √©crire sur des partitions NTFS (celles de Windows)</li>
<li><code>python3</code> : un langage de programmation</li>
<li><code>gcc</code> : un compilateur pour le langage C</li>
<li><code>gdb</code> : un d√©bugger pour le langage C</li>
<li><code>jetbrains-toolbox</code> : un outil pour installer les IDE de JetBrains</li>
</ul>
<p>Pour installer Rust:</p>
<pre><code class="language-bash">curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ide"><a class="header" href="#ide">IDE</a></h1>
<p><em>Cette page s'adresse √† la fois aux infos et aux √©lecs soft.</em></p>
<p>Comme tu as pu le constater, on a beaucoup de code au club. Pour coder facilement, il existe des outils qui nous facilitent la vie : les <a href="https://fr.wikipedia.org/wiki/Environnement_de_d%C3%A9veloppement">environnements de d√©velopement</a>, ou encore des IDE.</p>
<p>Dans ce guide, nous installerons deux IDE:</p>
<ul>
<li>IntelliJ</li>
<li>STM32CubeIDE</li>
</ul>
<p>Vous pouvez bien s√ªr utiliser un autre IDE si vous le souhaitez, mais nous ne pourrons peut-√™tre pas vous aider si vous rencontrez des probl√®mes. On recommande donc d'utiliser les IDEs que nous utilisons au club. Sinon VSCode est un bon choix.</p>
<p>Notre choix se porte dans un premier temps sur IntelliJ IDEA qui est d√©velopp√© par JetBrains. Il s'agit d'un IDE √† la fois flexible, simple d'utilisation, multiplateforme et qui permet d'utiliser tous les langages que l'on utilise au club.</p>
<p>Nous utilisons STM32CubeIDE pour la partie microcontroleur. Il s'agit d'un IDE d√©velopp√© par STMicroelectronics qui permet de programmer les microcontroleurs de la famille STM32. Il facilite les configurations des p√©riph√©riques et permet de g√©n√©rer du code √† partir de ces configurations.</p>
<p>Ces IDE sont normalement payants, mais une version d'√©ducation (licence valide 1 an, renouvelable tant que l'on est √©tudiant) est disponible.</p>
<h2 id="t√©l√©chargement-de-intellij-idea"><a class="header" href="#t√©l√©chargement-de-intellij-idea">T√©l√©chargement de IntelliJ IDEA</a></h2>
<p>Pour commencer, il faut :</p>
<ol>
<li>Se rendre sur la page de la <a href="https://www.jetbrains.com/toolbox/app/?fromMenu"><strong>Toolbox App</strong></a> et t√©l√©charger la derni√®re version.</li>
<li>Pendant le t√©l√©chargement, aller sur la page de <a href="https://www.jetbrains.com/shop/eform/students">jetbrains.com</a> pour demander une licence √©ducation. L'adresse mail √† fournir est celle de l'INSA (<em>&lt;nom&gt;@etud.insa-toulouse.fr</em>) pour que JetBrains accepte de d√©livrer la licence.</li>
<li>Va voir ta bo√Æte mail, un message contenant un lien de confirmation est arriv√© : confirme ton adresse mail</li>
<li>Tu re√ßois enfin un autre mail avec les infos de la licence, qu'il faudra saisir dans IntelliJ IDEA</li>
<li>Tu peux maintenant lancer la Toolbox App et installer IntelliJ IDEA</li>
</ol>
<h2 id="t√©l√©chargement-de-stm32cubeide"><a class="header" href="#t√©l√©chargement-de-stm32cubeide">T√©l√©chargement de STM32CubeIDE</a></h2>
<p>Pour commencer, il faut :</p>
<ol>
<li>Se rendre sur la page de <a href="https://www.st.com/en/development-tools/stm32cubeide.html">STM32CubeIDE</a> et t√©l√©charger la derni√®re version.</li>
<li>Il est possible que tu doives cr√©er un compte STMicroelectronics pour pouvoir t√©l√©charger le logiciel.</li>
</ol>
<p><em><strong>Pour les utilisateurs d'un Ubuntu standard :</strong></em> Lorsque CLion est en cours d'ex√©cution, son ic√¥ne est affich√© dans la barre des t√¢ches √† gauche. Pour le lancer plus rapidement, il te suffit de faire un click droit sur l'ic√¥ne -&gt; 'Lock to Launcher'</p>
<p>Si jamais l'IDE se lance, tu viens d'installer avec succ√®s CLion ! Sinon je t'encourage √† venir montrer le message d'erreur aux gens du club.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="organisation"><a class="header" href="#organisation">Organisation</a></h1>
<p>Au club robot, on a beaucoup de choses √† faire, et on est beaucoup √† les faire. Pour que tout se passe bien, il faut une bonne organisation. Cette section est l√† pour t'aider √† t'organiser au mieux.</p>
<h2 id="les-outils"><a class="header" href="#les-outils">Les outils</a></h2>
<h3 id="discord"><a class="header" href="#discord">Discord</a></h3>
<p>Discord est un logiciel de communication textuelle et vocale. Il est utilis√© par le club pour communiquer entre nous. Il est possible de l'utiliser dans un navigateur web, mais il est recommand√© de t√©l√©charger l'application.</p>
<p>Pour rejoindre le serveur du club, il faut cliquer sur ce lien : <a href="https://discord.gg/3t6WRAXk4G">https://discord.gg/3t6WRAXk4G</a>.</p>
<h3 id="notion-github--documentation-du-club"><a class="header" href="#notion-github--documentation-du-club"><del>Notion</del> GitHub / <a href="https://clubrobotinsat.github.io/">Documentation du club</a></a></h3>
<p>Pendant quelques ann√©es, nous avons utilis√© Notion pour organiser le club. Cependant, nous avons d√©cid√© de passer √† GitHub pour plusieurs raisons :</p>
<ul>
<li>Notion est payant pour les √©quipes de plus de 10 personnes. Cela nous coutait trop cher.</li>
<li>Notion est un outil de prise de note, pas un outil de gestion de projet.</li>
<li>On avait pas de bonne structure de donn√©es dans Notion, ce qui rendait la navigation difficile.</li>
<li>GitHub permet de g√©rer les projets directement avec les fichiers du projet.</li>
<li>La documentation est plus facile √† maintenir sur GitHub et est hi√©rarchis√©e.</li>
</ul>
<h2 id="les-projets"><a class="header" href="#les-projets">Les projets</a></h2>
<p>Chaque ann√©e, le club robot participe √† la coupe de France de robotique. Pour cela, il faut construire un robot. Pour construire un robot, il faut faire des projets. Les projets sont donc les diff√©rentes parties du robot.</p>
<p>Au club, vous pouvez retrouver d'autres projets, tels que :</p>
<ul>
<li>VEX Robotics</li>
<li>Robot serveur de boisson</li>
</ul>
<h3 id="la-coupe-de-france-de-robotique"><a class="header" href="#la-coupe-de-france-de-robotique">La coupe de France de robotique</a></h3>
<p>La coupe de France de robotique est une comp√©tition de robotique qui a lieu chaque ann√©e √† la fin du mois de mai. Elle se d√©roule √† la Roche-sur-Yon, en Vend√©e. Elle est organis√©e par l'association Plan√®te Sciences.</p>
<p>Chaque ann√©e, un nouveau th√®me est choisi. Le th√®me de cette ann√©e est "Farming Mars". Le but est de construire un robot qui puisse remplir les missions du th√®me.</p>
<p>Pour plus d'informations, vous pouvez aller sur le site de la coupe de France de robotique : <a href="https://www.coupederobotique.fr/">https://www.coupederobotique.fr/</a>.</p>
<h2 id="les-formations-du-club"><a class="header" href="#les-formations-du-club">Les formations du club</a></h2>
<p>Chaque ann√©e, le club organise des formations pour les nouveaux membres. Ces formations ont pour but de vous apprendre √† utiliser les outils du club, et √† vous apprendre les bases de la robotique.</p>
<p>Les diff√©rentes formations sont :</p>
<ul>
<li>La formation √©lectronique: Kicad</li>
<li>La formation informatique: C, Git, Linux</li>
<li>La formation m√©ca: Creo Parametric</li>
</ul>
<h2 id="les-r√®gles-du-club"><a class="header" href="#les-r√®gles-du-club">Les r√®gles du club</a></h2>
<p>Au club, il y a quelques r√®gles √† respecter. Ces r√®gles sont l√† pour que tout le monde puisse travailler dans de bonnes conditions.</p>
<h3 id="les-r√®gles-de-rangement"><a class="header" href="#les-r√®gles-de-rangement">Les r√®gles de rangement</a></h3>
<p>Au club, il y a beaucoup de mat√©riel. Pour que tout le monde puisse s'y retrouver, il faut que tout soit rang√© √† sa place. Il y a donc des r√®gles de rangement √† respecter.</p>
<p>La <strong>premi√®re r√®gle est de ranger les choses √† leur place</strong>. Si vous ne savez pas o√π ranger quelque chose, demandez √† un membre du club.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gestion-de-projet"><a class="header" href="#gestion-de-projet">Gestion de projet</a></h1>
<p>Pour g√©rer un projet, il faut utiliser des outils de gestion de projet. Au club, nous utilisons <a href="https://github.com/">GitHub</a>. GitHub est un site web qui permet d'h√©berger des projets. Il permet de g√©rer les versions des fichiers, de g√©rer les t√¢ches √† faire, et de g√©rer les personnes qui travaillent sur le projet.</p>
<p>Avoir une quelqu'un qui s'occupe de la gestion de projet est tr√®s important.</p>
<h2 id="quelques-conseils"><a class="header" href="#quelques-conseils">Quelques conseils</a></h2>
<p>C'est bien de planifier l'ann√©e √† la rentr√©e et de faire un r√©troplanning. Cependant, il faut savoir que les choses ne se passent jamais comme pr√©vu. Il faut donc √™tre flexible et savoir s'adapter.</p>
<blockquote>
<p>On a toujours des probl√®mes d'√©lectronique.</p>
</blockquote>
<blockquote>
<p>Un court-circuit est vite arriv√©.</p>
</blockquote>
<h2 id="les-p√¥les"><a class="header" href="#les-p√¥les">Les p√¥les</a></h2>
<p>Afin de faciliter la gestion du projet, on a trois p√¥les: Info, Elec, M√©ca. Si possible avoir un responsable de chaque p√¥le. Cela permet de r√©partir la charge de travail.</p>
<h2 id="s√©parer-en-modules"><a class="header" href="#s√©parer-en-modules">S√©parer en modules</a></h2>
<p>Il faut s√©parer le projet en modules. Cela permet de r√©partir la charge de travail, et de pouvoir travailler en parall√®le.
On peut √©galement r√©utiliser des modules d'une ann√©e sur l'autre.</p>
<h2 id="les-t√¢ches"><a class="header" href="#les-t√¢ches">Les t√¢ches</a></h2>
<p>Pour g√©rer les t√¢ches, on utilise des <a href="https://docs.github.com/en/github/managing-your-work-on-github/about-issues">issues</a>. Une issue est une t√¢che √† faire. Elle peut √™tre assign√©e √† une personne, et peut √™tre li√©e √† d'autres issues. On peut √©galement ajouter des labels pour cat√©goriser les issues.</p>
<p>Il faut faire attention √† ne pas avoir trop d'issues ouvertes en m√™me temps. Il faut donc bien prioriser les issues.</p>
<h2 id="les-milestones"><a class="header" href="#les-milestones">Les milestones</a></h2>
<p>Les <a href="https://docs.github.com/en/github/managing-your-work-on-github/about-milestones">milestones</a> permettent de regrouper des issues. On peut leur donner une date limite. Cela permet de planifier les t√¢ches √† faire.</p>
<p>En g√©n√©ral cela correspond √† des modules du robot.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gestion-de-l√©quipe"><a class="header" href="#gestion-de-l√©quipe">Gestion de l'√©quipe</a></h1>
<p>Il est important de bien g√©rer l'√©quipe. Cela permet de gagner du temps, et de ne pas faire d'erreurs.</p>
<p>Il faut r√©guli√©rement demander aux membres de l'√©quipe comment ils vont, et s'ils ont besoin d'aide. Il faut √©galement leur demander ce qu'ils ont fait, et ce qu'ils vont faire.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gestion-de-la-communication"><a class="header" href="#gestion-de-la-communication">Gestion de la communication</a></h1>
<p>On utilise <a href="https://discord.com/">Discord</a> pour communiquer. C'est un logiciel de communication par texte et par audio. Il permet de cr√©er des salons de discussion, et de cr√©er des groupes de discussion. Il permet √©galement de partager des fichiers.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gestion-de-la-documentation"><a class="header" href="#gestion-de-la-documentation">Gestion de la documentation</a></h1>
<p>Un des plus gros probl√®mes du club est la documentation. Il faut donc faire attention √† bien documenter le projet. Cela permet de gagner du temps pour les ann√©es suivantes, et de pouvoir r√©utiliser des modules d'une ann√©e sur l'autre.</p>
<p>Actuellement, on ne sait pas exactement ce qu'on connait et ce qu'on ne connait pas. Il faut donc faire un inventaire de ce qu'on connait. On a √©normement de documents, mais ils sont √©parpill√©s un peu partout. Il faut donc les rassembler et les organiser.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="r√®gles-coupe-de-france-2024"><a class="header" href="#r√®gles-coupe-de-france-2024">R√®gles Coupe de France 2024</a></h1>
<h2 id="sommaire"><a class="header" href="#sommaire">Sommaire</a></h2>
<p>Lien vers les r√®gles: <a href="https://www.coupederobotique.fr/edition-2024/le-concours/reglement-2024/">https://www.coupederobotique.fr/edition-2024/le-concours/reglement-2024/</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="architecture-du-projet"><a class="header" href="#architecture-du-projet">Architecture du projet</a></h1>
<h2 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h2>
<p>Ce document a pour but de d√©crire l'architecture du projet. Il est destin√© aux personnes qui souhaitent comprendre comment le projet est organis√©, et comment il fonctionne.</p>
<h2 id="conception-m√©canique"><a class="header" href="#conception-m√©canique">Conception m√©canique</a></h2>
<h3 id="introduction-2"><a class="header" href="#introduction-2">Introduction</a></h3>
<h3 id="base-roulante"><a class="header" href="#base-roulante">Base roulante</a></h3>
<h3 id="conception-modulaire"><a class="header" href="#conception-modulaire">Conception modulaire</a></h3>
<h3 id="bras-robotique"><a class="header" href="#bras-robotique">Bras robotique</a></h3>
<h2 id="conception-√©lectronique"><a class="header" href="#conception-√©lectronique">Conception √©lectronique</a></h2>
<h3 id="introduction-3"><a class="header" href="#introduction-3">Introduction</a></h3>
<h3 id="alimentation"><a class="header" href="#alimentation">Alimentation</a></h3>
<h3 id="carte-de-contr√¥le"><a class="header" href="#carte-de-contr√¥le">Carte de contr√¥le</a></h3>
<h3 id="capteurs"><a class="header" href="#capteurs">Capteurs</a></h3>
<h3 id="actionneurs"><a class="header" href="#actionneurs">Actionneurs</a></h3>
<h2 id="conception-informatique"><a class="header" href="#conception-informatique">Conception informatique</a></h2>
<h3 id="introduction-4"><a class="header" href="#introduction-4">Introduction</a></h3>
<h3 id="architecture"><a class="header" href="#architecture">Architecture</a></h3>
<h3 id="communication"><a class="header" href="#communication">Communication</a></h3>
<h3 id="vision"><a class="header" href="#vision">Vision</a></h3>
<h3 id="strat√©gie"><a class="header" href="#strat√©gie">Strat√©gie</a></h3>
<h3 id="intelligence-artificielle"><a class="header" href="#intelligence-artificielle">Intelligence artificielle</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="informatique"><a class="header" href="#informatique">Informatique</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mise-en-place"><a class="header" href="#mise-en-place">Mise en place</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="connexion-√†-la-raspberry"><a class="header" href="#connexion-√†-la-raspberry">Connexion √† la Raspberry</a></h1>
<h1 id="raspberry-pi"><a class="header" href="#raspberry-pi">Raspberry Pi</a></h1>
<p>La Raspberry Pi a maintenant un serveur DHCP fonctionnel</p>
<h2 id="quoi-que-cest-le-dhcp"><a class="header" href="#quoi-que-cest-le-dhcp">Quoi que c'est le DHCP?</a></h2>
<p>C'est le truc qui vous permet d'avoir automatiquement une @IP sans jamais aller toucher aux param√®tres de votre pc ou de la raspi, et donc d'avoir une connectivit√© qui marche sans rien faire, donc c'est cool</p>
<h2 id="comment-que-je-men-sers"><a class="header" href="#comment-que-je-men-sers">Comment que je m'en sers?</a></h2>
<p>Il suffit de brancher votre pc au port ethernet de la raspi. Si ladite raspi est allum√©e (branch√©e), vous aurez une adresse IP sur votre ordi (mais vous n'avez pas besoin de vous en soucier), et surtout, vous pourrez vous connecter en ssh √† la raspi</p>
<h2 id="ok-comment-je-me-connecte-en-ssh"><a class="header" href="#ok-comment-je-me-connecte-en-ssh">OK, comment je me connecte en ssh?</a></h2>
<p><code>ssh pi@192.168.169.1</code></p>
<h2 id="aude-√ßa-marche-pas"><a class="header" href="#aude-√ßa-marche-pas">Aude, √ßa marche pas!</a></h2>
<ul>
<li>est-ce que les LEDs du port ethernet de la raspi et du PC sont allum√©es?</li>
<li>sinon, rebrancher le c√¢ble comme il faut, v√©rifier l'alim des deux dispositifs</li>
<li>est-ce que mon PC a bien re√ßu une adresse IP sur le r√©seau 192.168.169.0/24? <code>ifconfig</code></li>
<li>sinon, sur la raspi, v√©rifier le statut du serveur DHCP <code>systemctl status isc-dhcp-server</code></li>
</ul>
<h3 id="jarrive-√†-ping-la-raspi-mais-pas-√†-ssh"><a class="header" href="#jarrive-√†-ping-la-raspi-mais-pas-√†-ssh">J'arrive √† ping la raspi, mais pas √† SSH</a></h3>
<ul>
<li>probablement un probl√®me de firewall, bonne chance jeune padawan (cherche comment utiliser le firewall ufw sur internet)</li>
</ul>
<h2 id="je-peux-te-contacter-si-√ßa-marche-pas"><a class="header" href="#je-peux-te-contacter-si-√ßa-marche-pas">Je peux te contacter si √ßa marche pas?</a></h2>
<p>Oui bien s√ªr ^^</p>
<h2 id="connexion-en-ssh"><a class="header" href="#connexion-en-ssh">Connexion en ssh</a></h2>
<blockquote>
<p>user : pi mdp : robotcdf</p>
</blockquote>
<p>pour se connecter en ssh √† la raspi :</p>
<ul>
<li>en wifi : v√©rifier qu‚Äôon est sur le m√™me r√©seau (ex : partage de connexion, r√©seau IoT si j‚Äôarrive √† chopper le mdp)
<ul>
<li>ip_address g√©n√©ralement en 192.168.X.X ou 10.X.X.X (priv√©e)</li>
</ul>
</li>
<li>en ethernet : connecter le pc et la raspi avec un c√¢ble ethernet (si besoin adaptateur usb)</li>
</ul>
<p>Si les led des ports ethernet ne s‚Äôallument pas, tout reboot</p>
<ol>
<li>
<p>v√©rifie qu‚Äôil y a une ipv6 (commen√ßant pas fe80::) sur l‚Äôinterface de la raspi et de ton pc (elles ont s√ªrement des noms bizarres commen√ßant par en) : √ßa veut dire que la connexion est possible</p>
<ul>
<li>si pas d‚Äôipv6, d√©branche et rebranche, v√©rifie toutes les interfaces</li>
</ul>
</li>
<li>
<p>essaie de ping la raspi depuis ton pc (facultatif : ping ton pc depuis la raspi, mais les windows ne r√©pondront pas dans tous les cas)</p>
<ul>
<li>
<p>si ton pc a une ipv4  en 169.254.X.X (link-local)</p>
<ul>
<li>toutes les fois o√π j‚Äôai test√© la raspi avait la 169.254.217.11/16</li>
<li>celle avec le scotch a √©t√© mise en static √† 169.254.0.1/16</li>
</ul>
<p>‚áí rentre la commande suivante sur ton pc</p>
<pre><code class="language-bash">ping ipv4_raspi # si le ping ne passe pas, v√©rifie la connectivit√© 
# et/ou essaie en ipv6 
# tu peux aussi entrer la commande 
route # pour v√©rifier la table de routage si tu es exp√©riment√© 
</code></pre>
</li>
<li>
<p>si ton pc n‚Äôa pas d‚Äôipv4 sur l‚Äôinterface</p>
<p>‚áí ping la raspi en ipv6</p>
<pre><code class="language-bash">ping -6 ipv6_raspi%interface
</code></pre>
</li>
</ul>
</li>
<li>
<p>se connecter en ssh</p>
<ul>
<li>ipv4</li>
</ul>
<pre><code class="language-bash">ssh pi@ipv4_raspi
</code></pre>
<ul>
<li>ipv6</li>
</ul>
<pre><code class="language-bash">ssh pi@ipv6_raspi%interface
</code></pre>
</li>
</ol>
<p>Tu peux utiliser un connecteur sur ton ide (par exemple sur vscode) une fois que le ssh fonctionne</p>
<p>(PC Aude : Adaptador de Ethernet Ethernet: 169.254.239.119)</p>
<p><img src="informatique/mise_en_place/../../images/info/Raspberry.png" alt="Image de la Raspberry Pi" /></p>
<h2 id="install-opencv"><a class="header" href="#install-opencv">Install OpenCV</a></h2>
<p><a href="https://linuxize.com/post/how-to-install-opencv-on-raspberry-pi/">How to Install OpenCV on Raspberry Pi 3</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ide-1"><a class="header" href="#ide-1">IDE</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="r√©pertoire-de-travail"><a class="header" href="#r√©pertoire-de-travail">R√©pertoire de travail</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python"><a class="header" href="#python">Python</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-start-the-development-container-for--ros2-development"><a class="header" href="#how-to-start-the-development-container-for--ros2-development">How to start the development container for ü§ñ ROS2 development</a></h1>
<ol>
<li>
<p>üõ† Install VSCode or a JetBrainsIDE(Clion or Pycharm recommended). For JetBrains you have free student licences.
I personally recommend a JetBrians IDE over VSCode.</p>
</li>
<li>
<p>üê≥ Install <a href="https://docs.docker.com/engine/install/">docker engine</a>.
In linux don't forget to <a href="https://docs.docker.com/engine/install/linux-postinstall/">add yourself to the docker group</a>:</p>
<ol>
<li><code>sudo groupadd docker</code></li>
<li><code>sudo usermod -aG docker $USER</code></li>
<li><code>newgrp docker</code></li>
</ol>
</li>
<li>
<p>üìö git clone https://github.com/ClubRobotInsat/Info</p>
</li>
<li>
<p>If you're on windows you need to comment
the <code>"source=/tmp/.X11-unix,target=/tmp/.X11-unix,type=bind,consistency=cached"</code>
line in the <code>.devcontainer/devcontainer.json</code> file (comment is &lt;&lt; // &gt;&gt; as in C) at the end of the file.
This line allows you to use GUI apps from the container, which doesn't work on windows (no X11 on windows by default).</p>
</li>
<li>
<p>Follow the instruction based on your IDE</p>
</li>
</ol>
<h1 id="clion--pycharm--other-jetbrains"><a class="header" href="#clion--pycharm--other-jetbrains">CLion / Pycharm / Other JetBrains</a></h1>
<ol>
<li>Open the project folder</li>
<li>Open the <code>.devcontainer/devcontainer.json</code> file.</li>
<li>CLick on the blue cube to create a new dev container, the simplest option is to choose:
<code>Create Dev Container and mount sources</code> this will make the dev directory inside the container and the
"real" folder to be synced. This might have performance issues on windows, so if you know what you're doing
it might be worth to take a look at the clone option if you're on windows.
<img src="informatique/mise_en_place/../../images/info/Clion_dev_container.png" alt="Clion_dev_container.png" /></li>
</ol>
<p>Clion should build the container, it might take some time, good internet can help.
Once its finished press continue:
<img src="informatique/mise_en_place/../../images/info/Clion_build_dev-container.png" alt="continue" /></p>
<p>Again, it might take some time.</p>
<p>Once finished, your IDE should open, you're now in a virtual environment
with the right version of everything and ros2 installed!</p>
<p>When closing, chose close and stop to avoid performance and ressource
allocation(mostly ports) issues in your PC.</p>
<h1 id="vscode"><a class="header" href="#vscode">VSCode</a></h1>
<ol>
<li>Open the project folder</li>
<li>press ctr+shift+p</li>
<li>Run: <code>Dev Containers: Rebuild and Reopen in Container</code>. It might take some time, good internet can help</li>
</ol>
<h2 id="windows-docker-engine-install-details"><a class="header" href="#windows-docker-engine-install-details">Windows Docker engine install details</a></h2>
<p>Use the recommended settings, you can skip the login and the survey.</p>
<h1 id="why-and-how"><a class="header" href="#why-and-how">Why and how?</a></h1>
<p>For this tutorial you need to be familiar with the concept of docker container, container ports, and container volumes.
Look up a tutorial if you don't know what those are.</p>
<p>This process creates a container and makes your IDE connect to it as its "host" machine.
This enables people to work with the same exact environment independently of the underlying machine.
SO, basically we are creating a "light VM" so that everyone can work with ROS2 as the only officially
supported OS for ros2 humble (the latest LTS version when writing this doc) is ubuntu 22.04, which is already 2y old
and just getting older.
At the same time we are opening a port so that the IDE can connect though it (3000) and another one for ssh connexion
if needed (2222).
We also mout a volume from our repository into the dev container so that we can have all our files up to date all
the time.
This volume binding, goes through WSL on windows, which makes two "emulation" layers of the fyle system, docker and wls.
THis makes the fyle system really slow, so, cloning the repo inside the container might be wise if
performance is an issue on someone's PC.</p>
<p>The launch config for the container is specified int he <code>.devcontainer/devcontainer.json</code> file, replacing
the usual docker-compose.yml or the docker run command. So any container config should be modified here.</p>
<p>All the image config is in the Dockerfile as usual. IF the underlying image needs to be modified its here.</p>
<h1 id="debugging-the-dev-environment"><a class="header" href="#debugging-the-dev-environment">Debugging the dev-environment</a></h1>
<h3 id="port-already-in-use"><a class="header" href="#port-already-in-use">Port already in use</a></h3>
<ul>
<li><code>docker ps</code></li>
<li>This will show a list with all the running containers in your PC, you cant have two containers bind to
the same port, so if there is one already running it must be stopped. This happens when the IDE doesn't close
the dev-container when closed. It's mostly an issue with VSCode.</li>
<li>Take the "CONTAINER ID" and run <code>docker stop ${CONTAINER ID}</code></li>
<li>Try opening the dev container again, if it doesn't work there is another process using the port,
the simplest way to deal with it is rebooting the machine or changing the host port (the one on the left of the : )
in the <code>.devcontainer/devcontainer.json</code> file.</li>
</ul>
<h3 id="cant-bind-a-volume"><a class="header" href="#cant-bind-a-volume">Cant bind a volume</a></h3>
<p>The most usual cause is that the directory doest exist,
have you forgotten to comment the x11 line in the <code>.devcontainer/devcontainer.json</code> file?</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="architecture-du-code"><a class="header" href="#architecture-du-code">Architecture du code</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="communication-avec-le-hardware-can-bus"><a class="header" href="#communication-avec-le-hardware-can-bus">Communication avec le hardware: CAN Bus</a></h1>
<p>La communication avec le hardware est essentielle pour assurer le bon fonctionnement du robot. Cette section se concentre sur le bus CAN, un choix strat√©gique en raison de sa robustesse et de sa rapidit√©.</p>
<h2 id="quest-ce-que-le-bus-can-"><a class="header" href="#quest-ce-que-le-bus-can-">Qu'est ce que le Bus CAN ?</a></h2>
<p>Le bus CAN (Controller Area Network) est un bus de communication s√©rie largement utilis√© dans l'industrie. Il offre une communication rapide et fiable avec plusieurs modules simultan√©ment. Pour en savoir plus sur son fonctionnement, consultez ces documents:</p>
<ul>
<li><a href="https://www.ti.com/lit/an/sloa101b/sloa101b.pdf?ts=1633140726383&amp;ref_url=https%3A%2F%2Fwww.google.com%2F">Description g√©n√©rale du fonctionnement</a></li>
<li><a href="https://www.csselectronics.com/pages/can-bus-simple-intro-tutoria">tutoriel explicatif</a>.</li>
</ul>
<h2 id="mat√©riel-utilis√©-pour-le-bus-can"><a class="header" href="#mat√©riel-utilis√©-pour-le-bus-can">Mat√©riel utilis√© pour le bus CAN</a></h2>
<p>CAN Transceiver : Composant interm√©diaire pour produire les signaux CANL et CANH et les transporter dans le r√©seau.</p>
<p>On utilise 2 mod√®les. On utilise le <strong>MCP2515</strong> et le <strong>MCP2551</strong>.</p>
<p>Datasheets:</p>
<ul>
<li><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/20001667G.pdf">Datasheet MCP2551</a></li>
<li><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/MCP2515-Stand-Alone-CAN-Controller-with-SPI-20001801J.pdf">Datasheet MCP2515</a></li>
</ul>
<h3 id="diff√©rence-entre-mcp2515-et-mcp2551"><a class="header" href="#diff√©rence-entre-mcp2515-et-mcp2551">Diff√©rence entre MCP2515 et MCP2551</a></h3>
<p>Le <strong>MCP2515</strong> est un contr√¥leur CAN qui permet de communiquer avec le bus CAN via SPI. Il est utilis√© pour envoyer et recevoir des messages CAN. Il est connect√© √† la Raspberry Pi via SPI.</p>
<p>Le <strong>MCP2551</strong> est un transceiver CAN plus simple qui permet de convertir les signaux TX et RX en signaux CANH et CANL. Il est compris dans le MCP2515 mais on l'utilise aussi pour communiquer avec la STM32.</p>
<h2 id="utilisation-du-bus-can"><a class="header" href="#utilisation-du-bus-can">Utilisation du bus CAN</a></h2>
<h3 id="param√®tres-dalimentation-du-bus"><a class="header" href="#param√®tres-dalimentation-du-bus">Param√®tres d'alimentation du bus</a></h3>
<ul>
<li>Alimentation : <strong>5V</strong></li>
<li>Courant : 100mA (en m√©moire dans M3)</li>
<li>Ne pas oublier de mettre un bouchon d'imp√©dance (50 OU 120 Ohm) en fin du cable CAN</li>
</ul>
<h3 id="connexion-du-mcp2551-pour-stm32"><a class="header" href="#connexion-du-mcp2551-pour-stm32">Connexion du MCP2551 (Pour STM32)</a></h3>
<p><img src="informatique/../images/info/CAN_BUS_MCP2551_Connexion.png" alt="Connexion MCP2551" /></p>
<p><strong>R√©glage du slope-rate</strong> :</p>
<p>Pour changer le slope-rate on change la valeur de R connecter sur RS.</p>
<h3 id="connexion-du-mcp2515-spican---raspberry-pi"><a class="header" href="#connexion-du-mcp2515-spican---raspberry-pi">Connexion du MCP2515 (SPI+CAN -&gt; Raspberry Pi)</a></h3>
<p>Connecter les pins du transceiver SI, SO, SCK, INT et CS comme ci dessous.</p>
<p>:warning: Le VCC doit √™tre sur du <strong>5V</strong> contrairement √† ce sch√©ma, ne pas oublier le ground.</p>
<p><img src="informatique/../images/info/CAN_Raspberry_Transreceiver_Connexion.png" alt="Connexion entre Raspberry et transreceiver" /></p>
<p><img src="informatique/../images/info/CAN_Transreceiver_Pinout.png" alt="CAN Transreceiver pinout" /></p>
<p>Fichier <code>/boot/config.txt</code> √† mettre pour activer la connexion SPI avec le MCP au moment de boot dans la rpi:</p>
<pre><code># For more options and information see
# http://rptl.io/configtxt
# Some settings may impact device functionality. See link above for details

# Uncomment some or all of these to enable the optional hardware interfaces
#dtparam=i2c_arm=on
#dtparam=i2s=on

dtparam=spi=on

# Enable audio (loads snd_bcm2835)
dtparam=audio=on

# Additional overlays and parameters are documented
# /boot/firmware/overlays/README

# Automatically load overlays for detected cameras
camera_auto_detect=1

# Automatically load overlays for detected DSI displays
display_auto_detect=1

# Automatically load initramfs files, if found
auto_initramfs=1

# Enable DRM VC4 V3D driver
dtoverlay=vc4-kms-v3d
max_framebuffers=2

# Don't have the firmware create an initial video= setting in cmdline.txt.
# Use the kernel's default instead.
disable_fw_kms_setup=1

# Run in 64-bit mode
arm_64bit=1

# Disable compensation for displays with overscan
disable_overscan=1

# Run as fast as firmware / board allows
arm_boost=1

[cm4]
# Enable host mode on the 2711 built-in XHCI USB controller.
# This line should be removed if the legacy DWC2 controller is required
# (e.g. for USB device mode) or if USB support is not required.
otg_mode=1

[all]
dtoverlay=mcp2515-can0,oscillator=16000000,interrupt=25,spimaxfrequency=500000
dtoverlay=spi0-hw-cs

</code></pre>
<h3 id="exemple-de-connexion-entre-deux-stm32"><a class="header" href="#exemple-de-connexion-entre-deux-stm32">Exemple de connexion entre deux STM32</a></h3>
<p>‚ö†Ô∏è
Regarder plus en d√©tail la page d√©di√©e √† la communication entre STM32 pour plus d'informations.</p>
<p><img src="informatique/../images/info/CAN_BUS_STMs.jpg" alt="Connexion entre deux STM32" /></p>
<h2 id="tutoriel-pour-la-mise-en-place-du-bus-can-sur-la-raspberry-pi"><a class="header" href="#tutoriel-pour-la-mise-en-place-du-bus-can-sur-la-raspberry-pi">Tutoriel pour la mise en place du bus CAN sur la Raspberry Pi</a></h2>
<p><strong>Liste des √©tapes √† suivre</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"/>
Faire le circuit de la figure ci-dessus entre deux STM32</li>
<li><input disabled="" type="checkbox"/>
S'assurer que le bus CAN marche entre les deux STM32</li>
<li><input disabled="" type="checkbox"/>
Connecter le MCP2515 √† la Raspberry Pi comme sur la figure ci-dessus</li>
<li><input disabled="" type="checkbox"/>
Installer les paquets n√©cessaires sur la Raspberry Pi</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que l'interface can0 est bien pr√©sente au d√©marrage de la raspi avec <code>ifconfig</code></li>
<li><input disabled="" type="checkbox"/>
V√©rifier que la Raspberry Pi re√ßoit bien les messages envoy√©s par les STM32 et vice-versa</li>
</ul>
<h3 id="liste-des-potentiels-probl√®mes"><a class="header" href="#liste-des-potentiels-probl√®mes">Liste des potentiels probl√®mes</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
V√©rifier que le bus CAN est bien aliment√© (bouton on/off et branchements‚Ä¶)</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les fils sont bien branch√©s</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les r√©sistances de terminaison sont bien pr√©sentes</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les ground sont bien connect√©s entre eux</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que le montage est correct</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les STM32 sont bien aliment√©s</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les STM32 sont bien programm√©s pour envoyer et recevoir des messages CAN</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les signaux TX et RX sont bien connect√©s aux pins RX et TX des STM32</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les signaux sont bien pr√©sents sur le BUS CAN (oscilloscope ou serial analyzer)</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les bonnes donn√©es sont envoy√©es et re√ßues par les STM32</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les signaux envoy√©s par les STM32 sont bien re√ßus par la Raspberry Pi</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les modules SPI et CAN sont bien activ√©s sur la Raspberry Pi</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les paquets n√©cessaires sont bien install√©s sur la Raspberry Pi</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que l'interface can0 est bien pr√©sente au d√©marrage de la raspi avec <code>ifconfig</code></li>
<li><input disabled="" type="checkbox"/>
V√©rifier que la Raspberry Pi re√ßoit bien les messages envoy√©s par les STM32 et vice-versa</li>
</ul>
<h2 id="v√©rification-du-bon-fonctionnement-du-bus-can-sur-la-raspberry-pi"><a class="header" href="#v√©rification-du-bon-fonctionnement-du-bus-can-sur-la-raspberry-pi">V√©rification du bon fonctionnement du bus CAN sur la Raspberry Pi</a></h2>
<h3 id="v√©rification-de-linterface-can0"><a class="header" href="#v√©rification-de-linterface-can0">V√©rification de l'interface can0:</a></h3>
<ul>
<li>V√©rifier que l‚Äôinterface can0 est bien pr√©sente au d√©marrage de la raspi avec <code>ifconfig</code></li>
<li>On peut aussi v√©rifier dans les messages de d√©marrage du kernel que tout s‚Äôest bien pass√© avec <code>dmesg | grep can</code> et <code>dmesg | grep mcp</code></li>
<li>Sinon, red√©marrer la raspi <code>sudo reboot</code></li>
</ul>
<h3 id="format-des-messages"><a class="header" href="#format-des-messages">Format des messages</a></h3>
<ul>
<li><code>candump any</code> pour recevoir (en boucle)</li>
<li><code>cansend can0 000#00.00.00.00.00.00.00.00</code> pour envoyer (attention, donn√©es en hexa).</li>
</ul>
<h2 id="protocole-de-test-de-liam"><a class="header" href="#protocole-de-test-de-liam">Protocole de test de Liam</a></h2>
<p>Le Bus CAN fonctionne, mais comment le tester?</p>
<p>Tout d'abord, il faut la raspberry pi avec ubuntu ou raspbian install√© dessus (soit USB soit carte SD)
Un module qui fait office d'interface CAN est deja connect√© √† la raspberry pi</p>
<p>J'utilise une alim (celle de mon telephone, le chargeur) pour alimenter la raspberry. Ensuite j'utilise un cable micro HDMI pour afficher le terminal qu'il me faut pour mettre en place le bus CAN</p>
<p>Lorsque le terminal est activ√©, apres avoir renseign√© le login et mdp (pi et robotcdf respectivement), il faut mettre en place l'interface CAN avec la commande suivante :
sudo ip link set can0 up type can bitrate 125000</p>
<p>Le bitrate depend de nous, si on le change il faut s'assurer que les STM32 ont le meme bitrate associ√© √† leurs interfaces CAN.</p>
<p>Lorsque l'interface est UP , on peut brancher CANH et CANL de la raspi a un bus CAN compos√© de plusieurs STM32.
Nous avons pour l'instant deux cartes , une avec seulement une stm, une autre carte avec une stm et tout ce qu'il faut pour driver les moteurs a courant continu.</p>
<p>Si l'interface n'est pas UP, il faut verifier l'erreur en utilisant la commande dmesg . Dans mon cas, l'erreur etait due aux fils qui √©taient de mauvaise qualit√© et n'interconnectaient pas bien la raspi et le module CAN.</p>
<p>Il est dorenavant possible d'interagir avec le bus CAN en utilisant l'utilitaire can-utils :</p>
<p>On peut lancer par exemple : candump can0 pour observer le traffic sur le Bus CAN.
cansend can0 013#01.01.01.01.01.01.01.01 par exemple pour envoyer des donnees sur le bus CAN
( Dans le cas du code que j'ai ecrit sur la stm32, ceci permet d'ordonner √† la STM32 d'activer les moteurs )</p>
<p>Le code sur la STM32 utilise un filtre sur l'ID 013 et verifie le contenu du premier octet de la trame CAN.</p>
<p>En conclusion : Ne pas faire confiance aux breadboards, ni aux fils (jumper wires) qui ne garantissent pas des connexions fiables.
Il faut aussi faire attention quant a la configuration du filtre sur la stm32.
Attention egalement a l'oscillateur utilis√© sur la stm32, il faut bien definir l'oscillation sur le bus CAN (Interface FDCAN)</p>
<h2 id="documentation-diverse"><a class="header" href="#documentation-diverse">Documentation diverse</a></h2>
<p>Explorez ces ressources pour une compr√©hension plus approfondie du bus CAN et de son utilisation.</p>
<ul>
<li>
<p><a href="https://forums.raspberrypi.com/viewtopic.php?t=141052">Guide rapide</a></p>
</li>
<li>
<p><a href="https://www.beyondlogic.org/adding-can-controller-area-network-to-the-raspberry-pi/">Adding CAN to the Raspberry PI</a></p>
</li>
<li>
<p><a href="https://projects-raspberry.com/how-to-connect-raspberry-pi-to-can-bus/">How to connect Raspberry Pi to CAN bus</a></p>
</li>
<li>
<p><a href="https://forums.raspberrypi.com/viewtopic.php?t=311606"> Not able to setup can0. - Raspberry Pi Forums</a></p>
</li>
<li>
<p><a href="https://github.com/raspberrypi/linux/issues/4183">MCP251x failes setup CAN-bus communication with error=110 ¬∑ Issue #4183 ¬∑ raspberrypi/linux</a></p>
</li>
</ul>
<h2 id="notes"><a class="header" href="#notes">Notes</a></h2>
<ul>
<li>Description g√©n√©rale du fonctionnement:  <a href="https://www.ti.com/lit/an/sloa101b/sloa101b.pdf?ts=1633140726383&amp;ref_url=https%253A%252F%252Fwww.google.com%252F">https://www.ti.com/lit/an/sloa101b/sloa101b.pdf?ts=1633140726383&amp;ref_url=https%3A%2F%2Fwww.google.com%2F</a></li>
</ul>
<p>si √ßa marche pas, v√©rifier qu‚Äôil y a bien deux dispositifs sur le bus</p>
<p><a href="https://www.csselectronics.com/pages/can-bus-simple-intro-tutorial">CAN Bus Explained - A Simple Intro [2022 | The #1 Tutorial]</a></p>
<p><a href="https://github.com/TVAROBOT/STM32">GitHub - TVAROBOT/STM32: CAN bus on STM32F103C8T6 "Blue pill" uVision and CubeMX</a></p>
<p><a href="informatique/../ToDo%20d9dc46c3b25c4135a14d9b95735317f5/Decide%20communication%20protocol%20d89cb22bfdd24c7198646a51b15ae670/CAN%20Bus%20b5e77c9cfda440c08deaae066f118232.html">CAN Bus</a></p>
<p>datasheet : <a href="https://ww1.microchip.com/downloads/en/DeviceDoc/MCP2515-Stand-Alone-CAN-Controller-with-SPI-20001801J.pdf">https://ww1.microchip.com/downloads/en/DeviceDoc/MCP2515-Stand-Alone-CAN-Controller-with-SPI-20001801J.pdf</a></p>
<p><a href="https://forums.raspberrypi.com/viewtopic.php?t=141052">[quick-guide] CAN bus on raspberry pi with MCP2515 - Raspberry Pi Forums</a></p>
<p><a href="https://www.beyondlogic.org/adding-can-controller-area-network-to-the-raspberry-pi/">Adding CAN to the Raspberry PI</a></p>
<p><a href="https://projects-raspberry.com/how-to-connect-raspberry-pi-to-can-bus/"></a></p>
<p>apparemment c‚Äôest un probl√®me de fils, j‚Äôai les m√™mes erreurs qu‚Äôici :</p>
<p><a href="https://forums.raspberrypi.com/viewtopic.php?t=311606">[SOLVED] Not able to setup can0. - Raspberry Pi Forums</a></p>
<p><a href="https://github.com/raspberrypi/linux/issues/4183">MCP251x failes setup CAN-bus communication with error=110 ¬∑ Issue #4183 ¬∑ raspberrypi/linux</a></p>
<p>utilisation : cansend can0 <id>#{data}</p>
<p>id sur 3 nombres</p>
<p><a href="https://manpages.debian.org/testing/can-utils/candump.1.en.html">candump(1) - can-utils - Debian testing - Debian Manpages (apt install can-utils)</a></p>
<p>candump any re√ßoit en boucle</p>
<p>finalement on va laisser tomber spidev et utiliser bash directement</p>
<p>librairie python : spidev (jamais utilis√©)</p>
<p><a href="https://pypi.org/project/spidev/">https://pypi.org/project/spidev/</a></p>
<p><a href="https://www.sigmdel.ca/michel/ha/rpi/dnld/draft_spidev_doc_fr.pdf">https://www.sigmdel.ca/michel/ha/rpi/dnld/draft_spidev_doc_fr.pdf</a></p>
<p><a href="https://raspberrypi-aa.github.io/session3/spi.html">https://raspberrypi-aa.github.io/session3/spi.html</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="d√©tection-de-ladversaire--lidar"><a class="header" href="#d√©tection-de-ladversaire--lidar">D√©tection de l'adversaire : LIDAR</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cr√©ation-dun-robot"><a class="header" href="#cr√©ation-dun-robot">Cr√©ation d'un robot</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python-setuppy-deprecated"><a class="header" href="#python-setuppy-deprecated">Python setup.py deprecated:</a></h1>
<pre><code>Starting &gt;&gt;&gt; my_python_node
--- stderr: my_python_node                   
/usr/lib/python3/dist-packages/setuptools/command/install.py:34: SetuptoolsDeprecationWarning: setup.py install is deprecated. Use build and pip and other standards-based tools.
  warnings.warn(
---
Finished &lt;&lt;&lt; my_python_node [0.64s]

Summary: 1 package finished [1.19s]
  1 package had stderr output: my_python_node
</code></pre>
<p>Solution: <code>pip install setuptools==58.2.0</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="electronique-logicielle"><a class="header" href="#electronique-logicielle">Electronique Logicielle</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="organisation-du-code"><a class="header" href="#organisation-du-code">Organisation du code</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="guide-dutilisation-rust"><a class="header" href="#guide-dutilisation-rust">Guide d'utilisation Rust</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="guide-dutilisation-c"><a class="header" href="#guide-dutilisation-c">Guide d'utilisation C</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="comment-compiler"><a class="header" href="#comment-compiler">Comment compiler</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="comment-flasher"><a class="header" href="#comment-flasher">Comment flasher</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="comment-debugger"><a class="header" href="#comment-debugger">Comment debugger</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="communication-des-modules-avec-linfo"><a class="header" href="#communication-des-modules-avec-linfo">Communication des modules avec l'info</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="electronique-mat√©rielle"><a class="header" href="#electronique-mat√©rielle">Electronique Mat√©rielle</a></h1>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="guide-dutilisation-kicad"><a class="header" href="#guide-dutilisation-kicad">Guide d'utilisation Kicad</a></h1>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="r√®gles-de-jeu-en-elec-hard"><a class="header" href="#r√®gles-de-jeu-en-elec-hard">R√®gles de jeu en elec-hard.</a></h1>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="moteur-pas-√†-pas-mpp"><a class="header" href="#moteur-pas-√†-pas-mpp">Moteur pas √† pas (MPP)</a></h1>
<p><strong>Que-ce que c'est un moteur pas √† pas? Et pour quoi est-t-il utile?</strong></p>
<ul>
<li>
<p>Un MPP est un moteur √©lectrique, sans balais et √† courant continu, qui permet un contr√¥le pr√©cis en <a href="https://fr.wikipedia.org/wiki/Circuit_en_boucle_ouverte">boucle ouverte</a>. Au contraire des moteurs √† courant continu, les MPP tournent de mani√®re <em>discr√®te</em> (d'o√π le nom "pas √† pas"), normalement √† 200 pas par rotation, donc un rotation de 1.8 degr√©s par pas.</p>
</li>
<li>
<p>Le principale avantage d'un MPP est la pr√©cision</p>
</li>
</ul>
<p>Pour le robot de 2023, on a d√©cid√© d'utiliser des moteurs √† courant continu pour la base roulante, parce que d'apr√®s nos essais, les MPP ne fournissent pas suffisamment de force.<br />
N√©anmoins, les MPP peuvent √™tre utiles dans des futurs applications, d'o√π le n√©cessit√© de ce doc.</p>
<h2 id="fonctionnement-g√©n√©rale-du-moteur-pas-√†-pas"><a class="header" href="#fonctionnement-g√©n√©rale-du-moteur-pas-√†-pas">Fonctionnement g√©n√©rale du moteur pas √† pas.</a></h2>
<p><a href="https://www.tme.eu/fr/news/library-articles/page/41861/Moteur-pas-a-pas-types-et-exemples-dapplications-des-moteurs-pas-a-pas/">Vous trouvez ici</a> un explication d√©taill√© de la fonctionnement d'un MPP.</p>
<h3 id="comment-contr√¥ler-un-mpp"><a class="header" href="#comment-contr√¥ler-un-mpp">Comment contr√¥ler un MPP?</a></h3>
<p>On utilise des microcontr√¥leurs (STM32) pour contr√¥ler les MPP. Les STM32 permettent d'envoyer un signal pr√©cis, mais pas √† la puissance requise. Pour r√©soudre cette probl√®me, un utilise un STM32 pour "g√©rer" la connexion entre les moteurs et un alimentation √† puissance suffisante. Un mani√®re pour faire cela est avec des transistors mont√©es en <a href="https://www.a-m-c.com/fr/experience/technologies/power-devices/pont-en-h/#">pont H</a>.</p>
<p>Pour simplifier l'impl√©mentation de la circuit de contr√¥le, on a achet√© des cartes √©lectroniques qui int√®grent un montage en pont H, avec des protections et option de "microstepping".</p>
<p>Le carte que l'on a achet√© est: <a href="https://www.pololu.com/product/2968">Pololu MP6500 Stepper Motor Driver Carrier, Digital Current Control</a>. Sur le site vous trouvez toute l'information dont vous avez besoin pour utiliser le driver, et un sch√©ma √©lectronique pour l'impl√©menter.</p>
<p>Au moment que l'on √©crit cette doc (7/12/23), on a 5 cartes dans le club.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="m√©canique"><a class="header" href="#m√©canique">M√©canique</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="guide-dutilisation-creo"><a class="header" href="#guide-dutilisation-creo">Guide d'utilisation Creo</a></h1>
<h2 id="etape-1--t√©l√©chargement"><a class="header" href="#etape-1--t√©l√©chargement">Etape 1 : T√©l√©chargement</a></h2>
<p>On travaille avec <strong>Creo Parametric 9</strong>, pour le t√©l√©charger, il faut suivre le lien : <a href="https://www.ptc.com/en/products/education/free-software/creo-college-download">Installer Creo</a>.
Il faut s'inscrire avec <strong>son mel INSA</strong> et suivre les √©tapes qui sont d√©montr√©s dans le video : <a href="https://www.youtube.com/watch?v=LYNOAizD2eE">How to download creo 7.0 student version for free</a>. Mais bien √©videment au lieu de Creo 7 dans toutes les instances il faut choisir le <strong>Creo 9</strong>.
Si le video n'est pas disponible, veuillez vous addresser √† votre responsable de p√¥le M√©canique.</p>
<h2 id="etape-2--configuration"><a class="header" href="#etape-2--configuration">Etape 2 : Configuration</a></h2>
<p>Il faut t√©l√©charger le ficher <a href="https://github.com/ClubRobotInsat/doc/blob/master/src/mecanique/config.pro">config.pro</a> et remplacer sur votre ordinateur dans la destination suivante : <em>"C:\Program Files\PTC\Creo 9.0.0.0\Common Files\text"</em> (si vous l'avez install√© ailleurs, il faut trouver o√π ils sont vos <em>Program Files</em> et le reste suivre comme dans le lien).
Cette config a pour but de faire 2 choses :</p>
<ol>
<li>Utilisation d'unit√©s m√©triques par d√©faut (sinon c'est en inch et pas coh√©rente avec la logique parce que les unit√©s imperiales ne servent √† rien)</li>
<li>Faire un sort que Creo ne garde pas les anciennes versions de vos fichers pour ne pas cr√©er des erreurs sur github (voire le tutoriel de git pour les m√©cas)</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="utilisation-de-la-d√©coupeuse-laser"><a class="header" href="#utilisation-de-la-d√©coupeuse-laser">Utilisation de la d√©coupeuse laser</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="utilisation-de-limprimante-3d"><a class="header" href="#utilisation-de-limprimante-3d">Utilisation de l'imprimante 3D</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="utilisation-de-la-fraiseuse"><a class="header" href="#utilisation-de-la-fraiseuse">Utilisation de la fraiseuse</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="robot"><a class="header" href="#robot">Robot</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="base-roulante-1"><a class="header" href="#base-roulante-1">Base roulante</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bras-robotique-1"><a class="header" href="#bras-robotique-1">Bras robotique</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="conception-modulaire-1"><a class="header" href="#conception-modulaire-1">Conception modulaire</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="retour-dexp√©riences"><a class="header" href="#retour-dexp√©riences">Retour d'exp√©riences</a></h1>
<p>Ce chapitre contient les retours d'exp√©riences des ann√©es pr√©c√©dentes.</p>
<p>Le but est de garder une trace de ce qui a √©t√© fait, des erreurs commises et des solutions trouv√©es. Cela permettra de ne pas refaire les m√™mes erreurs et de gagner du temps.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="retour-exp√©rience-2023-2024"><a class="header" href="#retour-exp√©rience-2023-2024">Retour exp√©rience 2023-2024</a></h1>
<h2 id="introduction-5"><a class="header" href="#introduction-5">Introduction</a></h2>
<p>Ce document est un retour d'exp√©rience sur l'ann√©e 2023-2024.</p>
<h2 id="√âtat-du-club-en-d√©but-dann√©e"><a class="header" href="#√âtat-du-club-en-d√©but-dann√©e">√âtat du club en d√©but d'ann√©e</a></h2>
<p>D'un point de vue administratif, le club est en bonne sant√©, mais il y a peu de membres.</p>
<p>Cela fait 2 ans que le club a √©t√© relanc√©, mais toujours pas de robot fonctionnel pour la Coupe de France.</p>
<p>Les membres sont motiv√©s, mais il y a peu de nouveaux membres.</p>
<p>Les formations ont √©t√© trop longues les ann√©es pr√©c√©dentes =&gt; les nouveaux membres ont abandonn√© et pas assez de temps pour faire un robot.</p>
<p>Changement de STM32 car elles ne sont plus disponibles =&gt; la biblioth√®que Rust n'est plus compatible.</p>
<p>Une frustation s'est install√©e chez les membres car ils n'arrivent pas √† faire un robot.</p>
<p>Probl√®mes avec la comp√©tition VEX U =&gt; prendre une d√©cision sur la participation √† la comp√©tition.</p>
<h2 id="d√©finir-les-objectifs"><a class="header" href="#d√©finir-les-objectifs">D√©finir les objectifs</a></h2>
<p>Les objectifs de l'ann√©e ont √©t√© d√©finis en d√©but d'ann√©e.</p>
<p><strong>Premi√®res d√©cisions:</strong></p>
<ul>
<li>Ne pas participer √† la comp√©tition VEX U</li>
<li>Participer √† la Coupe de France 2024 et faire un robot qui se d√©place</li>
</ul>
<p><strong>Objectifs de l'ann√©e:</strong></p>
<ul>
<li>Participer √† la Coupe de France 2024</li>
<li>Faire un robot qui se d√©place</li>
<li>Cr√©er des modules r√©utilisables pour les ann√©es suivantes</li>
<li>Attirer de nouveaux membres</li>
<li>Faire des formations plus courtes et plus efficaces</li>
<li>Augmenter la communication entre les p√¥les</li>
<li>Augmenter la coh√©sion de l'√©quipe</li>
<li>Augmenter la communication externe</li>
</ul>
<h2 id="d√©cisions-prises-pour-atteindre-les-objectifs"><a class="header" href="#d√©cisions-prises-pour-atteindre-les-objectifs">D√©cisions prises pour atteindre les objectifs</a></h2>
<h3 id="organisation-de-l√©quipe"><a class="header" href="#organisation-de-l√©quipe">Organisation de l'√©quipe</a></h3>
<p>Comme on arr√™te la comp√©tition VEX U, on a moins besoin de responsables.</p>
<p>Retour √† une structure plus simple:</p>
<ul>
<li>Bureau : 3 personnes
<ul>
<li>Un pr√©sident: <a href="https://github.com/BloodFutur">Ronan BONNET</a></li>
<li>Un tr√©sorier: Matteo GEST</li>
<li>Un secr√©taire: Triet</li>
</ul>
</li>
<li>Un responsable Coupe de France: Artur
<ul>
<li>Responsable √©lectronique</li>
<li>Responsable informatique</li>
<li>Responsable m√©canique</li>
</ul>
</li>
</ul>
<p>Les ann√©es pr√©c√©dentes, les responsables de p√¥les ne pouvaient pas √™tre dans le bureau. Cette ann√©e, on a d√©cid√© de changer cela pour 2 raisons, simplifier la structure, et avoir des responsables de p√¥les plus impliqu√©s dans le club et par manque de membres.</p>
<h3 id="gestion-de-la-communication-1"><a class="header" href="#gestion-de-la-communication-1">Gestion de la communication</a></h3>
<p>La communication continue de se faire principalement sur Discord. Nous avons invit√©s les nouveaux membres.</p>
<p><strong>Ajouts</strong>:</p>
<ul>
<li>R√©union plus r√©guli√®re avec l'ensemble des membres pour faire un point sur l'avancement du projet et avoir un retour des membres</li>
</ul>
<h3 id="gestion-des-connaisances"><a class="header" href="#gestion-des-connaisances">Gestion des connaisances</a></h3>
<ul>
<li>Continuer les formations mais plus courtes et plus efficaces, avec des exercices pratiques</li>
</ul>
<p><strong>Ajouts</strong>:</p>
<ul>
<li>Remettre en place une documentation pour garder une trace de ce qui a √©t√© fait, des erreurs commises et des solutions trouv√©es. Cela permettra de ne pas refaire les m√™mes erreurs et de gagner du temps.</li>
<li>Demander aux membres de faire des retours d'exp√©riences sur ce qu'ils ont fait</li>
</ul>
<h3 id="d√©finir-larchitecture-du-projet"><a class="header" href="#d√©finir-larchitecture-du-projet">D√©finir l'architecture du projet</a></h3>
<ul>
<li>Garder la m√™me architecture que l'ann√©e pr√©c√©dente</li>
<li>Tester une base roulante avec des moteurs pas √† pas</li>
</ul>
<h3 id="gestion-de-projet-1"><a class="header" href="#gestion-de-projet-1">Gestion de projet</a></h3>
<p>Difficult√©s rencontr√©es les ann√©es pr√©c√©dentes:</p>
<ul>
<li>Plein de mini-projets dans tous les sens</li>
<li>Pas d'int√©gration des modules entre eux</li>
<li>Pas de robot fonctionnel</li>
<li>Pas de priorisation des t√¢ches</li>
<li>Manque de motivation des membres</li>
</ul>
<h3 id="strat√©gie-d√©cid√©e"><a class="header" href="#strat√©gie-d√©cid√©e">Strat√©gie d√©cid√©e</a></h3>
<p>Tout d'abord on a d√©cid√© de faire une hi√©rarchisation des fonctionnalit√©s du robot.</p>
<p><strong>Priorisation des fonctionnalit√©s:</strong></p>
<ol>
<li>Se d√©placer</li>
<li>Communiquer avec l'info et les autres modules</li>
<li>Se rep√©rer sur le terrain</li>
<li>Strat√©gie basique hardcod√©e</li>
<li>Vision</li>
<li>Strat√©gie avanc√©e</li>
</ol>
<p>On se focalise sur les t√¢ches 1 avant d'attaquer les t√¢ches 2, etc.</p>
<p>Une fois les t√¢ches 1 termin√©es, on s'assure de l'int√©gration des modules entre eux. On les teste ensemble. On √©crit de la documentation pour les modules. Puis on passe aux t√¢ches 2, etc.</p>
<p>De cette mani√®re, les membres sont plus motiv√©s car ils voient le robot avancer. Ils peuvent aussi se concentrer sur un module √† la fois.</p>
<h3 id="gestion-de-la-documentation-1"><a class="header" href="#gestion-de-la-documentation-1">Gestion de la documentation</a></h3>
<ul>
<li>R√©cup√©rer la documentation des ann√©es pr√©c√©dentes</li>
<li>Mettre √† jour la documentation sur le site web</li>
<li>Mettre √† jour la documentation au fur et √† mesure de l'ann√©e</li>
</ul>
<h3 id="gestion-de-la-communication-externe"><a class="header" href="#gestion-de-la-communication-externe">Gestion de la communication externe</a></h3>
<ul>
<li>Mettre √† jour le site web</li>
<li>Mettre √† jour les r√©seaux sociaux</li>
<li>Faire des posts sur les r√©seaux sociaux pour montrer l'avancement du projet</li>
<li>Faire des posts sur les r√©seaux sociaux pour montrer les membres du club</li>
<li>Faire des √©v√©nements pour montrer le club</li>
<li>Faire des √©v√©nements avec le club info</li>
</ul>
<h2 id="probl√®mes-rencontr√©s"><a class="header" href="#probl√®mes-rencontr√©s">Probl√®mes rencontr√©s</a></h2>
<h3 id="probl√®mes-administratifs"><a class="header" href="#probl√®mes-administratifs">Probl√®mes administratifs</a></h3>
<ul>
<li>Changement du syst√®me de l'Amicale compar√© aux ann√©es pr√©c√©dentes =&gt; perte de environ 3800‚Ç¨ de budget sur la strat√©gie de financement</li>
<li>Difficult√© de communication avec l'Amicale</li>
<li>Pertes de temps pour les d√©marches administratives</li>
</ul>
<h3 id="probl√®mes-techniques"><a class="header" href="#probl√®mes-techniques">Probl√®mes techniques</a></h3>
<h4 id="base-roulante-avec-moteurs-pas-√†-pas"><a class="header" href="#base-roulante-avec-moteurs-pas-√†-pas">Base roulante avec moteurs pas √† pas</a></h4>
<p>‚ö†Ô∏è TODO: mettre les probl√®mes rencontr√©s</p>
<h4 id="changement-de-stm32f103-vers-stm32g431"><a class="header" href="#changement-de-stm32f103-vers-stm32g431">Changement de STM32F103 vers STM32G431</a></h4>
<p><strong>Inconvenients:</strong></p>
<ul>
<li>La biblioth√®que Rust n'est plus compatible</li>
<li>Les librairies d√©velopp√©es les ann√©es pr√©c√©dentes ne sont plus compatibles</li>
<li>Les membres ne connaissent pas les STM32G431 et pas trop le C</li>
<li>Le C peut apporter plien de probl√®mes de m√©moire, de pointeurs, etc.</li>
</ul>
<p><strong>Avantages:</strong></p>
<ul>
<li>Plus simple √† programmer</li>
<li>Plus de ressources sur internet</li>
</ul>
<h4 id="probl√®mes-de-communication-entre-stm32-et-raspberry-pi"><a class="header" href="#probl√®mes-de-communication-entre-stm32-et-raspberry-pi">Probl√®mes de communication entre STM32 et Raspberry Pi</a></h4>
<p><strong>Probl√®me:</strong></p>
<ul>
<li>La communication entre les STM32 et la Raspberry Pi ne fonctionne pas</li>
<li>La documentation sur les BUS CAN du club ne permet pas de faire fonctionner le bus CAN</li>
<li></li>
</ul>
<p><strong>Solution:</strong>
Refaire circuit pour faire communiquer les STM32 entre elles.
Voir <a href="retour_dexperiences/retour_dexperiences/../../informatique/communication.html#exemple-de-connexion-entre-deux-stm32">circuit</a>. Perte de temps √©norme (environ 3 mois).</p>
<h2 id="r√©sultats-et-productions"><a class="header" href="#r√©sultats-et-productions">R√©sultats et productions</a></h2>
<h3 id="base-roulante-avec-moteurs-pas-√†-pas-1"><a class="header" href="#base-roulante-avec-moteurs-pas-√†-pas-1">Base roulante avec moteurs pas √† pas</a></h3>
<p>‚ö†Ô∏è TODO: Mettre les r√©sultats, ce qui a √©t√© fait, ce qui n'a pas √©t√© fait</p>
<h3 id="base-roulante-avec-moteurs-dc"><a class="header" href="#base-roulante-avec-moteurs-dc">Base roulante avec moteurs DC</a></h3>
<p>‚ö†Ô∏è TODO: Mettre les r√©sultats, ce qui a √©t√© fait, ce qui n'a pas √©t√© fait, liens vers les pages de la doc</p>
<h3 id="bus-can-fonctionnel-entre-stm32g431"><a class="header" href="#bus-can-fonctionnel-entre-stm32g431">Bus CAN fonctionnel entre STM32G431</a></h3>
<p>‚ö†Ô∏è TODO: Mettre les r√©sultats, ce qui a √©t√© fait, ce qui n'a pas √©t√© fait, liens vers les pages de la doc</p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="retour-dexp√©rience-ann√©e-2022-2023"><a class="header" href="#retour-dexp√©rience-ann√©e-2022-2023">Retour d'exp√©rience ann√©e 2022-2023</a></h1>
<p>‚ö†Ô∏è TODO: √† compl√©ter</p>
<h2 id="introduction-6"><a class="header" href="#introduction-6">Introduction</a></h2>
<h2 id="gestion-de-projet-2"><a class="header" href="#gestion-de-projet-2">Gestion de projet</a></h2>
<h2 id="technique"><a class="header" href="#technique">Technique</a></h2>
<h2 id="conclusion-1"><a class="header" href="#conclusion-1">Conclusion</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="retour-exp√©rience-2021-2022"><a class="header" href="#retour-exp√©rience-2021-2022">Retour exp√©rience 2021-2022</a></h1>
<h2 id="introduction-7"><a class="header" href="#introduction-7">Introduction</a></h2>
<p>Ce document est un retour d'exp√©rience sur la Coupe de France 2022 et la comp√©tition VEX U.</p>
<p>Le club a √©t√© relanc√© cette ann√©e pour participer √† la Coupe de France 2022. Nous avons donc d√ª repartir de z√©ro pour tout ce qui est √©lectronique, informatique et m√©canique.</p>
<p>Afin de relancer le club, nous avons √©galement particip√© √† la comp√©tition VEX U.</p>
<h2 id="gestion-de-projet-3"><a class="header" href="#gestion-de-projet-3">Gestion de projet</a></h2>
<h3 id="organisation-de-l√©quipe-1"><a class="header" href="#organisation-de-l√©quipe-1">Organisation de l'√©quipe</a></h3>
<p>Cette ann√©e-l√†, nous √©tions environ une vingtaine de membres. Le club √©tait structur√© de la mani√®re suivante :</p>
<ul>
<li>Bureau : 3 personnes
<ul>
<li>Un pr√©sident (Max)</li>
<li>Un tr√©sorier (Andrea)</li>
<li>Un secr√©taire (Ronan)</li>
</ul>
</li>
<li>Responsables de p√¥le : 7 personnes
<ul>
<li>Responsable Coupe de France
<ul>
<li>Responsable √©lectronique</li>
<li>Responsable informatique</li>
<li>Responsable m√©canique</li>
</ul>
</li>
<li>Responsable VEX U
<ul>
<li>Responsable informatique</li>
<li>Responsable m√©canique</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>La r√©partition des r√¥les a √©t√© faite en fonction des affinit√©s de chacun.</p>
<p><strong>R√©sultat :</strong></p>
<p>Cette organisation a plus ou moins bien fonctionn√©. Les responsables de p√¥le ont pu se concentrer sur leur p√¥le et ont pu faire avancer les choses. Cependant, il y a eu un manque de communication entre les p√¥les. Tout le monde n'√©tait pas au courant de ce que faisait les autres.</p>
<p>Trop de responsables pour peu de membres a √©galement √©t√© un probl√®me.</p>
<h3 id="gestion-de-la-communication-2"><a class="header" href="#gestion-de-la-communication-2">Gestion de la communication</a></h3>
<p>La communication s'est faite principalement sur Discord. Nous avons cr√©√© un serveur Discord pour le club. Les membres ont √©t√© invit√©s √† rejoindre le serveur mais ils ne l'ont pas tous fait.</p>
<h3 id="d√©finir-les-objectifs-1"><a class="header" href="#d√©finir-les-objectifs-1">D√©finir les objectifs</a></h3>
<p>Les objectifs de l'ann√©e ont √©t√© d√©finis en d√©but d'ann√©e. Nous avons d√©cid√© de participer √† la Coupe de France 2022 et √† la comp√©tition VEX U.</p>
<p>Pour la Coupe de France, les objectifs √©taient les suivants :</p>
<ul>
<li>Participer √† la Coupe de France 2022</li>
<li>Faire un robot qui se d√©place</li>
<li>Cr√©er des modules r√©utilisables pour les ann√©es suivantes</li>
</ul>
<p>Pour la comp√©tition VEX U, les objectifs √©taient les suivants :</p>
<ul>
<li>Participer √† la comp√©tition VEX U</li>
<li>Attirer de nouveaux membres</li>
</ul>
<p><strong>R√©sultat :</strong></p>
<p>Nous avons particip√© √† la Coupe de France 2022 et √† la comp√©tition VEX U.</p>
<p>Pour VEX U, nous avons r√©ussi √† attirer de nouveaux membres et la comp√©tition s'est bien pass√©e.</p>
<p>Pour la Coupe de France, nous avons pas r√©ussi √† avoir un robot qui se d√©place pour la comp√©tition. Repartir de z√©ro a √©t√© plus long que pr√©vu. Nous avons cependant r√©ussi √† cr√©er des modules r√©utilisables pour les ann√©es suivantes.</p>
<h2 id="technique-1"><a class="header" href="#technique-1">Technique</a></h2>
<h3 id="d√©finir-larchitecture-du-projet-1"><a class="header" href="#d√©finir-larchitecture-du-projet-1">D√©finir l'architecture du projet</a></h3>
<p>L'architecture du projet a √©t√© d√©finie en d√©but d'ann√©e. Nous avons d√©cid√© de faire un robot modulaire. Le robot est compos√© de plusieurs modules qui peuvent √™tre assembl√©s pour former le robot final.</p>
<p><strong>Choix techniques:</strong></p>
<ul>
<li>STM32 pour la partie √©lectronique</li>
<li>Raspberry Pi pour la partie informatique</li>
<li>Une base roulante simple</li>
<li>Un bras robotique</li>
<li>Un syst√®me de pompe √† vide</li>
<li>Communication entre les modules via le bus CAN</li>
<li>D√©tection de l'adversaire via un LIDAR</li>
</ul>
<p><strong>R√©sultat :</strong></p>
<p>L'architecture du projet a bien √©t√© d√©finie car il est utilis√© encore aujourd'hui. Cette architecture se retrouve √©galement dans de nombreux projets industriels et dans le projet GEI-car.</p>
<h3 id="√âlectronique"><a class="header" href="#√âlectronique">√âlectronique</a></h3>
<ul>
<li>Difficult√© √† trouver des composants</li>
<li>Difficult√© √† flasher les STM32</li>
<li>Difficult√© √† communiquer avec les STM32</li>
<li>Difficult√© √† utiliser le bus CAN</li>
<li>Difficult√© √† faire des cartes √©lectroniques sans court-circuit</li>
</ul>
<p><strong>R√©sultat :</strong></p>
<ul>
<li>Quelques cartes √©lectroniques ont √©t√© faites mais comportaient des erreurs. Elles n'ont pas pu √™tre utilis√©es.</li>
<li>Code pour flasher les STM32 fonctionnel</li>
<li>Code pour base roulante avec PID fonctionnel</li>
<li>Code pour utiliser les Herkulex fonctionnel</li>
<li>Can fonctionnel entre STM32</li>
<li>Trop de court-circuit sur les cartes √©lectroniques</li>
</ul>
<h3 id="informatique-1"><a class="header" href="#informatique-1">Informatique</a></h3>
<p>Peu de choses ont √©t√© faites car difficult√©s en √©lectronique et m√©canique.</p>
<h3 id="m√©canique-1"><a class="header" href="#m√©canique-1">M√©canique</a></h3>
<ul>
<li>Difficult√© √† trouver des membres faisant de la m√©canique</li>
<li>Oubli√© de v√©rifier les r√®gles de la Coupe de France</li>
</ul>
<h2 id="conclusion-2"><a class="header" href="#conclusion-2">Conclusion</a></h2>
<h3 id="points-positifs"><a class="header" href="#points-positifs">Points positifs</a></h3>
<ul>
<li>Participation √† la Coupe de France 2022</li>
<li>Participation √† la comp√©tition VEX U</li>
<li>Relance du club</li>
<li>Cr√©ation d'une architecture modulaire</li>
<li>Cr√©ation d'une base roulante</li>
<li>Cr√©ation d'un bras robotique</li>
</ul>
<h3 id="points-n√©gatifs"><a class="header" href="#points-n√©gatifs">Points n√©gatifs</a></h3>
<ul>
<li>Manque de communication entre les p√¥les</li>
<li>Manque de temps</li>
<li>Pas de robot fonctionnel pour la Coupe de France</li>
<li>Formation trop longue</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="cette-section-garde-toutes-les-archives-de-doc-faite-auparavant"><a class="header" href="#cette-section-garde-toutes-les-archives-de-doc-faite-auparavant">Cette section garde toutes les archives de doc faite auparavant.</a></h2>
<div style="break-before: page; page-break-before: always;"></div><p><img src="pre_2021/images/com/logo18.png" alt="" title="Logo du Club Robot" /></p>
<h1 id="introduction-8"><a class="header" href="#introduction-8">Introduction</a></h1>
<p>Ce site internet contient la documentation du Club Robot de l'INSA Toulouse pour les parties √©lectronique et informatique du robot.</p>
<p>Ce livre est r√©dig√© avec <a href="https://github.com/rust-lang-nursery/mdBook">md-book</a>.</p>
<p>Le but de ce livre est de te guider pour l'installation des diff√©rents outils permettant de programmer au Club Robot.</p>
<p>Ce livre ne documentera pas le code du club, mais peut documenter les diff√©rents fichiers d'un projet. Il est l√† pour servir de r√©f√©rence en cas de probl√®me et de questions vis √† vis d'un fichier.</p>
<p>Sa lecture est pr√©liminaire √† la formation organis√©e en d√©but d'ann√©e, et son but est de nous faire gagner du temps en vous faisant installer √† la maison les outils de d√©vellopement.</p>
<p>Enfin, son √©criture a commenc√© apr√®s Chocobot √† la coupe de france de 2018 (Robot Cities).</p>
<p>Pour la suite du "livre", si on s'est occup√© de t'installer linux sur ton ordinateur ou si tu as une version de Ubuntu r√©cente (&gt;16.04) tu peux te consid√©rer comme un utilisateur "standard" et tu n'as pas besoin de suivre les sections pour les <em>power user</em>.</p>
<p>Si jamais tu trouves des fautes d'orthographes, des erreurs, des remarques ou toutes autres formes de contribution √† faire n'h√©site <strong>surtout pas</strong>. Les sources de ce livre sont sur <a href="https://github.com/ClubRobotInsat/doc-elec">ce repertoire github</a>, et il n'y a pas besoin de <code>git</code> pour y apporter des modifications simples : l'interface en ligne de github te permet de modifier les fichiers textes et de cr√©er ton premier <em>commit</em> en quelques secondes! Il faut juste penser √† demander aux membres du club d'ajouter ton compte dans la liste des utilisateurs autoris√©s.</p>
<p>Enfin, la phrase la plus importante en informatique √† garder en t√™te durant toute ta formation :</p>
<blockquote>
<p>Le mieux est l'ennemi du bien, surtout au club robot.</p>
</blockquote>
<p><em>Un illustre anonyme</em></p>
<p><img src="pre_2021/images/com/tester_doute.jpeg" alt="Tester c&#39;est douter" title="Tester c&#39;est douter" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="outils-communs-1"><a class="header" href="#outils-communs-1">Outils Communs</a></h1>
<p>Cette section r√©pertorie les principaux outils utilis√©s au Club Robot.</p>
<p>Ce tableau t'aidera √† savoir quelles pages t'int√©ressent en fonction de ton p√¥le de pr√©dilection :</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center"></th><th style="text-align: center"><a href="pre_2021/outils_communs/outils_communs/git.html">git</a></th><th style="text-align: center"><a href="pre_2021/outils_communs/outils_communs/ide.html">CLion</a></th><th style="text-align: center"><a href="pre_2021/outils_communs/info/outils/cmake.html">CMake</a></th><th style="text-align: center"><a href="pre_2021/outils_communs/elec_mat/tools.html">Kicad</a></th></tr></thead><tbody>
<tr><td style="text-align: center">Informatique</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center"></td></tr>
<tr><td style="text-align: center">Electronique software</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: center">Electronique hardware</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center">‚úîÔ∏è</td></tr>
<tr><td style="text-align: center">M√©canique</td><td style="text-align: center">‚úîÔ∏è</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="dual-boot-avec-linux"><a class="header" href="#dual-boot-avec-linux">Dual Boot avec Linux</a></h1>
<p>Tu as probablement un ordinateur sous Windows. Cependant, d√©velopper sous ce syst√®me d'exploitation est compliqu√© donc on utilise des syst√®mes Linux au club.</p>
<p>Tu as diff√©rentes mani√®res d'utiliser Linux :</p>
<ul>
<li>Utiliser <a href="https://www.virtualbox.org/">VirtualBox</a>, une machine virtuelle pour ex√©cuter Linux √† l'int√©rieur de Windows (cependant, ton ordinateur va devoir ex√©cuter deux syst√®mes d'exploitation en m√™me temps donc il y aura des pertes de performance)</li>
<li>Installer un dual boot, c'est √† dire qu'au d√©marrage de ton ordinateur, soit Windows soit Linux va √™tre lanc√©, donc les performances de chaque OS vont √™tre maximales mais ton disque dur aura une partie attribu√©e √† Windows et une autre √† Linux.</li>
</ul>
<p>Ce tuto est l√† pour t'expliquer comment installer un environnement sympa sous Linux.</p>
<h2 id="pr√©liminaires-sous-windows-1"><a class="header" href="#pr√©liminaires-sous-windows-1">Pr√©liminaires sous Windows</a></h2>
<p>Avant tout, il faut faire quelques r√©glages sous Windows pour permettre l'installation d'un nouveau syst√®me d'expoitation (Windows n'aime pas trop partager un ordinateur). Pense aussi √† sauvegarder toutes les donn√©es importantes ailleurs que sur ton PC. Je n'ai jamais eu de probl√®me avec une installation de Linux, mais comme d'habitude, quand on joue avec les partitions de son disque dur, on prend des pr√©cautions (panne de courant/batterie pendant une √©tape critique par exemple).</p>
<ul>
<li><strong>D√©sactiver la mise en veille prolong√©e :</strong> par d√©faut, Windows ne s'√©teint pas quand on le lui dit mais rentre en veille prolong√©e. Ceci est totalement inutile depuis qu'il y a des disques SSD, et √ßa emp√®che de d√©marrer sous un autre OS
<ul>
<li>ouvrir un terminal avec les droits administrateur (clic droit sur le logo windows, shell)</li>
<li>entrer la commande <code>powercfg -h off</code></li>
</ul>
</li>
<li><strong>Partitionner le disque dur :</strong> afin d'√©viter tout probl√®me de partionnement √† cause de la fragmentation Windows, il vaut mieux utiliser directement les outils de Windows :
<ul>
<li>appuyer sur <code>Windows + R</code></li>
<li>saisir <code>diskmgmt.msc</code></li>
<li>clic droit sur le volume √† partitionner (<em>Disque 0</em>) et s√©lectionner <code>R√©duire le volume</code></li>
<li>choisir la taille de la partition d√©sir√©e (Ubuntu demande 15Go minimum et recommande 25Go ; si tu as de la place tu peux faire une nouvelle partition √† <code>40Go</code> pour √™tre large)</li>
</ul>
</li>
</ul>
<p>Ton disque dur a maintenant un espace inutilis√©, il est temps de l'utiliser !</p>
<h2 id="choix-du-syst√®me-linux-1"><a class="header" href="#choix-du-syst√®me-linux-1">Choix du syst√®me Linux</a></h2>
<p>Il te faut √† pr√©sent choisir quel nouveau syst√®me d'exploitation utiliser. <strong>Linux</strong> est un <a href="https://upload.wikimedia.org/wikipedia/commons/1/1b/Linux_Distribution_Timeline.svg">univers tr√®s vaste</a>, que l'on peut sommairement classer :</p>
<ul>
<li>les syst√®mes bas√©s sur les fichiers <code>.rpm</code>
<ul>
<li>CentOS</li>
<li>Fedora</li>
<li>openSUSE</li>
</ul>
</li>
<li>les syst√®mes d√©rivant de <code>Debian</code>
<ul>
<li><strong>Ubuntu</strong></li>
<li>Kali Linux</li>
</ul>
</li>
<li>les syst√®mes bas√©s sur le <em>packet manager</em> <code>pacman</code>
<ul>
<li>Arch Linux</li>
<li><strong>Manjaro</strong></li>
</ul>
</li>
</ul>
<p>Tu peux demander des conseils aux membres si tu ne sais pas quel OS prendre, ils pourront m√™me t'en faire essayer plusieurs !</p>
<h3 id="ubuntu-1804"><a class="header" href="#ubuntu-1804">Ubuntu 18.04</a></h3>
<p>Si tu n'as aucune id√©e de quel syst√®me choisir, je te conseille <a href="https://www.ubuntu.com/download/desktop">Ubuntu 18</a>, un syst√®me communautaire LTS (<em>Long Term Supported</em>) qui est tr√®s simple √† prendre en main et pour laquelle les nombreux forums r√©pondent √† toutes tes questions.</p>
<p>Pour l'installer, il te suffit de <a href="https://www.ubuntu.com/download/desktop/thank-you?country=US&amp;version=18.04.1&amp;architecture=amd64">t√©l√©charger l'ISO</a> et la mettre sur une clef USB.</p>
<p><strong>! Attention !</strong>
Sauvegarde toutes les donn√©es sur ta cl√© USB avant de continuer ! Ta clef sera effac√©e par la suite (mais tu pourras la r√©initialiser apr√®s avoir install√© Linux, puis remettre tes donn√©es dessus ensuite).</p>
<p>Par "mettre sur une clef USB", on entend "flasher une image disque", mais c'est un terme barbare. Ici il ne te sera expliqu√© que comment faire.
Le moyen le plus simple est d'utiliser <a href="https://etcher.io/">Etcher</a>. C'est un logiciel open source et compatible sur Windows, Mac et Linux. Sa grande qualit√© est d'√™tre <strong>tres</strong> simple √† utiliser.</p>
<p>Une fois install√© et lanc√©, il n'y a litt√©ralement que quatre clics √† faire :</p>
<ul>
<li>"Select Image" t'invite a choisir l'ISO que tu as d√©j√† t√©l√©charg√©.</li>
<li>"Select Drive" te demande de choisir le disque (clef USB dans notre cas) √† flasher. C'est a dire qu'il sera <strong>formatt√©</strong> ( ! toutes les donn√©es dessus seront perdues !) puis que l'ISO y sera correctement install√©. Cette √©tape requiert de savoir ce que l'on fait : il faut √™tre <strong>absolument</strong> certain que le nom et la capacit√© du disque choisi correspondent √† ta clef USB, et <strong>surtout pas √† ton disque dur</strong>. Normalement Etcher est bien fait, et refuse de continuer si choisit un disque √† ne pas toucher, mais il vaut mieux √™tre trop prudent.</li>
<li>"Flash!" lance l'op√©ration et raconte ce qu'il fait √† ta clef au fur et √† mesure.</li>
</ul>
<p>Si tout c'est bien pass√©, ta "Live-USB" est pr√™te √† l'emploi. La suite d√©pend de ton ordinateur et de la distribution que tu veux installer.</p>
<h3 id="manjaro-linux"><a class="header" href="#manjaro-linux">Manjaro Linux</a></h3>
<p>Pour les utilisateurs un peu plus confirm√©s, je peux aussi conseiller <a href="https://manjaro.org/get-manjaro/">Manjaro</a>, qui se base sur Arch Linux. La configuration de ce syst√®me est totalement personnalisable et il existe de nombreuses variantes graphiques, en fonction de si tu pr√©f√®res des syst√®mes avec un bureau ou la gestion de fen√™tres comme <a href="https://forum.manjaro.org/t/manjaro-i3-17-1-11-17-1-12/51238">Manjaro i3</a>.</p>
<p>L√† encore, tu peux t√©l√©charger l'ISO qui te convient puis le mettre sur une clef USB.</p>
<h2 id="installation-sur-ton-ordinateur-dun-dual-boot-1"><a class="header" href="#installation-sur-ton-ordinateur-dun-dual-boot-1">Installation sur ton ordinateur d'un dual boot</a></h2>
<p>√Ä pr√©sent que tu es muni.e d'une clef bootable, tu peux la brancher sur ton ordinateur, appuyer sur la touche pour aller dans le BIOS (√ßa d√©pend du constructeur mais tu as de bonnes chances d'y parvenir en spammant <code>√âchap</code>, <code>F2</code>, <code>F9</code> ou <code>F11</code>) puis modifier quelques param√®tres :</p>
<ul>
<li>D√©sactive le <code>UEFI Secure Boot</code></li>
<li>D√©sactive le <code>Fast Start-Up</code></li>
<li>Change l'ordre de priorit√© pour booter afin de lancer ta clef USB en premi√®re</li>
</ul>
<p>Si tu as le moindre probl√®me je te conseille d'aller voir un membre du club, mais si ton √©cran affiche des choses en relation avec Linux et non pas l'√©cran de d√©marrage de Windows c'est gagn√© !</p>
<p>Tu peux choisir de tester l'OS ou alors de l'installer directement. L'interface devrait √™tre assez explicite ; il va juste te falloir r√©aliser une derni√®re manip sur la page des disques.</p>
<p>Pour √™tre s√ªr.e que tout se passe bien, choisis <code>Something else</code> lorsqu'on te demande o√π installer le syst√®me Linux. Ensuite, dans l'espace libre, tu peux attribuer 2Go √† une m√©moire de type <code>swap</code> (ce qui permets de soulager la RAM si tu lances des applications qui consomment trop). Tu peux attribuer le reste de l'espace libre pour Linux avec <code>type: ext4</code> et <code>mount point: /</code> en formatant l'espace pour √©viter tout probl√®me ult√©rieur.</p>
<p>Finalise l'installation et red√©marre ; si tu arrives sur une interface pour choisir entre Linux et Windows (c'est le <code>Grub 2</code>) tout marche comme il faut !!</p>
<h2 id="setup-de-linux-1"><a class="header" href="#setup-de-linux-1">Setup de Linux</a></h2>
<p>La premi√®re chose √† faire est de mettre √† jour ton syst√®me.</p>
<ul>
<li><strong>ArchLinux :</strong> <code>sudo pacman -Suy</code></li>
<li><strong>Debian :</strong> <code>sudo apt update &amp;&amp; sudo apt upgrade</code></li>
</ul>
<h3 id="installation-basique-1"><a class="header" href="#installation-basique-1">Installation basique</a></h3>
<p>Installons les paquets de base n√©c√©ssaire pour faire fonctionner les diff√©rents outils du club. Ouvre un terminal, et entres :</p>
<pre><code class="language-bash">sudo apt install git curl wget ntfs-3g python3 gcc gdb vim nano cmake
</code></pre>
<p>Les paquets install√©s sont les suivants :</p>
<ul>
<li>git	--&gt; un gestinnaire de version et de code</li>
<li>curl	--&gt; pour t√©l√©charger des objets en ligne de commandes</li>
<li>wget	--&gt; en gros, idem que curl</li>
<li>python3	--&gt; pour executer les scripts python3</li>
<li>gcc	--&gt; pour compiler du C/C++, toujours utile</li>
<li>gdb	--&gt; pour debugger du C/C++, toujours tr√®s utile</li>
<li>vim	--&gt; un √©diteur de texte en ligne de commande, un peu compliqu√© mais complet (pour quitter: ESC &gt; :q! &gt; ENTER)</li>
<li>nano	--&gt; un √©diteur de texte plus simple</li>
</ul>
<h2 id="installation-avanc√©e"><a class="header" href="#installation-avanc√©e">Installation avanc√©e</a></h2>
<p><em>Note : Cette partie est falcultative et non recommand√©e si c'est votre premi√®re installation de linux.</em></p>
<p>Ensuite, tu peux installer diff√©rents paquets sympatiques :</p>
<ul>
<li><strong>Archlinux</strong></li>
</ul>
<pre><code class="language-bash">sudo pacman -S ntfs-3g wget curl zsh thunderbird firefox rofi numlockx python-pip

sh -c "$(wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)"

cd /tmp
git clone https://github.com/meskarune/i3lock-fancy.git
cd i3lock-fancy
sudo make install

sudo wget https://cht.sh/:cht.sh -O /usr/local/bin/cht.sh
sudo chmod o+x /usr/local/bin/cht.sh

sudo pip install cheat
</code></pre>
<ul>
<li><strong>Ubuntu</strong></li>
</ul>
<pre><code class="language-bash">sudo apt-get install ntfs-3g wget curl zsh thunderbird firefox python-pip

sh -c "$(wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)"

sudo wget https://cht.sh/:cht.sh -O /usr/local/bin/cht.sh
sudo chmod o+x /usr/local/bin/cht.sh
</code></pre>
<hr />
<p>Si tu as un disque / partition en commun entre Windows et Linux (pour partager tes documents et musiques par exemple), tu as la possibilit√© de <em>monter</em> ce disque √† chaque lancement de Linux pour y avoir acc√®s facilement :</p>
<ul>
<li><code>sudo blkid</code> te donne des informations sur tous les disques</li>
<li>copie le <code>UUID</code> de la partition en commun</li>
<li>rajoute la ligne <code>UUID=&lt;ton_UUID_copi√©&gt; /media/commun ntfs-3g auto,user,exec,rw 0 0</code> √† la fin du fichier <code>/etc/fstab</code> (il faut ouvrir un √©diteur de texte en <code>sudo</code>)</li>
<li>au prochain red√©marrage, ton disque commun sera accessible dans <code>/media/commun/</code></li>
<li>tu pourras faire des liens symboliques pour acc√©der √† tes dossiers facilement, par exemple pour tes documents :</li>
</ul>
<pre><code class="language-bash">cd ~
rm -rf Documents
ln -s /media/commun/Documents .
</code></pre>
<hr />
<p>Enfin, si tu veux avoir des exemples de fichiers de configuration pour <strong>vim</strong>, <strong>git</strong>, <strong>zsh</strong> ou encore <strong>i3</strong> sous Manjaro-i3, tu peux aller voir <a href="https://github.com/terae/dotfiles">ce d√©p√¥t GitHub</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="git-1"><a class="header" href="#git-1">Git</a></h1>
<p><em>Cette page s'adresse √† tous les membres du Club.</em></p>
<p>On utilise un <a href="https://fr.wikipedia.org/wiki/Logiciel_de_gestion_de_versions">gestionnaire de versions</a> pour manager l'ensemble du code : <a href="https://git-scm.com/">git</a>.</p>
<p>Ce choix a de tr√®s nombreux avantages :</p>
<ul>
<li>L'√©volution de tout le code est sauvegard√©e donc on peut rappeler une version ant√©rieure d'un fichier √† tout moment</li>
<li>Si on perd des fichiers ou que l'on se trompe, on peut facilement revenir √† un √©tat stable</li>
<li><code>git</code> permets de collaborer sur un m√™me code, c'est √† dire que plusieurs d√©veloppeurs peuvent participer au code et le logiciel s'occupe de rassembler l'ensemble des modifications</li>
<li>On peut profiter de tous ces avantages avec tr√®s peu de travail suppl√©mentaire</li>
</ul>
<h2 id="installation-de-git-1"><a class="header" href="#installation-de-git-1">Installation de <code>git</code></a></h2>
<p>Afin de b√©n√©ficier de tous les avantages de <code>git</code>, il n'y a rien de plus simple : il suffit d'ex√©cuter la commande suivante.</p>
<pre><code class="language-bash">sudo apt update
sudo apt install git
</code></pre>
<p><em><strong>Astuce :</strong></em> pour v√©rifier que l'installation d'une application a bien march√©, tu peux appeler la commande <code>which</code> qui te retourne le chemin vers l'ex√©cutable, ou encore l'ex√©cuter avec le flag <code>--version</code> :</p>
<pre><code class="language-bash">$ which git
/usr/bin/git

$ git version
git version 2.11.0
</code></pre>
<h2 id="apprendre-√†-utiliser-cet-outil"><a class="header" href="#apprendre-√†-utiliser-cet-outil">Apprendre √† utiliser cet outil</a></h2>
<h3 id="apprendre-en-ligne-1"><a class="header" href="#apprendre-en-ligne-1">Apprendre en ligne</a></h3>
<p><code>git</code> est un logiciel extr√™mement pratique une fois qu'on l'a pris en main, alors voici ton premier travail √† la maison : <a href="https://learngitbranching.js.org/">apprendre visuellement git</a>. Le tutoriel est multilangue, et si tu pr√©f√®res suivre un tuto en fran√ßais en voici un d'<a href="https://openclassrooms.com/courses/gerez-vos-codes-source-avec-git">OpenClassrooms</a>.</p>
<p>Vu qu'il sait faire de tr√®s nombreuses choses, ce n'est bien s√ªr pas la peine d'apprendre toutes ses commandes par coeur. Voici des <em>Cheat Sheets</em> qui vont te faire gagner du temps :</p>
<ul>
<li><a href="https://services.github.com/on-demand/downloads/github-git-cheat-sheet.pdf">Cheat sheet de GitHub (en)</a></li>
<li><a href="https://services.github.com/on-demand/downloads/fr/github-git-cheat-sheet.pdf">Chear sheet de GitHub (fr)</a></li>
<li><a href="https://www.git-tower.com/blog/git-cheat-sheet/">Cheat sheet de Tower</a></li>
</ul>
<h3 id="ba-ba-des-commandes-1"><a class="header" href="#ba-ba-des-commandes-1">B.A.-BA des commandes</a></h3>
<p>Si tu as besoin d'aide pour utiliser <code>git</code>, les forums de <a href="http://stackoverflow.com/">StackOverflow</a> te permettent de r√©pondre √† tes questions les plus complexes.</p>
<p>Ensuite, voici une <a href="https://git-scm.com/docs">documentation d'API</a> des diff√©rentes fonctions.</p>
<p>En g√©n√©ral cependant, tu vas devoir utiliser le m√™me socle de commandes et le but de ce paragraphe est de te lister le <em><strong>template</strong></em> de commandes √† utiliser ; je t'invite n√©anmoins √† aller lire la documentation de chacune de ces commandes pour voir √† quel point elles peuvent √™tre puissantes.</p>
<ol>
<li>
<p>Avant de commencer √† travailler, il faut r√©cup√©rer le travail r√©aliser par les autres d√©veloppeurs. Si tu as d√©j√† des <code>commit</code>s en local, tu peux sp√©cifier le flag <code>--rebase</code> pour avoir une architecture lin√©aire ; sinon <code>git</code> va <code>merge</code>r la branche locale et celle distante m√™me pour des int√©grations triviales.</p>
<ul>
<li><code>git pull [--rebase]</code></li>
</ul>
</li>
<li>
<p>√Ä pr√©sent, √† toi de faire des modifications pour contribuer au d√©p√¥t. Une fois que tu as fini et que tu veux cr√©er un paquet qui contient ta nouveaut√©, il faut demander √† <code>git</code> de rajouter toutes tes modifications int√©ressantes. Tu peux √©galement conna√Ætre les modfications que tu as faites soit fichier par fichier, soit ligne par ligne. Bien s√ªr, tu peux restreindre la recherche √† un document ou √† des fichiers en particulier en les rajoutant √† la fin.</p>
<ul>
<li><code>git status</code> te liste tous les fichiers qui ont √©t√© modifi√©s / supprim√©s / cr√©√©s</li>
<li><code>git diff</code> te montre toutes les additions et d√©l√©tions dans le code pour l'ensemble de ces fichiers</li>
</ul>
</li>
<li>
<p>Il est temps de choisir les modifications que tu veux sauvegarder dans l'arborescence de <code>git</code>. Il y a plusieurs moyens d'y arriver en utilisant <code>git add</code> et <code>git reset</code> :</p>
<ul>
<li><code>git add *</code> te permets d'ajouter TOUTES les modifications, il ne faut donc pas l'utiliser si tu travailles sur plusieurs projets en m√™me temps</li>
<li><code>git add &lt;file 1&gt; [file 2] [...]</code> ajoute les modifications de chaque fichier / dossier dans leur ensemble. Si tu cr√©es un nouveau fichier, il faut utiliser cette m√©thode pour l'ajouter et non pas la suivante.</li>
<li><code>git add -p</code> permets de mixer <code>add</code> et <code>diff</code> ; il s'agit d'une m√©thode particuli√®rement efficace si tu as besoin de sauvegarder seulement quelques lignes et non pas l'ensemble des modifications sur un fichier. Une interface s'ouvre et tu peux choisir d'accepter avec <code>y</code> ou de refuser les modifications avec <code>n</code> ; d'autres commandes sont possibles notamment <code>q</code> pour quitter.</li>
<li><code>git reset</code> te permets d'annuler l'insertion des modifications dans la sauvegarde de <code>git</code> (mais il ne reset pas les modifications du fichier, rassure-toi). Tu peux √©galement lui donner l'argument <code>-p</code> pour acc√©der √† l'interface int√©ractive.</li>
</ul>
</li>
<li>
<p>Tu peux v√©rifier que tu as ajouter les bonnes modifications en appelant de nouveau</p>
<ul>
<li><code>git status</code> pour voir les fichiers</li>
<li><code>git diff --staged</code> pour voir les modifications dans le code</li>
</ul>
</li>
<li>
<p>Il est enfin temps de cr√©er le 'paquet' de modifications, appel√© <code>commit</code>. Afin de pouvoir s'y retrouver plus facilement, les <code>commit</code>s ont chacun un num√©ro unique (appel√© hash ; il a cette t√™te : <code>44bf09d0a2c36585aed1c34ba2e5d958a9379718</code> et est g√©n√©r√© automatiquement) et √©galement un message que tu dois choisir pour expliquer ce √† quoi il sert. C'est tr√®s int√©ressant de cr√©er un <code>commit</code> par fonctionnalit√©, et donc qui modifie √©ventuellement plusieurs fichiers, afin de pouvoir relire l'historique ensuite. Pense donc √† en r√©aliser plusieurs au cours de ton travail, tu pourras facilement revenir √† des versions pr√©c√©dentes ce qui est tr√®s b√©n√©fique !</p>
<ul>
<li><code>git commit -m &lt;message&gt;</code></li>
<li><code>git commit --amend</code> te permets de juste rajouter des modifications au dernier commit pour ne faire qu'un seul paquet avec les anciennes et nouvelles modifs.</li>
</ul>
</li>
<li>
<p>Maintenant que tu as cr√©√© plusieurs <code>commit</code>s, tu peux v√©rifier que tout s'est bien pass√© en faisant appel √† l'historique. Tu pourras y observer le num√©ro de chaque commit, leur auteur, leur date de cr√©ation ainsi que leur message d'accompagnement.</p>
<ul>
<li><code>git log</code></li>
</ul>
</li>
<li>
<p>Enfin, les modifications que tu viens de faire ont pour but d'√™tre partag√©es aux autres d√©veloppeurs et donc envoy√©s sur le d√©p√¥t distant de <a href="https://github.com/orgs/ClubRobotInsat/">github.com</a>. Normalement, si tu as bien suivi les √©tapes de clonage pr√©sent√©es un peu plus bas, tout devrait √™tre d√©j√† configur√© pour n'avoir qu'√† taper ceci :</p>
<ul>
<li><code>git push -u origin &lt;branch&gt;</code> la premi√®re fois pour demander √† envoyer les <code>commit</code>s sur le flux <code>origin</code>, c'est √† dire github, correspondant √† la branche actuelle (par exemple <code>master</code>)</li>
<li><code>git push</code> les fois suivantes ; tout va marcher ensuite √† condition d'avoir une connexion internet :wink:</li>
</ul>
</li>
</ol>
<p>Je n'ai pas parl√© d'un certain nombre de commandes car tu ne devrais pas les utiliser quotidiennement. Voici une liste de fonctione n√©anmoins int√©ressantes dont tu peux aller voir la documentation :</p>
<ul>
<li><code>git branch</code> - notion que je n'ai que tr√®s peu abord√©e, <code>git</code> travaille avec des branches pour faciliter le travail sur plusieurs projets en parall√®le</li>
<li><code>git checkout</code> - permets de se ballader d'une branche √† une autre branche ou √† un commit en particulier</li>
<li><code>git reset</code> - id√©l pour enlever les modifs d'un <code>git add</code> et pour supprimer des <code>commit</code>s foireux pr√©sents localement</li>
<li><code>git revert</code> - applique les modifications compl√©mentaires √† un commit, id√©al pour annuler un commit foireux d√©j√† envoy√© sur le serveur</li>
<li><code>git merge</code> - permets √† deux branches de fusionner ; fonctionnalit√© sympa pour travailler ind√©pendamment sur un projet puis l'int√©grer dans la branche principale une fois qu'il est fonctionnel</li>
<li><code>git rebase</code> - permets de copier des commits pour avoir une arborescence plus lin√©aire</li>
<li><code>git rebase -i</code> - fen√™tre int√©ractive pour r√©organiser les commits comme tu veux</li>
<li><code>cherry-pick</code> - copie un ensemble de commits √† l'endroit actuel, ce qui simplifie l'utilisation d'un <code>git rebase</code></li>
<li><code>git stash</code> - m√©morise des modifications dans un endroit √† part ; √ßa te permets de sauvegarder un travail qui ne compile pas par exemple. Options int√©ressantes : <code>drop</code>, <code>pop</code>, <code>list</code>, <code>show</code>, <code>save &lt;NAME&gt;</code>, <code>-p</code>.</li>
<li><code>git tag</code> - marque permannante sur un commit pour y acc√©der n'importe quand (√† sa cr√©ation, il faut appeler <code>git push --follow-tags</code> pour le partager avec tout le monde).</li>
<li><code>git fetch</code> - t√©l√©charge les infos sur le d√©p√¥t distant ; contrairement √† <code>git pull</code>, aucun <code>merge</code> n'est r√©alis√© entre le d√©p√¥t localement et celui √† distance, donc cette commande est tr√®s peu utilis√©e</li>
</ul>
<h2 id="cr√©ation-dun-compte-github-1"><a class="header" href="#cr√©ation-dun-compte-github-1">Cr√©ation d'un compte <a href="https://github.com">GitHub</a></a></h2>
<p>Afin de partager notre travail, on utilise les serveurs de GitHub. Il s'agit d'un service web qui offre une interface graphique √† <code>git</code> tout en permettant de r√©cup√©rer les projets du Club n'importe o√π.</p>
<p>Il faut donc que tu te cr√©es un compte sur le site : <a href="https://github.com/">github.com</a>.</p>
<p>Une fois que c'est fait, demande √† un membre du Club de t'ajouter dans l'organisation <a href="https://github.com/orgs/ClubRobotInsat/">ClubRobotINSAT</a>.</p>
<h2 id="configuration-de-git-1"><a class="header" href="#configuration-de-git-1">Configuration de <code>git</code></a></h2>
<p>Il faut configurer ton ordinateur pour qu'il te connaisse, voici comment :</p>
<ol>
<li>Ton nom associ√© aux <code>commit</code>
<ul>
<li><code>git config --global user.name "[ton nom]"</code></li>
</ul>
</li>
<li>Ton adresse mail associ√©e aux <code>commit</code> (de pr√©f√©rence celle utilis√©e lors de la cr√©ation de ton compte GitHub)
<ul>
<li><code>git config --global user.email "[ton adresse mail]"</code></li>
</ul>
</li>
<li>Colorisation des lignes (pas obligatoire mais pratique)
<ul>
<li><code>git config --global color.ui auto</code></li>
</ul>
</li>
</ol>
<h2 id="2-m√©thodes-pour-cloner-les-d√©p√¥ts-1"><a class="header" href="#2-m√©thodes-pour-cloner-les-d√©p√¥ts-1">2 m√©thodes pour <code>clone</code>r les d√©p√¥ts</a></h2>
<h3 id="m√©thode-simple-avec-https"><a class="header" href="#m√©thode-simple-avec-https">M√©thode simple avec HTTPS</a></h3>
<p>Le clonage en HTTPS est le plus simple et le plus couramment utilis√©. Il ne demande que le lien vers le d√©p√¥t pour le cloner, et lorsqu'une authentification est requise (clone d'un d√©p√¥t priv√©, push, ...) il faut entrer son identifiant du serveur git (dans notre cas, <a href="https://github.com">github.com</a>) ainsi que son mot de passe.</p>
<p>Voici comment r√©cup√©rer le code de la partie <code>info</code> :</p>
<pre><code class="language-bash">git clone https://&lt;ton_login_github&gt;@github.com/ClubRobotInsat/info.git
cd info
</code></pre>
<h3 id="m√©thode-alternative-avec-ssh"><a class="header" href="#m√©thode-alternative-avec-ssh">M√©thode alternative avec SSH</a></h3>
<p><a href="https://github.com">github.com</a> propose une autre fonctionnalit√© acc√©der au serveur par <a href="https://fr.wikipedia.org/wiki/Secure_Shell">SSH</a>. La mise en place de cette m√©thode est un peu plus longue que le simple protocole HTTPS, mais √ßa te permettra de t'affranchir de devoir entrer ton mot de passe et ton identifiant √† chaque int√©raction avec le serveur.</p>
<p>Je te laisse suivre les <a href="https://help.github.com/articles/connecting-to-github-with-ssh/">instructions d√©taill√©es</a> pour ajouter la clef SSH sur github.</p>
<p>Enfin, voici comment r√©cup√©rer un d√©p√¥t :</p>
<pre><code class="language-bash">git clone git@github.com:ClubRobotInsat/info.git
cd info
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ide-2"><a class="header" href="#ide-2">IDE</a></h1>
<p><em>Cette page s'adresse √† la fois aux infos et aux √©lecs soft.</em></p>
<p>Comme tu as pu le constater, l'arborescence du code est assez complexe et il y a beaucoup de fichiers. Pour coder facilement, il existe des outils qui nous facilitent la vie : les <a href="https://fr.wikipedia.org/wiki/Environnement_de_d%C3%A9veloppement">environnements de d√©velopement</a>, ou encore des IDE.</p>
<p>Dans ce guide, nous installerons un IDE pour le langage <a href="https://isocpp.org/">C++</a> qui est le langage utilis√© pour la partie informatique du robot. Notre choix se porte sur CLion qui est d√©velopp√© par JetBrains. Il s'agit d'un IDE √† la fois flexible, simple d'utilisation, multiplateforme et qui a la particularit√© d'utiliser nativement <a href="https://cmake.org/">CMake</a>, le syst√®me de build utilis√© par notre code.</p>
<p>Cet IDE est normalement payant, mais une version d'√©ducation (licence valide 1 an, renouvelable tant que l'on est √©tudiant) est disponible.</p>
<h2 id="t√©l√©chargement-de-lide"><a class="header" href="#t√©l√©chargement-de-lide">T√©l√©chargement de l'IDE</a></h2>
<p>Pour commencer, il faut :</p>
<ol>
<li>Se rendre sur la page de <a href="https://www.jetbrains.com/clion/download/">CLion</a> et t√©l√©charger la derni√®re version, ou <a href="https://www.jetbrains.com/toolbox/app/?fromMenu">t√©l√©charger la <strong>Toolbox App</strong></a> si tu veux utiliser des IDEs pour d'autres langages</li>
<li>Pendant le t√©l√©chargement, aller sur la page de <a href="https://www.jetbrains.com/shop/eform/students">jetbrains.com</a> pour demander une licence √©ducation. L'adresse mail √† fournir est celle de l'INSA (<em>&lt;nom&gt;@etud.insa-toulouse.fr</em>) pour que JetBrains accepte de d√©livrer la licence.</li>
<li>Va voir ta bo√Æte mail, un message contenant un lien de confirmation est arriv√© : confirme ton adresse mail</li>
<li>Tu re√ßois enfin un autre mail avec les infos de la licence, qu'il faudra saisir dans CLion</li>
</ol>
<h2 id="lancement"><a class="header" href="#lancement">Lancement</a></h2>
<p>Une fois le t√©l√©chargement termin√©, il ne reste plus qu'√† configurer ton ordinateur pour ex√©cuter l'IDE :</p>
<ol>
<li>Il faut extraire l'archive t√©l√©charg√©e sur le site de CLion et copier le dossier <code>&lt;clion-version&gt;</code> dans <code>/opt/clion</code>:
<pre><code class="language-bash">cd ~/Downloads
tar -xvf &lt;nom de l'archive d'installation&gt;
sudo cp &lt;nom du dossier extrait&gt; /opt/clion -R
</code></pre>
</li>
<li>On renomme le script de lancement <code>clion.sh</code> en <code>clion</code> parce que c'est plus joli (selon mes go√ªts, j'aime aussi le orange si jamais).
<pre><code class="language-bash">sudo mv /opt/clion/bin/clion.sh /opt/clion/bin/clion
</code></pre>
</li>
<li>Il faut maintenant ajouter le script de lancement de Clion √† ta <a href="https://fr.wikipedia.org/wiki/Variable_d%27environnement">variable d'environnement</a> <code>$PATH</code>:
<pre><code class="language-bash">echo "export PATH=/opt/clion/bin:$PATH" &gt;&gt; ~/.bashrc
</code></pre>
Le <code>PATH</code> est une variable d'environnement qui contient une suite de chemins s√©par√©s par des deux points <code>:</code>.
La ligne ci-dessus concat√®ne lors de l'ouverture d'un terminal <strong>bash</strong> √† la variable <code>PATH</code> le chemin de lancement de CLion.</li>
<li>Tu peux maintenant ouvrir un terminal et taper :
<pre><code class="language-bash">clion
</code></pre>
Ou, si jamais tu n'a pas suivi l'√©tape de renommage :
<pre><code class="language-bash">clion.sh
</code></pre>
</li>
</ol>
<p><em><strong>Pour les utilisateurs d'un Ubuntu standard :</strong></em> Lorsque CLion est en cours d'ex√©cution, son ic√¥ne est affich√© dans la barre des t√¢ches √† gauche. Pour le lancer plus rapidement, il te suffit de faire un click droit sur l'ic√¥ne -&gt; 'Lock to Launcher'</p>
<p>Si jamais l'IDE se lance, tu viens d'installer avec succ√®s CLion ! Sinon je t'encourage √† venir montrer le message d'erreur aux gens du club.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="informatique-2"><a class="header" href="#informatique-2">Informatique</a></h1>
<p><img src="pre_2021/info//images/com/raspy.svg" alt="Raspberry PI 3 - Club Robot INSA Toulouse" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mise-en-place-1"><a class="header" href="#mise-en-place-1">Mise en place</a></h1>
<p>Dans cette section, nous allons installer pas √† pas tous les outils pour pouvoir d√©velopper du code dans le p√¥le informatique du Club Robot.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ide-3"><a class="header" href="#ide-3">IDE</a></h1>
<p>Normalement, tu as d√©j√† suivi les instructions de la section <a href="pre_2021/info/mise_en_place//outils_communs/ide.html">Outils Communs - IDE</a>, tu as donc l'IDE CLion d√©j√† fonctionnel.</p>
<p>Si ce n'est pas le cas, reviens un peu en arri√®re et installe CLion !</p>
<h2 id="configuration-sp√©cifiques-au-club-robot"><a class="header" href="#configuration-sp√©cifiques-au-club-robot">Configuration sp√©cifiques au Club Robot</a></h2>
<p>Il ne reste plus qu'une √©tape et la configuration de ton IDE sera finalis√©e pour la partie <code>info</code>.</p>
<p>Dans le menu <code>File -&gt; Settings</code>, d√©rouler l'item <code>Build, Execution, Deployment</code> et s√©lectionner <code>CMake</code>. Il faut ensuite remplir certains champs :</p>
<ul>
<li>dans <code>CMake options</code>, mettre le texte <code>-DDEBUG=on -DBITS=64</code> : on sp√©cifie √† <code>CMake</code> des flags suppl√©mentaires qui sont utilis√©s par le projet</li>
<li>dans <code>Generation path</code>, mettre le texte <code>build</code></li>
<li>dans <code>Build options</code>, mettre le texte <code>-j 4</code> : on compile avec 4 coeurs (ou 8 si ton processeur en a 8)</li>
</ul>
<p>Enfin, pour pouvoir tester les IA via la liaison s√©rie (<a href="https://fr.wikipedia.org/wiki/RS-232">RS232</a>) en utilisant CLion, et sans n√©cessiter les droits <code>root</code>, il faut ajouter ton utilisateur au groupe ayant acc√®s √† la liaison s√©rie <code>dialout</code> :</p>
<pre><code class="language-bash">sudo usermod -a -G dialout &lt;NOM_UTILISATEUR&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="r√©pertoire-de-travail-1"><a class="header" href="#r√©pertoire-de-travail-1">R√©pertoire de travail</a></h1>
<p>On utilise <code>git</code> pour g√©rer plus efficacement le code. Si le nom de ce logiciel ne te dis rien, je te conseille de revenir un peu en arri√®re pour aller lire <a href="pre_2021/info/mise_en_place//outils_communs/git.html">cette page</a>.</p>
<h2 id="clonage-du-d√©p√¥t"><a class="header" href="#clonage-du-d√©p√¥t">Clonage du d√©p√¥t</a></h2>
<p>Si ce n'est pas d√©j√† fait, je te conseille de te cr√©er un dossier sp√©cifique √† tout le Club Robot, par exemple comme ceci :</p>
<pre><code class="language-bash">mkdir -p ~/ClubRobot
cd ~/ClubRobot
</code></pre>
<p>Ensuite, on a besoin de deux dossiers en informatique, un premier qui contient tout le code info et un second qui permets de cr√©er des tables de simulation facilement.</p>
<p>En t'inspirant de ce que tu as appris pour <a href="pre_2021/info/mise_en_place//outils_communs/git.html#a2-m%C3%A9thodes-pour-cloner-les-d%C3%A9p%C3%B4ts">cloner des d√©p√¥ts</a>, je t'invite √† r√©cup√©rer les deux dossiers :</p>
<ul>
<li>
<pre><code class="language-bash">git clone https://github.com/ClubRobotInsat/pytable.git
git clone https://github.com/ClubRobotInsat/info.git
cd info
</code></pre>
</li>
<li>
<pre><code class="language-bash">git clone git@github.com:ClubRobotInsat/pytable.git
git clone git@github.com:ClubRobotInsat/info.git
cd info
</code></pre>
</li>
</ul>
<p>F√©licitations, te voil√† possesseur de tout le savoir informatique du Club !</p>
<h2 id="fonctionnement-des-branches"><a class="header" href="#fonctionnement-des-branches">Fonctionnement des branches</a></h2>
<p>Comme tu peux le voir <a href="https://github.com/ClubRobotInsat/info/branches">sur la page GitHub</a>, on utilise plusieurs <code>branch</code>es en m√™me temps. Cette fonctionnalit√© de <code>git</code> nous permets de travailler en parall√®le sur plusieurs projets.</p>
<p>La branche <code>master</code> est prot√©g√©e : on n'y mets que des versions totalement fonctionnelles <em>(cette branche ne nous sert par beaucoup)</em>.</p>
<p>Tout le code que nous √©crivons passe par la branche <code>develop</code> donc je t'invite d√®s maintenant √† te rendre dessus :</p>
<pre><code class="language-bash">git checkout develop
git pull
</code></pre>
<p>Il s'agit de notre branche principale de d√©veloppement. Afin d'avoir une architecture propre pour s'y retrouver, on utilise des branches pour chaque fonctionnalit√© en cours de d√©veloppement. L'objectif est de partir de <code>develop</code> qui est propre, basculer sur une branche temporaire pour d√©velopper la fonctionnalit√© puis <code>merge</code> ce nouveau code lorsqu'il est fonctionnel dans <code>develop</code>.</p>
<p>Prenons l'exemple d'un d√©veloppement sur le simulateur :</p>
<pre><code class="language-bash">git checkout develop     # On se mets sur la branche m√®re `develop`
git checkout -b dev-simu # Cr√©ation d'une nouvelle branche sp√©cialement pour le simulateur √† partir de `develop`
# MAKE YOUR CODE
git add -p               # Ajout des fonctionnalit√©s
git commit               # Autant de commits que tu veux jusqu'√† ce que √ßa marche
</code></pre>
<p>Une fois que tu es satisfait de ton code, tu as deux possibilit√©s :</p>
<ul>
<li><code>git checkout develop &amp;&amp; git merge dev-simu</code> pour int√©grer directement le code dans la branche principale ; il faut que tu sois sur de toi :wink:</li>
<li>Depuis <a href="https://github.com/clubrobotinsat/info/pulls">la page <strong>Pull requests</strong></a>, cr√©e une nouvelle requ√™te pour <code>merge</code> ta nouvelle branche <code>dev-simu</code> dans <code>develop</code>. √áa permets d'avoir une <em>review</em> d'autres personnes sur ton travail, ce qui ne fait jamais de mal. Le retour des autres membres te permets de perfectionner ton code, te faire penser √† certaines choses qui n'apparaissent pas dans les tests unitaires par exemple ou encode de valider ton travail pour l'int√©grer dans le code. Bien √©videmment, cette mani√®re de faire est tr√®s fortement recommand√©e !</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compilation"><a class="header" href="#compilation">Compilation</a></h1>
<p>Dans cette section, nous allons t'installer tous les outils qui te permettront de compiler le projet informatique.</p>
<h2 id="logiciels-n√©cessaires"><a class="header" href="#logiciels-n√©cessaires">Logiciels n√©cessaires</a></h2>
<p>On utilise les outils suivants :</p>
<ul>
<li><code>git</code> : gestionnaire de versions pour le code, que tu as d√©j√† d√ª installer</li>
<li><code>cmake</code> : gr√¢ce aux diff√©rents <code>CMakeLists.txt</code>, le projet se compile tr√®s facilement en invoquant <code>cmake</code> puis <code>make</code> (nous verrons plus tard comment utiliser cet outil)</li>
<li><code>clang-format</code> : cet utilitaire permets d'homog√©niser tout le code pour qu'il respecte la m√™me norme d'√©criture</li>
<li><code>libbox2d-dev</code>, <code>libirrlicht1.8</code> : ces librairies permettent d'utiliser le simulateur du club</li>
</ul>
<p>Heureusement, un script s'occupe d'installer tous ces outils et d'autres encore pour assurer la compilation sans erreur du projet. Voici comment l'appeler (en consid√©rant que vous √™tes dans le dossier <code>info</code>):</p>
<pre><code class="language-bash">scripts/install.sh tools
</code></pre>
<h2 id="applications-recommand√©es"><a class="header" href="#applications-recommand√©es">Applications recommand√©es</a></h2>
<h3 id="formattage-du-code"><a class="header" href="#formattage-du-code">Formattage du code</a></h3>
<p>Un <em>hook</em> permets de lancer un script √† chaque commit pour formater le code comme il faut :</p>
<pre><code class="language-bash">scripts/install.sh format
</code></pre>
<h3 id="gcc-recent-en-tant-que-compilateur"><a class="header" href="#gcc-recent-en-tant-que-compilateur"><em>gcc</em> recent en tant que compilateur</a></h3>
<p>Cette section ne s'applique que si tu as eu un probl√®me lors de l'ex√©cution du script d'installation, pour <code>gcc-7</code> et <code>g++-7</code>.</p>
<p>Pour pouvoir compiler l'ensemble du code, il te faut un compilateur supportant <code>C++ 17</code>, donc au minimum <code>g++-7</code>.</p>
<h4 id="version-7"><a class="header" href="#version-7">version 7</a></h4>
<p>Si tu es sur un ancien Ubuntu (avant 17.04) :</p>
<pre><code class="language-bash">sudo add-apt-repository ppa:ubuntu-toolchain-r/test
</code></pre>
<p>Sinon :</p>
<pre><code class="language-bash">sudo add-apt-repository ppa:jonathonf/gcc-7.1
</code></pre>
<p>Puis :</p>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install gcc-7 g++-7
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-7 70 --slave /usr/bin/g++ g++ /usr/bin/g++-7
</code></pre>
<p>Si tu es sur Ubuntu 18, tu peux m√™me installer <code>g++-8</code> :</p>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install gcc-8 g++-8
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-8 80 --slave /usr/bin/g++ g++ /usr/bin/g++-8
</code></pre>
<h4 id="cross-compilation"><a class="header" href="#cross-compilation">Cross-compilation</a></h4>
<p>Pour pouvoir compiler du code qui sera compris par la raspberry (et pas que par ton ordinateur), tu vas avoir besoin d'autres versions de gcc. Pour les installer, tape simplement :
<code>sudo apt install g++-8-arm-linux-gnueabihf gcc-8-arm-linux-gnueabihf</code></p>
<h2 id="autres-installations"><a class="header" href="#autres-installations">Autres installations</a></h2>
<h3 id="lib-wiimote"><a class="header" href="#lib-wiimote">Lib Wiimote</a></h3>
<p>Si tu veux pouvoir contr√¥ler le robot √† l'aide d'une WiiMote, il faut installer la librairie <code>WiiC</code> n√©cessaire aux d√©mos :</p>
<pre><code class="language-bash">scripts/install.sh wii
</code></pre>
<h3 id="clang-en-tant-que-compilateur"><a class="header" href="#clang-en-tant-que-compilateur"><em>Clang</em> en tant que compilateur</a></h3>
<p>Si tu veux utiliser un autre compilateur par d√©faut (<a href="https://clang.llvm.org/"><code>clang</code></a>), voici les commandes √† utiliser :</p>
<pre><code class="language-bash">sudo apt-get install clang-3.8
sudo update-alternatives --install /usr/bin/c++ c++ /usr/bin/clang++-3.8 100
</code></pre>
<p>Cependant, tous les membres actuels utilisent <code>gcc</code> par d√©faut.</p>
<h3 id="petrilab"><a class="header" href="#petrilab">Petrilab</a></h3>
<p>Ce logiciel permets d'√©diter des <a href="https://fr.wikipedia.org/wiki/R%C3%A9seau_de_Petri">r√©seaux de Petri</a>. Il a √©t√© d√©velopp√© en interne par <a href="https://github.com/rems4e">rems4e</a> et il nous permets de cr√©er graphiquement des strat√©gies.</p>
<p>Son installation actuelle est vou√©e √† √©voluer prochainement pour le plus avoir les fichiers binaires directement dans le d√©p√¥t git, et les syst√®mes d'exploitation pris en charge pour le moment sont les suivants :</p>
<ul>
<li>Ubuntu 14.04 <code>Trusty</code></li>
<li>Ubuntu 17.04 <code>Zesty</code></li>
<li>Ubuntu 18.04 <code>Bionic</code></li>
</ul>
<p>Pour avoir des informations sur ton OS, utilise la commande <code>lsb_release --all</code> ; s'il correspond √† ceux disponibles, alors tu peux simplement appeler le script d'installation :</p>
<pre><code class="language-bash">scripts/install.sh petri
</code></pre>
<h2 id="probl√®mes-de-compilation-connus"><a class="header" href="#probl√®mes-de-compilation-connus">Probl√®mes de compilation connus</a></h2>
<ul>
<li>Probl√®me de <em>clock skew</em> ? Il suffit de lancer <code>find -exec touch \{\} \;</code> dans le dossier <code>info</code>. Attention, cela peut √™tre un petit peu long.</li>
<li>Probl√®me lors d'un appel √† <code>cmake</code> ? Commence par <em>clean</em> tous les fichiers g√©n√©r√©s : <code>Tools &gt; CMake &gt; Reset Cache and Reload Project</code>.</li>
</ul>
<h2 id="test-de-lenvironnement-de-travail"><a class="header" href="#test-de-lenvironnement-de-travail">Test de l'environnement de travail</a></h2>
<p>A pr√©sent que ton ordinateur est totalement configur√©, il est temps de compiler le code !</p>
<p>L'interface de CLion peut para√Ætre compliqu√©e de prime abord, c'est pourquoi il ne faut pas h√©siter √† demander de l'aide √† un membre du Club.</p>
<p>Une des fonctionnalit√©s les plus utilis√©es est celle de la compilation int√©gr√©e. Pour cela, en haut √† droite de la fen√™tre, choisis la target <code>BuildAll</code>. Comme tu peux le voir, de nombreuses applications peuvent √™tre compil√©es, et on veut actuellement s'assurer que tout compile chez toi. Ensuite, appuie sur le bouton √† gauche de la liste d√©roulante pour compiler. Attention, √ßa va prendre un peu de temps.</p>
<p><img src="pre_2021/info/mise_en_place//images/ide/BuildAll.png" alt="CLion et sa fonctionnalit√© BuildAll" /></p>
<p>Si il n'y a pas de messages d'erreur, <em><strong>BRAVO</strong></em> tu viens d'installer avec succ√®s tout l'environnement de travail !</p>
<p>Sinon, je te conseille de te rapprocher d'un membre du p√¥le informatique.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="outils-informatiques"><a class="header" href="#outils-informatiques">Outils informatiques</a></h1>
<p>Si ce n'est pas d√©j√† fait, je te conseille dans un premier temps d'installer <code>git</code> et <code>CLion</code> en allant  dans la section des <a href="pre_2021/info/outils//outils_communs/index.html">outils communs</a>.</p>
<p>Le code informatique a une certaine taille (700 fichiers pour 200.000 lignes de code) et l'ensemble des fichiers sont r√©partis dans une arborescence relativement dense.</p>
<p>De plus, n'oublie pas cette devise :</p>
<blockquote>
<p>Un bon informaticien est un informaticien f√©n√©ant.</p>
</blockquote>
<p>Ainsi, on proscrit au maximum les copi√©s/coll√©s donc certaines parties de code sont empaquet√©s dans des <code>librairies</code> et sont r√©utilis√©es dans de tr√®s nombreux endroits du projet.</p>
<p>Enfin, il faut toujours se rappeler qu'un ordinateur est b√™te et qu'il n'ex√©cute que ce qu'on lui dit de faire, donc pour compiler ton Intelligence Artificielle r√©volutionnaire qui va nous envoyer directement en finale, il ne suffit pas d'appeler le compilateur avec <code>g++ IA.cpp</code> mais il faut donner les liens vers les librairies qui s'occupent des cartes √©lectroniques, celles vers les outils math√©matiques, sp√©cifier quels r√©pertoires sont utilis√©s pour compiler, √©ventuellement cr√©er les librairies dynamiques associ√©es et bien d'autres choses encore.</p>
<p>Afin d'√©viter de t'infliger de telles soufrances, on utilise un utilitaire qui permets de g√©rer efficacement un tel projet gr√¢ce √† <code>cmake</code>. On va ensuite d√©tailler les librairies d√©velopp√©es en interne au club pour faciliter la programmation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cmake"><a class="header" href="#cmake">CMake</a></h1>
<p><code>cmake</code> est un utilitaire open-source et multi-plateformes qui permet ind√©pendemment du compilateur de g√©n√©rer des fichiers utilisables pour la compilation. De plus, l'IDE <a href="https://www.jetbrains.com/clion/">CLion</a> utilise nativement <code>cmake</code>, ce qui veut dire qu'il va te faire gagner √©norm√©ment de temps √† chaque fois que tu travailleras avec un projet configur√© avec <code>cmake</code>.</p>
<p>Son installation est tr√®s simple, il te suffit d'ex√©cuter</p>
<pre><code class="language-bash">sudo apt-get install cmake
</code></pre>
<h2 id="explications-du-fonctionnement"><a class="header" href="#explications-du-fonctionnement">Explications du fonctionnement</a></h2>
<p><code>cmake</code> est √† utiliser avec le programme <code>make</code> (tu n'as pas √† l'installer en plus, il est d√©j√† pr√©sent sur ton ordinateur).</p>
<p>√Ä l'origine, les projets en <code>C</code> √©taient compil√©s avec <code>make</code> gr√¢ce √† des fichiers de configuration, des <code>Makefile</code>. Pour te donner une id√©e de ce √† quoi ils ressemblent, voici un exemple (qui n'a rien √† voir avec le Club Robot) :</p>
<pre><code class="language-make">CC        := gcc
LD        := gcc

vpath %.c $(SRC_DIR)

define make-goal
$1/%.o: %.c
	$(CC) -std=gnu99 -Wall -m32 -g -I $(INCLUDES) -c $$&lt; -o $$@
endef

.PHONY: all checkdirs clean

all: checkdirs build/client

build/client: $(OBJ_CLI)
	$(LD) -m32 $^ -o $@ -lm -lpthread -g

checkdirs: $(BUILD_DIR)

$(BUILD_DIR):
	@mkdir -p $@

clean:
	@rm -rf $(BUILD_DIR)

distclean:
	@rm -rf $(BUILD_DIR)
	@-rm -f *.tar.gz || true

$(foreach bdir,$(BUILD_DIR),$(eval $(call make-goal,$(bdir))))
</code></pre>
<p>Si tu es en train de te dire que c'est illisible, c'est normal et tu n'as pas √† apprendre cette syntaxe rassure-toi.</p>
<p>En effet, l'objectif de <code>cmake</code> et de rajouter une surcouche √† l'√©tape de compilation en permettant au programmeur d'√©crire dans un anglais plus lisible (c'est √† dire qu'il rajoute un couche d'abstraction).</p>
<p>Ainsi, tu vas travailler avec des fichiers de configuration nomm√©s <code>CMakeLists.txt</code>. Voici un petit exemple du fichier qui g√®re tout le code du robot principal :</p>
<pre><code class="language-cmake">set(ROBOT_PRINC_SOURCE
        ../Commun/Strategie.cpp
        librobot/Robot.cpp
        librobot/MecaManager.cpp
        librobot/Strategie.cpp
        #librobot/Ascenseur.cpp
        petri/Deplacement.cpp
        petri/Servo.cpp
        petri/Moteur.cpp
        petri/Utils.cpp
        petri/PetriCommon.cpp
        librobot/StrategyGenerator/MagicStrategy.cpp)

add_library(robotPrincipal STATIC ${ROBOT_PRINC_SOURCE})
add_library(robotPrincipalInterfaceElec STATIC ${ROBOT_PRINC_SOURCE})

target_link_libraries(robotPrincipal Cartes Robot Strategie)
target_link_libraries(robotPrincipalInterfaceElec Robot_Interfacer_Elec Cartes Strategie)

add_executable(debug_calibration_depla debug/CalibrationDepla.cpp)
target_compile_options(debug_calibration_depla PUBLIC -Wno-deprecated)
target_link_libraries(debug_calibration_depla robotPrincipal)

include_directories(/usr/local/include/wiic/)

set(wiimote_sources IA/IAWiimote.cpp wiimote/Wiimote.cpp)
add_executable(IAWiimote ${wiimote_sources})
include_directories(/usr/local/include/wiic/)

add_executable(IAPrincipal IA/IAPrincipal.cpp)

if (RASPI)
	message(STATUS "Compiling IAPrincipal for the raspi")
	link_directories(/usr/arm-linux-gnueabihf/lib)
	target_link_libraries(IAPrincipal robotPrincipal PetriRuntime dl)

else()
	target_link_libraries(IAWiimote robotPrincipal wiicpp)
	target_link_libraries(IAPrincipal robotPrincipal)
endif()


add_executable(IATestDeplacement IA/IATestDeplacement.cpp)
target_link_libraries(IATestDeplacement robotPrincipal)

add_executable(IATestMeca IA/IATestMeca.cpp)
target_link_libraries(IATestMeca robotPrincipal)
</code></pre>
<p>Ensuite, une fois ces fichiers bien configur√©s, il te suffit d'aller dans la racine du dossier et de taper les commandes suivantes :</p>
<pre><code class="language-bash">mkdir -p build
cd build
cmake ..
make all
</code></pre>
<p>Tout est automatis√© ; dans un premier temps les <code>Makefile</code>s vont √™tre g√©n√©r√©s puis la commande <code>make</code> va lire ces fichiers pour les compiler gr√¢ce √† <code>g++</code>. √Ä la fin du processus (la compilation peut prendre jusqu'√† une dizaine de minutes en tout), tu auras les fichiers binaires dans le dossier <code>/info/build</code> pr√™ts √† √™tre ex√©cut√©s.</p>
<h2 id="cheatsheet"><a class="header" href="#cheatsheet">Cheatsheet</a></h2>
<p>Ce paragraphe n'a bien s√ªr pas pour but d'√™tre exhaustif, si tu as besoin de trouver des commandes sp√©cifiques je te conseille d'aller voir <a href="https://gitlab.kitware.com/cmake/community/wikis/home">vers le wiki</a>.</p>
<h3 id="cmakeliststxt-principal"><a class="header" href="#cmakeliststxt-principal"><code>CMakeLists.txt</code> principal</a></h3>
<p>Pour une meilleure lisibilit√©, les configurations sont r√©parties dans chaque dossier. Il y a un <code>CMakeLists.txt</code> principal qui fait des configurations globales, et qui appelle ensuite les <code>CMakeLists</code> des sous-dossiers pour compartimenter le simulateur du robot par exemple.</p>
<ul>
<li><code>cmaks_minimum_required(VERSION 3.0)</code> - certaines fonctionnalit√©s de <code>cmake</code> sont apparues dans les versions les plus r√©centes donc il faut toujours sp√©cifier ce flag</li>
<li><code>project(root)</code> - d√©finission du nom global du projet</li>
<li><code>option(&lt;NAME&gt; "&lt;comments&gt;" [DEFAULT])</code> - permets de donner des options pendant le lancement de <code>cmake</code>. Par exemple, avec l'<code>option(BITS "Build en 32 ou 64 bits" 64)</code>, on peut forcer la compilation en 32 bits avec l'appel <code>cmake .. -DBITS=32</code></li>
<li><code>add_definitions(&lt;DEFINITION&gt;)</code> - sp√©cifie des d√©finitions pour la compilation</li>
<li><code>add_subdirectory(&lt;PATH&gt;)</code> - appelle le <code>CMakeLists</code> d'un dossier enfant, par exemple celui du simulateur</li>
<li><code>link_directories(/usr/local/lib/)</code> - permets d'utiliser des librairies d√©j√† existantes (par exemple, celle de <a href="http://box2d.org/">box2d</a> pour la gestion du moteur physique)</li>
</ul>
<h3 id="commandes-les-plus-utilis√©es"><a class="header" href="#commandes-les-plus-utilis√©es">Commandes les plus utilis√©es</a></h3>
<ul>
<li><strong>conditions</strong> :
<pre><code>   if(COLOR)
      set(CMAKE_COLOR_MAKEFILE ON)
   else()
      set(CMAKE_COLOR_MAKEFILE OFF)
   endif()
</code></pre>
Tests d'√©galit√© : <code>${BITS} EQUAL 32</code>, <code>${CMAKE_CXX_COMPILER_ID} STREQUAL "^(Apple)?Clang$"</code></li>
<li><strong>cr√©er des variables</strong> : <strong><code>set(&lt;NAME&gt; &lt;VALUE)</code></strong> ; exemple : <code>set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++14")</code> ; <code>set(FILES_SOURCE src/file1.cpp src/file2.cpp)</code></li>
<li><strong>librairies</strong>
<ul>
<li>Cr√©er une librairie : <code>add_library(&lt;NAME&gt; STATIC ${FILES_SOURCE})</code></li>
<li>Lier une cible vers une librairie : <code>target_link_libraries(&lt;TARGET&gt; &lt;Lib1&gt; [Lib2] [...])</code></li>
<li>R√©cup√©rer les fichiers d'une librairie externe : <code>find_package(&lt;NAME&gt;)</code> (<a href="https://cmake.org/cmake/help/v3.0/command/find_package.html">wiki</a>)</li>
</ul>
</li>
<li>cr√©er un nouvel ex√©cutable : <code>add_executable(&lt;NAME&gt; &lt;file1&gt; [file2] [...])</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="petrilab-1"><a class="header" href="#petrilab-1">PetriLab</a></h1>
<p>Cette application a √©t√© cr√©√©e en interne au Club Robot par <a href="https://github.com/rems4e">R√©mi SAUREL</a>.</p>
<p>Au lieu d'√©crire les IAs (Intelligences Artificielles) directement en ligne de code, ce qui peut rapidement √™tre indigeste et surtout tr√®s peu maintenable pendant la coupe, le logiciel permets d'utiliser une interface graphique pour g√©rer toute la strat√©gie.</p>
<p>Ses avantages sont multiples :</p>
<ul>
<li>sans aucune notion en informatique, le logiciel est accessible √† Monsieur Toulemonde</li>
<li>il g√®re la parall√©lisation des t√¢ches (avancer en ouvrant des pinces tout en allumant des moteurs et en affichant du texte √† l'√©cran), ce qui demanderait beaucoup de travail en lignes de code</li>
<li>on peut contr√¥ler le robot depuis un mode <code>debug</code>, et donc construire la strat√©gie en live</li>
</ul>
<p>Le logiciel offre de nombreuses fonctionnalit√©s, et cette page a pour but de t'expliquer comment l'utiliser.</p>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>Ce logiciel n'est pas en open-source et son installation n'est accessible qu'aux membres du Club Robot actuellement. De plus, il faut que tu aies Ubuntu 14.04, 17.04 ou 18.04.</p>
<p>Pour ce faire, apr√®s avoir <a href="pre_2021/info/outils//info/mise_en_place/repertoire_de_travail.html#clonage-du-d%C3%A9p%C3%B4t">cloner le d√©p√¥t info</a>, je t'invite √† √©crire cette ligne de commande :</p>
<pre><code class="language-bash">cd &lt;dossier info&gt;
scripts/install.sh petri
</code></pre>
<p>Le script d'installation va te demander un mot de passe ; √† ce moment, demande √† un membre du Club pour finaliser ton installation.</p>
<h2 id="prise-en-main-du-logiciel"><a class="header" href="#prise-en-main-du-logiciel">Prise en main du logiciel</a></h2>
<p><em><strong>TODO</strong></em></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="explications"><a class="header" href="#explications">Explications</a></h1>
<p>La lecture de ce dossier va te permettre d'avoir un avant go√ªt de l'architecture du code informatique. Je vais essayer de te donner les clefs pour comprendre comment te ballader dans l'arborescence et j'en profiterais pour entrer dans des d√©tails plus techniques.</p>
<p>Bien entendu, ce tutoriel ne peut pas √™tre exhaustif donc je te conseille d'aller voir le code directement et de lancer quelques ex√©cutables pour comprendre leur fonctionnement, en utilisant les clefs de lecture que je vais te donner ici.</p>
<p>Bonne lecture !</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="architecture-de-la-racine-du-projet-info"><a class="header" href="#architecture-de-la-racine-du-projet-info">Architecture de la racine du projet info</a></h1>
<p>Si tu as d√©j√† regard√© des projets C++, tu as certainement d√ª te rendre compte d'une certaine similaritude entre les dossiers tout en haut de l'architecture.
Cette 'normalisation' permets de passer d'un projet √† un autre sans √™tre perdu, et bien s√ªr une architecture bien structur√©e permets de gagner beaucoup de temps.</p>
<p>Je te propose un listing des items qui valent un coup d'oeil. Pour rappel, tu peux regarder le code durant ta lecture sur <a href="https://github.com/ClubRobotInsat/info">github</a> et tu peux cliquer sur les liens de chaque fichier.</p>
<h2 id="fonctionnement-de-git"><a class="header" href="#fonctionnement-de-git">Fonctionnement de <code>git</code></a></h2>
<p>Afin de proposer tous ses services, <code>git</code> a besoin d'un certain nombre de fichiers de configuration. Voici ses principaux ainsi que leur r√¥le :</p>
<ul>
<li>
<p><strong><code>.git/</code></strong> - Ce dossier contient toutes les informations utiles √† <code>git</code> pour g√©rer le r√©pertoire de travail. Je te conseille grandement de voir ce dossier comme une bo√Æte noire et de ne pas y bidouiller des fichiers au risque de tout casser !</p>
</li>
<li>
<p><strong><a href="https://github.com/ClubRobotInsat/info/blob/develop/.gitignore"><code>.gitignore</code></a></strong> - Cette fonctionnalit√© de <code>git</code> est tr√®s int√©ressante : elle permets de demander au logiciel d'ignorer les fichiers sp√©cifi√©s. Par exemple, on demande √† <code>git</code> de ne pas <code>commit</code> les ex√©cutables √† chaque fois car √ßa n'a aucun int√©r√™t et √ßa prendrait bien trop de place.</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/blob/develop/.gitmodules"><code>.gitmodules</code></a> - On travaille avec d'autres projets open source et <code>git</code> propose des sous-modules qui correspondent √† des dossiers dont l'origine vient d'un autre projet. On peut donc utiliser des librairies d√©velopp√©es par d'autres personnes sans devoir passer du temps nous-m√™mes √† les cr√©er. Attention cependant, si tu veux rajouter un sous-module au projet, il vaut mieux utiliser la commande <code>git submodule add &lt;lien&gt; [chemin local]</code> pour √™tre s√ªr de bien tout configurer, puis il faut faire appel √† <code>git submodule update --init --recursive --remote</code> pour mettre √† jour tous les submodules (mais cette commande est automatis√©e √† chaque appel √† <code>cmake</code>).</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/blob/develop/.gitattributes"><code>.gitattributes</code></a> - On demande explicitement √† <code>git</code> de consid√©rer certains fichiers d'une certaine mani√®re, par exemple tous les <code>.petri</code> comme des fichiers binaires (dans notre cas, √ßa √©vite de polluer l'affichage des commits sur github).</p>
</li>
</ul>
<h2 id="fichiers"><a class="header" href="#fichiers">Fichiers</a></h2>
<ul>
<li>
<p><strong><a href="https://github.com/ClubRobotInsat/info/blob/develop/LICENSE"><code>LICENSE</code></a></strong> - Ce fichier permets de sp√©cifier la license utilis√©e pour la mise en open source du code ; on utilise la <a href="https://opensource.org/licenses/MIT">license MIT</a> et je t'invite √† te renseigner sur les <a href="https://opensource.org/licenses">licenses d'open source</a> si le domaine de l'open source t'int√©resse.</p>
</li>
<li>
<p><strong><a href="https://github.com/ClubRobotInsat/info/blob/develop/README.md"><code>README.md</code></a></strong> - Ce fichier est pr√©sent dans tous les r√©pertoires h√©berg√©s sur <a href="https://github.com">github.com</a>. Il permets de savoir ce qu'il y a dans le d√©p√¥t, donner des explications sur le code, faire de la documentation ou encore donner des r√©f√©rences vers d'autres projets ; la r√©daction de ce fichier est tr√®s libre.</p>
</li>
<li>
<p><strong><a href="https://github.com/ClubRobotInsat/info/blob/develop/CMakeLists.txt"><code>CMakeLists.txt</code></a></strong> - Il s'agit du fichier de configuration de <a href="https://cmake.org/">cmake</a> global √† tout le projet. Si ce n'est d√©j√† fait, je t'invite √† aller lire <a href="pre_2021/info/explications/info/outils/cmake.html">la documentation sur CMake</a> pour avoir une id√©e de ce que fait le logiciel.</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/blob/develop/.clang-format"><code>.clang-format</code></a> - Tu ne vas pas forc√©ment trouver ce fichier dans tous les projets, mais il est tr√®s pratique et permets d'appliquer des r√®gles d'indentation √† chaque <code>commit</code> pour s'assurer une homog√©nisation du code entre les d√©veloppeurs.</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/blob/develop/doxyconfig"><code>doxyconfig</code></a> - <a href="https://www.stack.nl/~dimitri/doxygen/">Doxygen</a> est un utilitaire qui permets de cr√©er de la documentation √† partir du code en utilisant ce fichier de configuration. Malheureusement, la documentation actuelle ne permets pas d'utiliser cet outil et un gros travail est √† r√©aliser pour avoir une documentation fiable.</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/blob/develop/TODO.txt"><code>TODO.txt</code></a> - Comme son nom l'indique, ce fichier permets de recenser les projets sur lesquels travailler pour l'ann√©e en cours.</p>
</li>
</ul>
<h2 id="dossiers"><a class="header" href="#dossiers">Dossiers</a></h2>
<ul>
<li>
<p><strong><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/"><code>src/</code></a></strong> - Ce dossier regroupe tout le code source du projet informatique.</p>
</li>
<li>
<p><strong><code>build/</code></strong>, <code>build_arm/</code> - Ces dossiers sont le r√©sultat de la (cross-)compilation du code et ils contiennent les ex√©cutables. Bien entendu, ils ne sont pr√©sents que localement et <code>git</code> les ignore lors du processus de cr√©ation des <code>commit</code>s.</p>
</li>
<li>
<p><strong><a href="https://github.com/ClubRobotInsat/info/tree/develop/third_parties/"><code>third_parties/</code></a></strong> - Sous-modules (librairies) utilis√©s par le projet sous la forme de clones. Tout est automatis√© d√®s lors que tu ex√©cutes <code>cmake ..</code> depuis un dossier <code>build</code>.</p>
</li>
<li>
<p><strong><a href="https://github.com/ClubRobotInsat/info/tree/develop/doc/"><code>doc/</code></a></strong> - Dossier qui reprends les documentation jusqu'√† pr√©sent du projet. Ce dossier a pour vocation de dispara√Ætre pour laisser la place √† la documentation que tu lis actuellement.</p>
</li>
<li>
<p><strong><a href="https://github.com/ClubRobotInsat/info/tree/develop/scripts/"><code>scripts/</code></a></strong> - Ce dossier est tr√®s int√©ressant dans le sens o√π il propose de nombreux scripts qui vont te faciliter la vie. Si tu veux des exemples concrets de l'utilisation des commandes <a href="https://www.gnu.org/software/bash/">bash</a> va vite lire ces scripts !</p>
<ul>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/tree/develop/scripts/build_arm.sh"><code>build_arm.sh</code></a> : Cross-compilation de <code>[all|principal|wii|test]</code> pour une archi ARM (la cible √† compiler est √† donner en param√®tre).</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/tree/develop/scripts/install.sh"><code>install.sh</code></a> : Utilitaire pour t'aider √† configurer ton ordinateur. Il est capable d'installer <code>[all|tools|petri|format|wii|raspi]</code> (param√®tre √† donner en argument) ; tu as d√©j√† utilis√© ce script pour la mise en place du d√©p√¥t normalement.</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/tree/develop/scripts/pre-commit"><code>pre-commit</code></a> : script copi√© et automatiquement appel√© √† chaque commit d√®s lors que tu lances <code>scripts/install.sh format</code>, pour bien indenter ton code</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/tree/develop/scripts/send_file_to_rpi.sh"><code>send_file_to_rpi.sh</code></a> : se connecte au raspi et y envoie le fichier souhait√©</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/tree/develop/scripts/send_ia_principale.sh"><code>send_ia_principale.sh</code></a> : cross-compile la target principale et envoi l'ex√©cutable gr√¢ce au script pr√©c√©dent (script magique qui te mets bien 5 minutes avant un match !)</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/tree/develop/scripts/ssh_into_rpi.sh"><code>ssh_into_rpi.sh</code></a> : se connecte au raspi en SSH ; il faut pr√©alablement configurer la connexion et brancher un c√¢ble RJ45 pour que √ßa marche</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/tree/develop/scripts/simu_launcher.sh"><code>simu_launcher.sh</code></a> : Utilitaire pour ex√©cuter automatiquement le simulateur</p>
</li>
</ul>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/tree/develop/precompiled-libraries/"><code>precompiled-libraries/</code></a> - On utilise des librairies, notamment pour l'utilisation de la wii-mote. Pour plus de simplicit√©, on a cross-compil√© ces librairies une fois pour toutes et on les stock ici afin de compiler plus facilement pour l'architecture ARM.</p>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/tree/develop/cmake_modules"><code>cmake_modules/</code></a> - R√©pertorie des fonctions <code>cmake</code> pour aller chercher facilement des librairies sur ton ordinateur (les scripts restent tr√®s peu lisibles mais ils sont fonctionnels).</p>
</li>
</ul>
<h2 id="conclusion-3"><a class="header" href="#conclusion-3">Conclusion</a></h2>
<p>J'esp√®re que cette √©num√©ration te permets d'y voir un peu plus clair et que √ßa ne te donne pas envie d'oublier √† jamais l'architecture info !</p>
<p>Les parties suivantes vont entrer dans les d√©tails de ce qu'il y a dans le dossier <a href="https://github.com/ClubRobotInsat/info/tree/develop/src/"><code>src/</code></a>, n'h√©site pas √† demander √† un informaticien du club plus d'explications sur tout ce qu'il y a en 'annexe' du code source.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vue-globale-du-projet"><a class="header" href="#vue-globale-du-projet">Vue globale du projet</a></h1>
<p>En √©tant √† la racine du dossier, je t'invite √† ex√©cuter ces deux commandes :</p>
<pre><code class="language-bash">$ find src -type f | wc -l
678

$ find src -type f | xargs wc -l
186823 total
</code></pre>
<p>Il y a actuellement 678 fichiers source pour presque 200.000 lignes de code ; je te l'accorde c'est beaucoup.</p>
<p>Bien s√ªr, tous ces fichiers sont structur√©s et ce petit sch√©ma peut te donner une id√©e des merveilles que tu peux trouver dans le dossier <code>src/</code> :</p>
<p><img src="pre_2021/info/explications/../../images/info/arborescence.png" alt="Arborescence du projet de mani√®re graphique" /></p>
<p>Bien entendu, ce fichier est √† mettre √† jour en fonction des nouvelles fonctionnalit√©s apport√©es, et si tu veux y participer il faut utiliser le logiciel <a href="https://wiki.gnome.org/Apps/Dia/">dia</a>.</p>
<pre><code>sudo apt-get install dia
</code></pre>
<p>Comme tu peux t'en apercevoir, il y a trois parties principales :</p>
<ul>
<li><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/commun/"><code>commun</code></a> - Tu peux y retrouver plein d'outils qui facilitent la programmation (manipulation d'unit√©s physiques, constantes, manipulation de la communication, ...). Ce dossier est hyper important, mais je te conseille dans un premier temps d'utiliser les outils pour travailler sur le reste avant de te plonger dans ces librairies (certaines notions sont un peu compliqu√©es et tout ce code n'est pas forc√©ment directement li√© √† la robotique).</li>
<li><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/simulateur/"><code>simulateur/</code></a> - Ce dossier regroupe l'ensemble des fichiers n√©cessaires pour mettre au point un simulateur graphique qui nous permet de tester la strat√©gie du robot avant de l'avoir en vrai, m√©caniquement parlant. Si tu veux en savoir plus sur l'architecture du simulateur, elle est d√©taill√©e <a href="pre_2021/info/explications/simu.html">ici</a>.</li>
<li><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/"><code>robot/</code></a> - Il y a toute la strat√©gie, les interfaces de manipulation des actionneurs, ... C'est dans ce dossier que la majorit√© du code est √©crit, et c'est bien s√ªr la partie la plus ancr√©e avec les autres p√¥les.</li>
</ul>
<h2 id="pr√©sentation-des-abstraction-informatiques-autour-du-robot"><a class="header" href="#pr√©sentation-des-abstraction-informatiques-autour-du-robot">Pr√©sentation des abstraction informatiques autour du robot</a></h2>
<p>En informatique, il y a de nombreuses couches d'abstraction qui s√©parent les cartes √©lectroniques de l'IA du match. Je te propose un petit aper√ßu de ces couches, des explications suppl√©mentaires et sp√©cifiques √† chaque couche te seront apport√©es en suivant.</p>
<p><em><strong>CE TABLEAU DOIT √äTRE MIS √Ä JOUR</strong></em></p>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;border-color:#999;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#999;color:#444;background-color:#F7FDFA;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#999;color:#fff;background-color:#26ADE4;}
.tg .tg-uys7{border-color:inherit;text-align:center}
.tg .tg-us36{border-color:inherit;vertical-align:top}
.tg .tg-xrpy{font-weight:bold;font-size:18px;border-color:inherit;text-align:center}
</style>
<table class="tg">
  <tr>
    <th class="tg-xrpy" colspan="5">Couches d'abstraction</th>
    <th class="tg-xrpy">Explications br√®ves</th>
    <th class="tg-xrpy" colspan="2">Localisation</th>
  </tr>
  <tr>
    <td class="tg-uys7" colspan="5">Petrilab</td>
    <td class="tg-uys7"><span style="font-weight:bold">Interface graphique</span> pour cr√©er les strat√©gies</td>
    <td class="tg-uys7" colspan="2"><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/Principal/petri/">src/robot/Principal/petri/</a></td>
  </tr>
  <tr>
    <td class="tg-uys7">IAPrincipale</td>
    <td class="tg-uys7">IAWiiMote</td>
    <td class="tg-uys7">IATests</td>
    <td class="tg-uys7">IATestLidar</td>
    <td class="tg-uys7">...</td>
    <td class="tg-uys7"><span style="font-weight:bold">Ex√©cution</span> de la <span style="font-weight:bold">strat√©gie</span> / tests haut niveau</td>
    <td class="tg-uys7" colspan="2"><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/Principal/IA/">src/robot/Principal/IA/</a></td>
  </tr>
  <tr>
    <td class="tg-uys7" colspan="2">Strat√©gie</td>
    <td class="tg-uys7" colspan="3">MecaManager</td>
    <td class="tg-uys7"><span style="font-weight:bold">Couleur</span>, <span style="font-weight:bold">rep√®re</span>, temps, tirette ; fonctions <span style="font-weight:bold">haut niveau</span></td>
    <td class="tg-uys7"><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/Principal/librobot/Strategie.h">Strategie.h</a></td>
    <td class="tg-us36"><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/Principal/librobot/MecaManager.h">MecaManager.h</a></td>
  </tr>
  <tr>
    <td class="tg-uys7" colspan="5">RobotPrincipal <span style="font-style:italic">(public RobotCommun)</span></td>
    <td class="tg-uys7"><span style="font-weight:bold">Assignation</span> des cartes pour <span style="font-weight:bold">2018</span><br></td>
    <td class="tg-uys7" colspan="2"><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/Principal/librobot/Robot.h">src/robot/Principal/librobot/Robot.h</a></td>
  </tr>
  <tr>
    <td class="tg-uys7" colspan="5">RobotCommun <span style="font-style:italic">(virtual)</span></td>
    <td class="tg-uys7"><span style="font-weight:bold">Com'</span>, <span style="font-weight:bold">adversaire</span>, <span style="font-weight:bold">d√©placements</span>, cartes</td>
    <td class="tg-uys7" colspan="2"><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/Commun/Robot.h">src/robot/Commun/Robot.h</a></td>
  </tr>
  <tr>
    <td class="tg-uys7">D√©placement</td>
    <td class="tg-uys7">Servos</td>
    <td class="tg-uys7">Moteurs<br></td>
    <td class="tg-uys7">√âvitement<br></td>
    <td class="tg-uys7">...</td>
    <td class="tg-uys7"><span style="font-weight:bold">Interfaces</span> bloquantes</td>
    <td class="tg-uys7" colspan="2"><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/Commun/">src/robot/Commun/</a></td>
  </tr>
  <tr>
    <td class="tg-uys7" colspan="5">Cartes √©lectroniques</td>
    <td class="tg-uys7">Communication par <span style="font-weight:bold">trames</span></td>
    <td class="tg-uys7" colspan="2"><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/Cartes/">src/robot/Cartes/</a></td>
  </tr>
</table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="communication-avec-le-hardware"><a class="header" href="#communication-avec-le-hardware">Communication avec le hardware</a></h1>
<p>En robotique, il est crucial de pouvoir communiquer entre l'ordinateur d√©cisionnaire et avec l'ensemble des capteurs / moteurs qui animent le robot.</p>
<h2 id="histoire-de-la-communication-dans-le-club"><a class="header" href="#histoire-de-la-communication-dans-le-club">Histoire de la communication dans le Club</a></h2>
<p>Historiquement, le robot du Club √©tait compos√© d'une multitude de cartes d√©centralis√©es et chacune avait une fonction sp√©ficique (s'occuper de tous les servos moteurs par exemple). Ces cartes √©taient reli√©es par un <a href="https://fr.wikipedia.org/wiki/Bus_de_donn%C3%A9es_CAN">bus CAN</a> avec l'ordinateur et de nombreuses trames transitaient de mani√®re asynchrone.</p>
<p>Cependant, le savoir de l'utilisation des technologies utilis√©es (des microcontr√¥leurs √† PIC) s'est perdue et entre 2017 et 2019, on a d√©cid√© de changer l'architecture pour</p>
<ul>
<li>ma√Ætriser l'ensemble de la cha√Æne entre le hard et le soft</li>
<li>r√©aliser une documentation et un code propre pour faciliter le maintien et la passation du savoir</li>
<li>avoir une solution rapide pour remplacer de l'√©lectronique en cas de dysfonctionnement</li>
<li>augmenter les capacit√©s des cartes √©lectroniques</li>
</ul>
<p>Ainsi, on a √† pr√©sent une architecture d√©centralis√©e sur plusieurs cartes industrielles <a href="https://eu.mouser.com/new/stmicroelectronics/stm-nucleo-development-boards/">STM32 Nucleo</a>. La communication avec le soft se fait par ethernet, ce qui augmente la facilit√© de maintenance, la fiabilit√© et la puissance de communication.</p>
<hr />
<p>Il est maintenant temps de rentrer dans les d√©tails techniques de cette communication d√©centralis√©e.</p>
<h2 id="trames-de-communication"><a class="header" href="#trames-de-communication">Trames de communication</a></h2>
<p>Le but est d'utiliser les b√©n√©fices d'une communication entre deux 'cartes m√®res', et donc de partager le maximum d'informations entre l'informatique et l'√©lectronique. Ainsi, les trames ne correspondent plus √† un ordre sporadique address√© au hardware, mais elles regroupent l'ensemble de l'√©tat du robot.</p>
<p>L'ordinateur envoie l'√©tat du robot tel qu'il souhaite l'√™tre, et la carte √©lectronique travaille pour atteindre l'√©tat voulu. Cet √©tat g√©n√©ral est envoy√© par l'info puis renvoy√© par l'√©lec et ce en permanence, avec une fr√©quence de <strong>FIXER LA FREQUENCE</strong>.</p>
<p>Le format de l'√©tat se veut modulaire en JSON, afin de pouvoir √™tre utilis√© quel que soit le robot. Concr√®tement, la carte √©lectronique est consid√©r√©e comme un ensemble de modules ind√©pendants (d√©placement, √©vitement, moteurs, servos, capteurs...) qui poss√®dent chacun un ID, avec un <strong>maximum de 16</strong> modules connect√©s.</p>
<p>La tableau suivant regroupe les IDs des modules 'g√©n√©riquement', mais il n'est bien s√ªr pas fig√©.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">ID</th><th style="text-align: center">Module</th></tr></thead><tbody>
<tr><td style="text-align: center">0x01</td><td style="text-align: center">D√©placement</td></tr>
<tr><td style="text-align: center">0x02</td><td style="text-align: center">Servos</td></tr>
<tr><td style="text-align: center">0x03</td><td style="text-align: center">IO</td></tr>
<tr><td style="text-align: center">0x04</td><td style="text-align: center">√âvitement</td></tr>
<tr><td style="text-align: center">0x05</td><td style="text-align: center">Moteurs</td></tr>
<tr><td style="text-align: center">0x06</td><td style="text-align: center">Capteurs</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="format-g√©n√©ral-dune-trame"><a class="header" href="#format-g√©n√©ral-dune-trame">Format g√©n√©ral d'une trame</a></h2>
<p>Lorsque la partie informatique communique avec la carte appropri√©e √† propos d'un module, les informations partag√©es sont encapsul√©es suivant plusieurs blocs :</p>
<ul>
<li>Chaque module sait parser <em>(ie lire et √©crire)</em> un flux d'octets qui correspond √† un format texte JSON, qui est tr√®s simple √† lire. La sp√©cification de la structure de donn√©es √©chang√©es d√©pend de chaque module et peut se trouver <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Modules">dans ce dossier</a>. Elle est √©galement sp√©cifi√©e plus loin dans ce document.</li>
<li>Pour savoir √† quel module est address√© la trame, on rajoute son <strong><code>ID</code></strong> devant la trame sur un <code>u8</code>.</li>
<li>Enfin, la trame est envoy√©e sur le support physique :
<ul>
<li>dans le cas d'une liaison UDP, la taille de la trame se retrouve gr√¢ce aux informations du protocole de transport, donc il suffit d'envoyer un message contenant les donn√©es <code>{ID, trame}</code>. Les addresses IP utilis√©es sont les suivantes : <code>192.168.&lt;ID robot&gt;.&lt;ID module&gt;</code>, avec <code>&lt;ID robot&gt;</code> valant respectivement <code>0</code> et <code>1</code> pour les robots primaire et secondaire.</li>
<li>pour toutes les autres communications s√©rie, on encapsule <code>{ID, trame}</code> dans un header qui contient :
<ul>
<li>4 octets qui permettent de distinguer le d√©but d'une trame int√©ressante ; c'est n√©cessaire car on est dans une communication asynchrone. Dans le cas du club, elles commencent par le pattern <code>0xAC DC AB BA</code> pour sp√©cifier leur d√©but</li>
<li>1 octet pour contenir la taille du message int√©ressant, c'est √† dire la taille de <code>{ID, trame}</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="cr√©ation-dune-liaison-de-communication"><a class="header" href="#cr√©ation-dune-liaison-de-communication">Cr√©ation d'une liaison de communication</a></h2>
<p>La classe <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Communication/Communicator.h"><code>Communicator</code></a> s'occupe se g√©rer la communication √©lec-info. Il suffit de faire appel √† la m√©thode <code>connect</code> avec les bons arguments et la bonne liaison s√©rie est instanci√©e puis est capable de lire et √©crire des trames.</p>
<p>Cet objet est capable de parler sur n'importe quel m√©dium de communication, en faisait appel √† un <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Communication/Protocol.h"><code>Protocol</code></a>. La premi√®re m√©thode appelable est <code>send_frame</code>, qui envoie une trame ; la seconde doit √™tre lanc√©e dans un thread sp√©cifique et permets de recevoir des donn√©es pour les traiter avec un handler √† fournir : <code>recv_frame(const atomic_bool&amp; b, function&lt;void(GlobalFrame)&gt;)</code>. Le premier argument permets d'interrompre la fonction, qui est bloqu√©e dans un <code>while(b)</code>.</p>
<p>Voici les protocoles  possibles avec leurs arguments :</p>
<ul>
<li><strong>Liaisons s√©ries</strong>
<ul>
<li><code>protocol_null</code> : <code> </code>, toutes les trames sont perdues</li>
<li><code>protocol_tcpip</code> : <code>string address, uint16_t port</code> connexion TCP client vers le serveur <code>address:port</code></li>
<li><code>protocol_local</code> : <code> </code>, les trames sont envoy√©es en TCP vers un le serveur <code>localhost:4321</code></li>
<li><code>protocol_pipes</code> : <code>string rx, string tx</code>, lecture et √©criture sur des pipes nomm√©es ; par d√©faut : <code>rx: "/tmp/read.pipe"</code>, <code>tx: "/tmp/write.pipe"</code></li>
<li><code>protocol_udp</code> : <code>string address, uint16_t local_port, uint16_t remote_port</code>, liaison UDP depuis le port local vers le serveur UDP <code>address:remote_port</code>. Ce protocole peut √™tre utilis√© dans les deux sens de communication, contrairement √† l'impl√©mentation actuelle de <code>protocol_tcpip</code>.</li>
</ul>
</li>
<li><strong>Communications sur plusieurs liaisons s√©ries</strong>
<ul>
<li><code>protocol_ethernet</code> : <code>initializer_list&lt;UDPConnection&gt;</code>, permets de centraliser <code>N</code> connections UDP en un unique appel √† un thread de r√©ception bloquant. Ce protocole g√®re aussi l'association <code>id_module &lt;-&gt; UDP communication thread</code>.</li>
</ul>
</li>
</ul>
<p><img src="pre_2021/info/explications//images/info/communication.png" alt="UML de la communication" title="Diagramme UML de la communication" /></p>
<hr />
<h2 id="modules-sp√©cialis√©s"><a class="header" href="#modules-sp√©cialis√©s">Modules sp√©cialis√©s</a></h2>
<p>Chaque module a un r√¥le particulier (g√©rer les servos, se d√©placer, d√©tecter l'adversaire, capter des infos dans ce monde de sauvage, ...). Pour faciliter la maintenabilit√© du code, des parties sont mises en commun entre l'info et l'√©lec.</p>
<p>Les deux parties utilisent un langage de programmation diff√©rent donc les deux parties doivent utiliser le m√™me protocole pour communiquer. La solution retenue est d'envoyer des messages en format JSON encapsul√©s dans de l'UDP via une liaison ethernet.</p>
<p>Les formats de JSON sont appropri√©s pour le debug car les messages sont lisibles avec <a href="pre_2021/info/explications/www.wireshark.org">wireshark</a>. De plus, ils sont bien plus maintenables car le code est bien plus simple (on utilise des librairies pour parser le JSON).</p>
<p>LQ seule pr√©rogative pour la partie en <code>Rust</code> est de d√©clarer des structures de donn√©es qui correspondent aux formats transit√©s en JSON.</p>
<h3 id="format-du-module-servos"><a class="header" href="#format-du-module-servos">Format du module <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Modules/Servos.h"><code>Servos</code></a></a></h3>
<p><a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Modules/Servos.h">Cette classe</a> permets de g√©rer un ensemble de <a href="https://www.robotshop.com/media/files/pdf/manual-drs-0101.pdf">servos-moteurs</a> en connaissant l'ensemble des informations qui leur sont propres et dont l'√©tat est partag√© avec les √©lecs.</p>
<p>Pour avoir une id√©e technique de son API, je te conseille d'aller voir directement le code source.
L'interface permets de rajouter des servos (ID &gt; 0) puis de contr√¥ler chaque partie avec des fonctions thread-safe.</p>
<p>La s√ªret√© par rapport au partage des donn√©es se fait gr√¢ce √† une <a href="http://www.cplusplus.com/reference/mutex/">variable mutex</a> partag√©e et qui est bloqu√©e √† chaque acc√®s sur des variables : si la trame des servos est en cours de g√©n√©ration, l'√©criture du nouvel angle doit attendre pour que le mutex soit lib√©r√©.</p>
<p>Actuellement, cette classe g√®re 8 servos (la valeur est constante dans le code) et la trame associ√©e est d√©finie ainsi :</p>
<pre><code>&lt;id&gt;
{
  "id": &lt;u8&gt;,
  "known_position": &lt;u16&gt;,
  "control": "[Position|Speed]",
  "data": &lt;u16&gt;,
  "rotation": "[Clockwise|CounterClockwise]",
  "blocked": &lt;bool&gt;,
  "mode": "[Unblocking|HoldOnBlock]",
  "color": "[Block|Red|Green|Yellow|Blue|Magenta|Cyan|White]"
}
</code></pre>
<p>Les √©tats de chaque servomoteur est envoy√© individuellement par le module pour limiter l'impact d'une perte de paquet ainsi que pour faciliter la lecture des trames.</p>
<h3 id="format-du-module-motors"><a class="header" href="#format-du-module-motors">Format du module <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Modules/Motors.h"><code>Motors</code></a></a></h3>
<p><a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Modules/Motors.h">Cette classe</a> fournit une interface pour travailler avec 8 moteurs asservis, 8 moteurs non-asservis et 8 brushless, dont les fonctions associ√©es sont sp√©cifiques. Voici la trame qui sp√©ficie les informations de tout ce beau monde :</p>
<pre><code>&lt;id&gt;
{
  ## TODO
}
</code></pre>
<h3 id="format-du-module-io"><a class="header" href="#format-du-module-io">Format du module <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Modules/IO.h"><code>IO</code></a></a></h3>
<p><a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Modules/IO.h">Cette classe</a> est un vestige d'une ancienne fa√ßade avec plein de boutons <em>(pour choisir la couleur, le type de connexion...)</em>. Elle ne sert actuellement qu'√† d√©tecter si la tirette est enclench√©e ou non et ne relaye donc qu'un Bool√©en par l'interm√©diaire de cette structure de trame :</p>
<pre><code>&lt;id&gt;
{
  "tirette": &lt;bool&gt;
}
</code></pre>
<h3 id="format-du-module-navigation"><a class="header" href="#format-du-module-navigation">Format du module <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Modules/Navigation.h"><code>Navigation</code></a></a></h3>
<p><em><strong>TODO</strong></em></p>
<hr />
<h2 id="interface-de-communication"><a class="header" href="#interface-de-communication">Interface de communication</a></h2>
<p>Comme tu l'as vu dans les parties pr√©c√©dentes, on poss√®de √† pr√©sent plein de modules qui g√®rent des aspects diff√©rents du robot, et le <code>ModuleManager</code> offre un interfa√ßage facile pour conna√Ætre l'√©tat du robot.</p>
<p>On peut g√©n√©rer l'√©tat global du robot dans une trame, et mettre √† jour le robot depuis une trame globale ; il ne reste plus qu'√† g√©rer la communication entre l'info et l'√©lec !</p>
<p>Pour cela, tu peux aller voir <a href="https://github.com/ClubRobotInsat/info/tree/master/src/robot/Commun/Communication/ElecCommunicator.h">du c√¥t√© du communicateur</a>. Son but est d'avoir en param√®tre une classe qui lit et √©crit des <code>GlobalFrame</code>s, ainsi qu'un m√©dium de communication et il g√®re automagiquement la communication pour se connecter, ex√©cuter le protocole de transmission de trames et arr√™ter √† sa destruction la communication.</p>
<p>Afin d'√™tre aussi g√©n√©ral que possible, le communicateur peut prendre en param√®tre n'importe quel objet qui donne acc√®s aux fonctions de parsing :</p>
<ul>
<li><code>void read_frame(const GlobalFrame&amp;);</code></li>
<li><code>std::vector&lt;GlobalFrame&gt; write_frame() const;</code></li>
</ul>
<p>Si l'objet fourni ne poss√®de pas ces deux d√©finitions, la m√©thode <code>communicate_with_elecs</code> <em>(senc√©e √™tre ex√©cut√©e dans un thread pour recevoir et envoyer les trames)</em> devient inaccessible ; si la m√©ta-programmation ne te fait pas peur tu peux aller voir <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Communication/ParsingClassChecker.hpp">comment v√©rifier l'existance des fonctions de parsing</a>.</p>
<hr />
<h2 id="conclusion-4"><a class="header" href="#conclusion-4">Conclusion</a></h2>
<p>Voici un r√©capitulatif des couches d'abstraction que l'on vient d'aborder dans ce document :</p>
<ul>
<li>
<p>Wrapping de structures brutes en JSON pour conna√Ætre l'√©tat de chaque module : <em><a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/Modules/">lien</a></em></p>
<ul>
<li>du code <code>C++</code> et <code>Rust</code> (respectivement pour les infos et les √©lecs) englobe ces C-structs</li>
<li>nombreux avantages : rajout de s√©curit√©, tests et interface fonctionnelle</li>
</ul>
</li>
<li>
<p>le <a href="https://github.com/ClubRobotInsat/info/tree/develop/src/robot/Modules/ModuleManager.h"><code>ModuleManager</code></a> regroupe tous ces modules</p>
<ul>
<li>manipulation facilit√©e</li>
<li>tout l'√©tat du robot est centralis√©</li>
<li>parsing des trames globales</li>
</ul>
</li>
<li>
<p><a href="https://github.com/ClubRobotInsat/info/tree/master/src/robot/Communication/Communicator.h">communication avec les √©lecs</a> depuis les fonctions de parsing du <code>ModuleManager</code></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="d√©tection-de-ladversaire--lidar-1"><a class="header" href="#d√©tection-de-ladversaire--lidar-1">D√©tection de l'adversaire : LIDAR</a></h1>
<p>Jusqu'√† pr√©sent, la d√©tection de l'adversaire venait d'un projet <em>home-made</em> du club : un laser mont√© sur tourelle envoyait un rayon laser autour de la base. Une pi√®ce r√©fl√©chissante √©tait pos√©e sur les robots adverses et le syst√®me √©tait capable de conna√Ætre une valeur bool√©enne sur la pr√©sence d'un adversaire. M√©caniquement, le rayon passait soit au-dessus soit en-dessous de l'adversaire s'il n'√©tait pas dans un rayon de 30 √† 50 centim√®tres de notre robot. Les √©lectroniques √©taient enfin capables de nous donner l'angle auquel le robot a √©t√© d√©tect√©.</p>
<h2 id="explications-1"><a class="header" href="#explications-1">Explications</a></h2>
<p>Cette solution s'est inclin√©e face √† l'utilisation de <a href="pre_2021/info/explications/">LIDAR</a>s depuis 2019. Il s'agit d'un capteur beaucoup plus pr√©cis que notre ancienne tourelle, qui map en 2D son environnement avec des lasers. En sortie, on a une liste de distances qui repr√©sentent N points d√©tect√©s √† une certaine distance de notre robot.</p>
<p>Le code d√©velopp√© en interne au club permets d'utiliser deux LIDARs diff√©rents : <strong>[Hokuyo](https://github.com/ClubRobotInsat/info/blob/develop/src/Lidar/Doc/Doc\ Hokuyo.pdf)</strong> et <strong><a href="https://github.com/ClubRobotInsat/info/blob/develop/src/Lidar/Doc/doc_SICK.pdf">SICK TiM55x</a></strong>, le plus pr√©cis.</p>
<p>Dans un premier temps, un <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/Lidar/Driver">code driver</a> est capable de communiquer avec chacun de ces LIDARs. Pour avoir une interface d'acquisition, il suffit d'utiliser ce code :</p>
<pre><code class="language-cpp">#include "Lidar/Driver/lidar.h"
std::unique_ptr&lt;Lidar&gt; my_lidar = Lidar::open_lidar(Lidar::Any);
</code></pre>
<h3 id="sick-tim55x"><a class="header" href="#sick-tim55x">SICK TiM55x</a></h3>
<p>Pour utiliser ce capteur, il faut ex√©cuter le code en tant que <code>root</code>. De plus, il faut actuellement brancher l'√©lectronique sur une alimentation √† <code>16V / 0.2 A</code> pour brancher le c√¢ble circulaire √† 5 broches sur le LIDAR. Il faut utiliser un autre c√¢ble USB que celui soud√© entre le LIDAR et l'ordinateur.</p>
<h2 id="capacit√©s-actuelles"><a class="header" href="#capacit√©s-actuelles">Capacit√©s actuelles</a></h2>
<p>Le code est capable de <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/Lidar/filtre.h">filtrer</a> les trames d'acquisition. Ces points sont <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/Lidar/lidarsToGrid.h">entrepos√©s dans un plan 2D</a> en fonction des <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/commun/MathToolbox/Repere.h">coordonn√©es</a> du lidar ce qui permets de conna√Ætre la position absolue de chaque point dans un rep√®re quelconque, quelque soit la position initiale du robot.</p>
<p>Gr√¢ce √† la grande pr√©cision des LIDARs, la cartographie de toute la table est possible. Vu que le LIDAR est plac√© tout en haut de notre robot, les seuls points observ√©s par le LIDAR repr√©sentent des points sur la table <em>(les arbitres n'influent pas sur les acquisitions)</em> en-dehors des objets √† manipuler. Ainsi, seuls les robots adverses sont vus par le LIDAR, et donc les objets d√©tect√©s par le LIDAR <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/Lidar/FindRobots.h">sont consid√©r√©s comme des robots adverses</a>.</p>
<h2 id="int√©gration-dans-le-code"><a class="header" href="#int√©gration-dans-le-code">Int√©gration dans le code</a></h2>
<p>Ce capteur est externe au travail dans √©lectroniciens donc la classe <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Robot.h">Robot</a> contient directement une instance d'un <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/Lidar/lidar.h">LIDAR</a> en plus du <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Modules/ModuleManager.h">ModuleManager</a>. Il donne √† disposition l'acc√®s √† <code>optional&lt;FrameLidar&gt; get_lidar_frame() const</code>, qui est ensuite utilis√©e <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot/Strategy/AbstractStrategy.h">dans la strat√©gie</a> pour d√©tecter les adversaires en fonction de la position du robot.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cr√©ation-dun-robot-1"><a class="header" href="#cr√©ation-dun-robot-1">Cr√©ation d'un robot</a></h1>
<p>Dans la <a href="pre_2021/info/explications/communication.html">partie pr√©c√©dente</a>, tu as vu comment sont g√©r√©es la communication et la repr√©sentation √©lectronique des diff√©rents modules.</p>
<p>√Ä pr√©sent, il est temps de voir comment le code informatique g√®re l'abstraction d'un robot !</p>
<h2 id="le-regroupement-des-constantes"><a class="header" href="#le-regroupement-des-constantes">Le regroupement des constantes</a></h2>
<p>Le choix a √©t√© fait de d√©finir toutes les constantes dans un m√™me <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/robot.ini">fichier d'initialisation</a>.</p>
<p>√áa permet notamment d'avoir un moyen de changer une constante (la dur√©e d'un match, la composition modulaire des robots...) sans avoir √† recompiler tout le projet, et donc de gagner du temps.</p>
<p>On utilise le <a href="https://en.wikipedia.org/wiki/INI_file">format INI</a>, comopos√© de sections, de clefs et de valeurs ; le fichier est lisible et facilement maintenable.</p>
<h2 id="acc√®s-aux-constantes-dans-le-code"><a class="header" href="#acc√®s-aux-constantes-dans-le-code">Acc√®s aux constantes dans le code</a></h2>
<p>Toutes les constantes sont initialis√©es en C++ dans <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/commun/Constants.h">ce fichier</a>. Une instance des constantes est d√©finie globalement et il suffit de ce code pour r√©cup√©rer des informations :</p>
<pre><code class="language-cpp">#include &lt;Constants.h&gt;

int main() {
  Duration match = GLOBAL_CONSTANTS().get_match_duration();
}
</code></pre>
<p>Bien entendu, ces constantes servent √† d√©finir globalement un match (temps de jeu, taille de la table...) mais elles permettent √©galement de d√©finir les robots pr√©sents sur la table, comme nous allons le voir.</p>
<h2 id="lobjet-robot"><a class="header" href="#lobjet-robot">L'objet <code>Robot</code></a></h2>
<p>Conceptuellement, un robot a besoin de r√©pondre √† diff√©rents crit√®res :</p>
<ol>
<li>il poss√®de une architecture √©lectronique et donc m√©canique</li>
<li>sa partie informatique <em>(d√©cisionnelle)</em> est capable de communiquer avec sa partie √©lectronique <em>(applicative)</em></li>
<li>il peut prendre des d√©cisions pour √©voluer dans son environnement</li>
</ol>
<p>√áa tombe bien, parce qu'on a √† notre disposition le <code>ModuleManager</code> qui r√©soud le probl√®me <strong>1</strong>, et l'<code>ElecCommunicator</code> qui correspond au <strong>2</strong>. Enfin, la partie <strong>3</strong> est une fonction r√©alis√©e √† un niveau d'abstraction sup√©rieur, et on va l'aborder dans la section <em><strong>Strat√©gie</strong></em>.</p>
<p>Un <code>Robot</code> a donc deux r√¥le principaux : il g√®re le <code>ModuleManager</code> et s'occupe de la communication en lan√ßant dans un <a href="https://en.cppreference.com/w/cpp/thread/thread">thread</a> la communication.</p>
<p>Afin de simplifier son utilisation √† la fois dans le contexte de la Coupe et afin de d√©buguer les modules √©lectroniques.</p>
<ul>
<li>On peut construire l'√©lectronique '√† la main' en cr√©ant un <code>ModuleManager</code> puis en le donnant au constructeur du <code>Robot</code> :</li>
</ul>
<pre><code class="language-cpp">// Cr√©ation du module manager qui va h√©berger les modules
auto m = std::make_shared&lt;PhysicalRobot::ModuleManager&gt;();

// Ajout d'un module "Servos" avec deux servomoteurs
auto&amp; servos = m-&gt;add_module&lt;PhysicalRobot::Servos&gt;(2);
servos.add_servo(5, 120_deg);
servos.add_servo(6, 50_deg, PhysicalRobot::Servos::BlockingMode::HOLD_ON_BLOCKING);

// Cr√©ation d'un robot √† partir du ModuleManager pr√©c√©demment instanci√©
// Le deuxi√®me argument est une liste de param√®tres permettant d'initialiser la connexion au robot
// Ici on aura une connexion de type "PIPES"
PhysicalRobot::Robot robot(m, {"prog", "PIPES"});
</code></pre>
<ul>
<li>Utilisation du fichier <code>src/robot.ini</code> dans lequel on peut d√©finir en-dehors du programme les variables d'initialisation pour n'importe quel robot (<code>primary</code>, <code>secondary</code>, <code>adversary</code>, <code>best_robot_of_the_world</code>...). Un robot initialis√© √† partir d'un <code>ModuleManager</code> se nomme <code>guest</code>, donc le nom est r√©serv√© :smile:</li>
</ul>
<pre><code class="language-ini">[robot.primary]
position_x=250        ; mm
position_y=1500       ; mm
size_x=300            ; mm
size_y=300            ; mm
size_z=420            ; mm
angle=-90             ; deg

[robot.primary.modules]
moving=1
servos=2
motors=3
avoidance=4
io=5
</code></pre>
<hr />
<p>Il est donc tr√®s facile de cr√©er une instance qui poss√®de √† la fois l'architecture √©lectronique et qui s'occupe de la communication.</p>
<p>Je te laisse te reporter aux diff√©rents tests pour avoir des exemples de comment l'utiliser (pour tester les servos par exemple) ; les robots complets utilis√©s pendant les matches sont utilis√©s dans la <code>Strategy</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="architecture-du-simulateur"><a class="header" href="#architecture-du-simulateur">Architecture du simulateur</a></h1>
<p>Le simulateur est fait pour √™tre modulaire, c'est √† dire que l'on peut passer d'une solution graphique √† une autre et on peut rajouter des modules pour le robot facilement.</p>
<p>Il y a 5 composantes principales :</p>
<ul>
<li>La  <a href="https://github.com/ClubRobotInsat/info/tree/develop/src/simulateur/physique/"><code>physique/</code></a> permet de simuler le comportement de tous les objets physiquement
en prenant en compte les collisions, les d√©placements etc. Pour ce faire, on utilise la librairie <a href="http://box2d.org/">Box2D</a>, un moteur physique.</li>
<li>Le  <a href="https://github.com/ClubRobotInsat/info/tree/develop/src/simulateur/graphique/"><code>graphique/</code></a> permet d'afficher tous les objets de la table dans un environnement
3D avec la possibilit√© de s'y d√©placer, de zoomer ... Ici encore, on utilise une librairie, <a href="http://irrlicht.sourceforge.net/">Irrlicht</a>, en tant que moteur graphique.</li>
<li>La <a href="https://github.com/ClubRobotInsat/info/tree/develop/src/simulateur/gui/"><code>gui/</code></a> g√®re l'interface utilisateur, affiche des informations utiles (telles que l'√©tat
du robot par exemple) et permet de piloter le simulateur.</li>
<li>La <a href="https://github.com/ClubRobotInsat/info/tree/develop/src/simulateur/communication/"><code>communication/</code></a> permets de simuler le comportement des cartes √©lectroniques.
On peut donc utiliser la m√™me strat√©gie en r√©el et sur le simulateur qui demande au robot d'<code>avancer</code> de 10 cm par exemple, et l'application va simuler les actions.</li>
<li>Le <a href="https://github.com/ClubRobotInsat/info/tree/develop/src/simulateur/core/"><code>core/</code></a> permets enfin de tout coordonner pour avoir un simulateur fonctionnel.</li>
</ul>
<h2 id="coeur"><a class="header" href="#coeur">Coeur</a></h2>
<p>Le simulateur est enti√®rement controll√© par la classe <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/simulateur/core/Simulateur.h"><code>Simulateur</code></a>.
Cette classe est instanci√©e directement dans le <code>main</code> et contr√¥le les diff√©rents modules. Elle contient des m√©thodes pour initialiser le simulateur,
reset la table, ajouter des robots √† la simulation, et terminer proprement une session.</p>
<p>La classe <code>Simulateur</code> contient une instance de <code>World</code>.</p>
<h2 id="communication-1"><a class="header" href="#communication-1">Communication</a></h2>
<p>La communication du simulateur fonctionne en mirroir de celle de l'IA. Le code a donc plus ou moins la m√™me structure : plusieurs modules, rassembl√©s dans un <code>ModuleManager</code>,
et un communicator pour g√©rer l'envoi des trames.</p>
<p>Le simulateur impl√©mente ses propres modules sp√©cifiques, qui jouent le r√¥le des cartes dans le robot r√©el. Ces modules fonctionnent exactement sur le m√™me principe que les
modules c√¥t√© IA : ils re√ßoivent des trames, les lisent, effectuent des actions et envoient de nouvelles trames en r√©ponse.</p>
<p>Le simulateur jouant le r√¥le des cartes du robot, il envoit une trame seulement en r√©ponse √† une trame de la partie informatique. Ce comportement est impl√©ment√© dans la m√©thode
<code>communicationThread()</code> du <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/simulateur/communication/SimuCommunicator.cpp"><code>SimuCommunicator</code></a>.</p>
<h2 id="partie-physique"><a class="header" href="#partie-physique">Partie physique</a></h2>
<p>L'API de la partie physique est constitu√©es de deux interfaces :
<a href="https://github.com/ClubRobotInsat/info/blob/develop/src/simulateur/physique/IPhysicalContext.h"><code>IPhysicalContext</code></a>, qui permet de cr√©er des objets dans le moteur physique
et <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/simulateur/physique/IPhysicalInstance.h"><code>IPhysicalInstance</code></a>, qui permet de g√©rer un objet physique en
particulier.</p>
<p>Le coeur du simulateur ne manipule que ces interfaces, et n'a pas besoin de savoir comment c'est impl√©ment√© derri√®re. L'utilisation d'interfaces de cette mani√®re permet le
<strong>d√©couplage</strong> des diff√©rentes parties du simulateur. Pour plus d'information sur le couplage des composants logiciels d'une application, voici un lien vers
<a href="https://fr.wikipedia.org/wiki/Couplage_(informatique)">la page Wikipedia</a></p>
<h3 id="impl√©mentation"><a class="header" href="#impl√©mentation">Impl√©mentation</a></h3>
<p>L'implementation du moteur physique du simulateur est r√©alis√©e √† l'aide du moteur physique <a href="https://box2d.org/">Box2D</a>. Elle se situe dans le dossier
<a href="https://github.com/ClubRobotInsat/info/tree/develop/src/simulateur/physique/box2D/"><code>physique/box2D/</code></a>.</p>
<p>Il y a quelques ann√©es, le simulateur utilisait un moteur physique en 3D. M√™me si les simulations √©taient plus r√©alistes, il √©tait difficile de configurer l'environnement
pour que le robot se comporte comme en vrai. C'est pourquoi nous sommes pass√©s √† un moteur en 2D.</p>
<h2 id="partie-graphique"><a class="header" href="#partie-graphique">Partie graphique</a></h2>
<p>De m√™me que la partie physique, la partie graphique du simulateur est manipul√©e via deux interfaces,
<a href="https://github.com/ClubRobotInsat/info/blob/develop/src/simulateur/graphique/IGraphicalContext.h"><code>IGraphicalContext</code></a> pour cr√©er les objets 3D de l'affichage
et <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/simulateur/graphique/IGraphicalInstance.h"><code>IGraphicalInstance</code></a> pour modifier les propri√©t√©s d'un
objet en particulier.</p>
<h3 id="impl√©mentation-1"><a class="header" href="#impl√©mentation-1">Impl√©mentation</a></h3>
<p>Nous utilisons <a href="http://irrlicht.sourceforge.net/">Irrlicht</a> pour l'impl√©mentation de l'affichage graphique de la simulation. Celle-ci se trouve dans le dossier
<a href="https://github.com/ClubRobotInsat/info/tree/develop/src/simulateur/graphique/irrlicht/"><code>graphique/irrlicht/</code></a>.</p>
<h2 id="interface-utilisateur-gui"><a class="header" href="#interface-utilisateur-gui">Interface utilisateur (GUI)</a></h2>
<p>Pour pouvoir interagir avec le simulateur, il faut des boutons, des champs de texte, etc. Ces fonctionnalit√©s sont assez diff√©rentes de l'affichage 3D du simulateur.
De plus, Irrlicht ne nous permet pas de rajouter facilement des √©l√©ments d'UI (User Interface) √† l'affichage 3D. La GUI est donc un module s√©par√© de l'affichage 3D.
Le coeur du simulateur interagit avec ce module √† travers l'interface <a href="https://github.com/ClubRobotInsat/info/blob/develop/src/simulateur/gui/IGuiContext.h"><code>IGuiContext</code></a>.</p>
<p>Le module doit aussi transmettre les ordres de l'utilisateur au simulateur. Pour se faire, il re√ßoit lors de son initialisation un objet de type
<a href="https://github.com/ClubRobotInsat/info/blob/develop/src/simulateur/gui/IGuiClient.h"><code>IGuiClient</code></a>, qui poss√®de des m√©thodes permettant d'√©xecuter des actions
sur le simulateur.</p>
<h3 id="impl√©mentation-2"><a class="header" href="#impl√©mentation-2">Impl√©mentation</a></h3>
<p>La librarie utilis√©e pour la GUI se nomme <a href="https://www.gtkmm.org/en/">Gtkmm</a>. C'est un port C++ de la librairie C <em>Gtk</em> utilis√©e dans de nombreuses programmes comportant
une interface graphique. Vous pourrez trouver une doc tr√®s d√©taill√©e de Gtkmm
<a href="https://developer.gnome.org/gtkmm-tutorial/unstable/gtkmm-tutorial.html">ici</a>.</p>
<p>La GUI se compose actuellement d'une fen√™tre comportant plusieurs panneaux. Les panneaux sont cr√©√©s avec <a href="https://glade.gnome.org/">Glade</a>. Ils sont sauvegard√©s dans
le dossier <code>gui/gtk/glade/</code> sous forme de fichiers <code>.glade</code>. A la cr√©ation de la fen√™tre, le simulateur charge ces diff√©rents panneaux et les ajoute √† la fen√™tre
principale. Comme √ßa le placement des composants est d√©j√† fait, il ne reste plus qu'√† √©crire le code qui ex√©cute l'action demand√©e par l'utilisateur.</p>
<p>Les diff√©rentes classes qui g√®rent les panneaux ont toutes un nom de la forme <code>Panel[Nom du panneau].h/.cpp</code>. Le <code>PanelConnect</code> est un bon exemple si vous voulez impl√©menter
votre propre panneau !</p>
<h2 id="compl√©ment-sur-le-couplage-"><a class="header" href="#compl√©ment-sur-le-couplage-">Compl√©ment sur le couplage :)</a></h2>
<pre><code>Section √† r√©diger
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="√âlectronique-logicielle"><a class="header" href="#√âlectronique-logicielle">√âlectronique Logicielle</a></h1>
<p>L‚Äô√©lectronique logicielle (ou <em>elec soft</em> pour les intimes) consiste √† concevoir le fonctionnement logiciel d'un microcontr√¥leur et de ses p√©riph√©riques.</p>
<p>Le but des cartes √©lectroniques est de fournir √† la partie informatique du robot un moyen simple d'envoyer des commandes aux diff√©rents actionneurs et de lire les diff√©rents capteurs. Pour certains types de composants c'est assez simple (les composants binaires comme les LEDs ou les vannes) et pour d'autres cela implique plus de travail (servomoteurs num√©riques, moteurs √† courant continu).</p>
<p>La carte √©lectronique va donc avoir un r√¥le d‚Äôinterm√©diaire entre l'ordinateur embarqu√© et le monde physique du robot. Normalement, si tout va bien durant l'ann√©e, un circuit imprim√© a √©t√© r√©alis√© afin que le microcontr√¥leur puisse parler avec les actionneurs/capteurs.</p>
<p>Il suffit donc de programmer le microcontr√¥leur pour qu'il envoie les bons signaux quand on lui demande !</p>
<h1 id="plus-de-documentation"><a class="header" href="#plus-de-documentation">Plus de documentation</a></h1>
<p>Tu veux encore plus de documentation ? Ta soif de savoir ne s'√©tanche pas ? Tu cherches le d√©tail du fonctionnement du module UART du microcontr√¥leur stm32f103 ? Tu n'arrive pas √† savoir si l‚Äôadresse <code>0x4000400C</code> est un Timer ou un I2C ? Tu cherches le layout du W5500 ? Tu veut comprendre les arcanes de l'elec ? Toutes ces informations se trouvent dans l'archive compil√©e par mes soins, <a href="pre_2021/elec_soft/../images/elec_soft/DOC.tar.gz">ici</a></p>
<p>Inclu notamment :</p>
<ul>
<li>ref du stm32f103</li>
<li>ref du stm32f446</li>
<li>ref du tcs3200</li>
<li>ref des drs0101</li>
<li>ref des ponts h</li>
<li>ref du w5500</li>
</ul>
<p>(liste non contractuelle)</p>
<p><a href="pre_2021/elec_soft/../images/elec_soft/DOC.tar.gz">Archive</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="organisation--architecture"><a class="header" href="#organisation--architecture">Organisation &amp; Architecture</a></h1>
<p>Le code est s√©par√©e en deux : les fonctionnalit√©s partag√©es entre les cartes sont dans <a href="https://github.com/ClubRobotInsat/librobot">librobot</a> et chaque carte est impl√©ment√©e dans le repo git <code>firmware-&lt;fonctionnalit√©&gt;</code>.</p>
<p>Il y a actuellement (apr√®s la coupe de 2019), 4 cartes:</p>
<ul>
<li><a href="https://github.com/ClubRobotInsat/firmware-navigation"><code>firmware-navigation</code></a></li>
<li><a href="https://github.com/ClubRobotInsat/firmware-servos"><code>firmware-servos</code></a></li>
<li><a href="https://github.com/ClubRobotInsat/firmware-io/"><code>firmware-io</code></a></li>
<li><a href="https://github.com/ClubRobotInsat/firmware-io-secondary"><code>firmware-io-secondary</code></a></li>
</ul>
<h2 id="librobot"><a class="header" href="#librobot">Librobot</a></h2>
<p>Cette librairie a √©t√© introduite afin de r√©utiliser du code entre les cartes.
Un effet sympathique de cette librairie c'est qu'il possible d'y √©crire des <a href="https://doc.rust-lang.org/rust-by-example/testing/unit_testing.html">tests unitaires</a>.</p>
<p>La documentation de la librairie est reg√©n√©r√©e par <a href="https://fr.wikipedia.org/wiki/Travis_CI">Travis</a> (script <a href="https://github.com/ClubRobotInsat/librobot/blob/master/.travis.yml">ici</a>) √† chaque commit et se trouve <a href="https://clubrobotinsat.github.io/librobot/librobot/">ici</a>.</p>
<h2 id="cartes"><a class="header" href="#cartes">Cartes</a></h2>
<p>Chaque carte est structur√©e de la m√™me fa√ßon. Voici le contenu de <code>firmware-navigation</code> pour le commit <code>c86b1a0cd1d5da5030a1fac55fae41ac4cf591d7</code> :</p>
<pre><code>‚îú‚îÄ‚îÄ black_pill.cfg
‚îú‚îÄ‚îÄ Cargo.lock
‚îú‚îÄ‚îÄ Cargo.toml
‚îú‚îÄ‚îÄ debug.sh
‚îú‚îÄ‚îÄ interfaces
‚îÇ  ‚îú‚îÄ‚îÄ stlink-v2-1.cfg
‚îÇ  ‚îî‚îÄ‚îÄ stm32f1x.cfg
‚îú‚îÄ‚îÄ memory.x
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ src
‚îÇ  ‚îú‚îÄ‚îÄ main.rs
‚îÇ  ‚îú‚îÄ‚îÄ robot.rs
‚îÇ  ‚îî‚îÄ‚îÄ variables.rs
‚îî‚îÄ‚îÄ target
   ‚îú‚îÄ‚îÄ debug
   ‚îÇ  ‚îú‚îÄ‚îÄ build
   ‚îÇ  ‚îú‚îÄ‚îÄ deps
   ‚îÇ  ‚îú‚îÄ‚îÄ examples
   ‚îÇ  ‚îú‚îÄ‚îÄ incremental
   ‚îÇ  ‚îî‚îÄ‚îÄ native
   ‚îú‚îÄ‚îÄ release
   ‚îÇ  ‚îú‚îÄ‚îÄ build
   ‚îÇ  ‚îú‚îÄ‚îÄ deps
   ‚îÇ  ‚îú‚îÄ‚îÄ examples
   ‚îÇ  ‚îú‚îÄ‚îÄ incremental
   ‚îÇ  ‚îî‚îÄ‚îÄ native
   ‚îî‚îÄ‚îÄ thumbv7m-none-eabi
      ‚îú‚îÄ‚îÄ debug
      ‚îî‚îÄ‚îÄ release

</code></pre>
<p>Les fichiers <code>Cargo.toml</code> et <code>Cargo.lock</code> listent les d√©pendances du projet. Il faut noter que <code>Cargo.lock</code> est suivi par git, comme √ßa tout le monde compile les m√™mes versions des librairies (c'est tr√®s important pour tout le monde ai le m√™me code !).</p>
<p>Le fichier <code>black_pill.cg</code> et ceux pr√©sents dans <code>interfaces</code> sont les fichiers de configuration de OpenOCD afin de flasher la carte.</p>
<p>Le fichier <code>debug.sh</code> invoque <code>gdb</code> aves les bons arguments pour se connecter √† OpenOCD et flasher la carte.</p>
<p>Le fichiers <code>memory.x</code> d√©crit l'organisation de la m√©moire du microcontrolleur.</p>
<p>Le fichier <code>README.md</code> sers de documentation minimale pour la carte.</p>
<p>Dans le dossier <code>src</code> on trouve :
* <code>main.rs</code> : contiens la logique de la fonction main
* <code>robot.rs</code> : contiens l'initialisation du microcontrolleur et de ses p√©riph√©riques</p>
<p>Enfin, le dernier dossier qui nous int√©rresse est le dossier <code>target/thumbv7m-none-eabi</code> qui contiens le r√©sultat de la compilation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mise-en-place-2"><a class="header" href="#mise-en-place-2">Mise en place</a></h1>
<p>Dans cette section, nous allons installer pas √† pas tous les outils pour pouvoir d√©velopper du code pour le robot.</p>
<p>Avant d'attaquer cette partie tu as install√© avec succ√®s :</p>
<ul>
<li><a href="pre_2021/elec_soft/mise_en_place/git.html">git</a></li>
<li><a href="pre_2021/elec_soft/mise_en_place/ide.html">CLion</a></li>
</ul>
<p>Nous allons donc commencer par installer un compilateur Rust, ainsi que des outils pour pouvoir flasher, d√©boguer et tester le code.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compilation-1"><a class="header" href="#compilation-1">Compilation</a></h1>
<p>Dans cette section, tu vas faire le grand pas et mettre en place tous les outils pour bidouiller sur les cartes du club robot !</p>
<p>Attention, les instructions sont valables uniquement pour Linux, et sont √† adapt√©es pour ceux qui ont des distributions Linux diff√©rentes de Ubuntu.</p>
<h1 id="outils-g√©n√©riques"><a class="header" href="#outils-g√©n√©riques">Outils g√©n√©riques</a></h1>
<p>Tout d'abord il te faut installer les outils suivants :</p>
<ul>
<li><code>gdb-arm-none-eabi</code> : <code>gdb</code> est un d√©buggeur, tu installes ici la version pour l'architecture <code>arm</code> sans os (<code>none</code>). Tu trouveras plus d'informations sur gdb par <a href="https://fr.wikipedia.org/wiki/GNU_Debugger">ici</a>. Pour les notions d'architecture, tu peux toujours lire la page sur l'<a href="https://fr.wikipedia.org/wiki/Architecture_de_processeur">architecture mat√©rielle</a> sur wikip√©dia.</li>
<li><code>gcc-arm-none-eabi</code> : <code>gcc</code> est un compilateur pour le langage C. Tu installes la version pour compiler vers l'architecture <code>arm</code> ici.</li>
<li><code>openocd</code> : cet outil permet de communiquer avec le microcontr√¥leur : c'est gr√¢ce √† lui que l'on peut envoyer des ex√©cutables dessus et les d√©boguer.</li>
</ul>
<p>Sur Ubuntu, cela se fait en ex√©cutant les commandes suivantes dans un terminal :</p>
<pre><code class="language-bash">sudo apt update
sudo apt install git gdb-multiarch gdb-arm-none-eabi gcc-arm-none-eabi openocd
</code></pre>
<p>La premi√®re commande mets √† jour les paquets disponibles, la deuxi√®me les installe.</p>
<h2 id="customisation-de-gdb"><a class="header" href="#customisation-de-gdb">Customisation de gdb</a></h2>
<p>Bien que tr√®s puissant, gdb propose une interface d'un autre si√®cle. Je te propose de rendre cette interface plus agr√©able !</p>
<ol>
<li>On r√©cup√®re un fichier tout fait qui rend l'interface de gdb supportable :
<pre><code class="language-bash">wget -P ~ git.io/.gdbinit
</code></pre>
</li>
<li>On autorise le chargement de ce fichier par gdb :
<pre><code class="language-bash">echo "set auto-load safe-path /" &gt;&gt; ~/.gdbinit
</code></pre>
</li>
</ol>
<h1 id="rust"><a class="header" href="#rust">Rust</a></h1>
<p>Pour installer Rust, tu peux te r√©f√©rer aux instructions sur <a href="https://rustup.rs">rustup.rs</a>. Les param√®tres par d√©faut sont tr√®s bien.
Si tu as bien install√© Rust, quand tu ouvres un nouveau terminal et que tu tapes :</p>
<pre><code class="language-bash">rustc --version
</code></pre>
<p>Il devrait s'afficher un texte qui ressemble √† √ßa (tu auras certainement une version plus r√©cente, l√† il s'agit de la version du 20 Mai 2019) :</p>
<pre><code class="language-bash">rustc 1.35.0 (3c235d560 2019-05-20)
</code></pre>
<h1 id="utilitaires"><a class="header" href="#utilitaires">Utilitaires</a></h1>
<p>Pour bidouiller plus efficacement, tu peux aussi installer quelques outils plut√¥t pratiques.</p>
<h2 id="obligatoire--rustfmt"><a class="header" href="#obligatoire--rustfmt">Obligatoire : rustfmt</a></h2>
<p>Dans un projet informatique, plusieurs personnes ont des conventions d'alignement du texte diff√©rent, diff√©rentes mani√®res d'aller √† la ligne dans les d√©clarations, etc. Si jamais tu t'ennuies, tu peux demander √† un barbu si il pr√©f√®re les tabulations ou les espaces pour indenter le code, flame ware garantie !
Dans le but d'uniformiser le code produit par tout le monde, on utilise un outil <a href="https://github.com/rust-lang-nursery/rustfmt">rustfmt</a> qui va venir formater le code. Plus besoin de se prendre la t√™te avec l'indentation ou les retours √† la ligne dans les gros appels de fonctions : on lance <code>rustfmt</code> et le code est format√©.</p>
<p>Cet outil est <strong>obligatoire</strong>, autrement ton installation ne fonctionnera pas. Pour l'installer il suffit de taper dans un terminal :</p>
<pre><code class="language-bash">rustup component add rustfmt-preview
</code></pre>
<h2 id="optionnel--cargo-edit"><a class="header" href="#optionnel--cargo-edit">Optionnel : cargo-edit</a></h2>
<p>L'outil <code>cargo-edit</code> permet d'ajouter facilement des librairies depuis la ligne de commande dans un projet. Pour plus d'informations tu peux aller lire la description de l'outil par <a href="https://crates.io/crates/cargo-edit">ici</a>.</p>
<pre><code class="language-bash">cargo install cargo-edit
</code></pre>
<h2 id="optionnel-cargo-clone"><a class="header" href="#optionnel-cargo-clone">Optionnel cargo-clone</a></h2>
<p>L'outil <code>cargo-clone</code> permet de r√©cup√©rer le code source de n'importe quelle librairie disponible sur <a href="https://crates.io">crates.io</a> en une ligne de commande.</p>
<pre><code class="language-bash">cargo install cargo-clone
</code></pre>
<h1 id="erreurs-courantes"><a class="header" href="#erreurs-courantes">Erreurs courantes</a></h1>
<p>Quelques erreurs arrivent r√©guli√®rement et sont d√ª √† une mauvaise configuration du compilateur. En particulier l'erreur : <code>error: linking with `cc` failed: exit code: 1</code> peut √™tre r√©solue ainsi :
On installe gdb-multilib : <code>sudo apt install gcc-multilib</code>.
Si l'erreur n'est pas r√©solue, on v√©rifie que l'on a choisi le bon compilateur : <code>sudo update-alternatives --config gcc</code> et choisir gcc-8.</p>
<pre><code class="language-bash">expected struct heapless::string::String, found a different struct heapless::string::String
</code></pre>
<p>La version de librobot utilis√©e n'est pas la bonne, il faut choisir la branch "master" (et non "dev-new-pid") :</p>
<pre><code class="language-bash">nano Cargo.toml
librobot = {git="https://github.com/ClubRobotInsat/librobot", default-features=false}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="r√©pertoire-de-travail-2"><a class="header" href="#r√©pertoire-de-travail-2">R√©pertoire de travail</a></h1>
<p>Maintenant ouvrons le projet du club robot avec CLion et v√©rifions que tout fonctionne.</p>
<p>Pour commencer, si tu n'as jamais entendu parler de <code>git</code> ou que tu ne te sens pas tr√®s √† l'aide avec, tu peux revenir un peu en arri√®re et lire <a href="pre_2021/elec_soft/mise_en_place/outils_communs/git.html">ceci</a>.</p>
<p>On va compiler le code de la carte servomoteurs.</p>
<h1 id="r√©cup√©rer-le-code-de-la-librairie"><a class="header" href="#r√©cup√©rer-le-code-de-la-librairie">R√©cup√©rer le code de la librairie</a></h1>
<p>Pour r√©cup√©rer le code, je te sugg√®re de commencer par te cr√©er un dossier qui contiendra tous les r√©pertoires du club robot (si ce n'est pas d√©j√† fait).
Une fois plac√© dans ce dossier, tu peux ex√©cuter la commande :</p>
<pre><code class="language-bash">git clone https://github.com/ClubRobotInsat/librobot
</code></pre>
<p>Cette commande va venir demander √† <code>git</code> d'aller r√©cup√©rer la derni√®re version du code disponible sur <a href="https://github.com/ClubRobotInsat/librobot">github</a> pour la librairie du club robot.</p>
<p>Un nouveau dossier <code>librobot</code> a du appara√Ætre.</p>
<h1 id="r√©cup√©rer-le-code-de-la-carte-√©lectronique"><a class="header" href="#r√©cup√©rer-le-code-de-la-carte-√©lectronique">R√©cup√©rer le code de la carte √©lectronique</a></h1>
<p>De m√™me, il faut cloner un r√©pertoire sur github pour avoir le code de la carte √©lectronique :</p>
<pre><code class="language-bash">git clone https://github.com/ClubRobotINSAT/firmware-servos
</code></pre>
<p>Il y a quelques √©tapes de configuration √† faire avant de compiler :</p>
<ol>
<li>
<p>Il faut rajouter la cible <code>thumbv7m-none-eabi</code> avec rustup</p>
<pre><code class="language-bash">cd firmware-servos
rustup target add thumbv7m-none-eabi
</code></pre>
</li>
<li>
<p>Il faut v√©rifier que le projet compile bien :</p>
<pre><code class="language-bash">cargo build --release
</code></pre>
</li>
</ol>
<p>Explication :</p>
<ul>
<li>
<p><code>thumbv7m</code> : jeu d'instruction ARMv7, il s'agit du jeu d'instruction du Cortex M4</p>
</li>
<li>
<p><code>none</code> : pas de syst√®me d'exploitation sur la carte √©lectronique</p>
</li>
<li>
<p><code>eabi</code> : on aurait pu avoir l'option <code>hf</code> qui signifie "hard float", c'est √† dire que le compilateur va √©mettre des instructions sp√©ciales pour les calculs sur les nombres flottants au lieu de les calculer avec des entiers. En effet, certains microcontr√¥leurs embarquent un Floating Point Unit (FPU) qui permet de faire des calculs flottants rapidement. Cependant sur la black-pill il y a un <code>stm32f103</code> qui n'a pas de FPU on ne met donc pas cette option.</p>
</li>
</ul>
<p>Si la compilation a march√© alors tout a √©t√© install√© correctement !</p>
<h1 id="arborescence-du-code-et-fichiers-remarquables"><a class="header" href="#arborescence-du-code-et-fichiers-remarquables">Arborescence du code et fichiers remarquables</a></h1>
<p>Pour comprendre les diff√©rents fichiers pr√©sents dans le dossier du projet, tu peux revenir en arri√®re et lire <a href="pre_2021/elec_soft/mise_en_place/../organisation/index.html">Organisation du code</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ide-4"><a class="header" href="#ide-4">IDE</a></h1>
<p>Normalement tu as suivi les instructions de la section <a href="pre_2021/elec_soft/mise_en_place//outils_communs/ide.html">Outils Communs - IDE</a>, tu as donc une installation de CLion fonctionnelle.</p>
<p>Si ce n'est pas le cas, reviens un petit peu en arri√®re et installe CLion !</p>
<h2 id="installation-du-plugin-pour-rust"><a class="header" href="#installation-du-plugin-pour-rust">Installation du plugin pour Rust</a></h2>
<p>En √©lectronique logicielle, nous utilisons le langage <strong>Rust</strong>. Tu en entendras parler un peu plus loin dans la documentation. En attendant il faut installer un plugin pour supporter le langage dans CLion.</p>
<p>Il faut commencer par ouvrir les options de CLion <code>File&gt;Settings</code> ou encore <code>ctrl+alt+s</code>.</p>
<p>Dans le menu <code>Plugins</code> tu cliques sur <code>Install Jetbrains Plugins</code> et tu cherches <code>Rust</code> dans la fen√™tre qui s'est ouverte. Pour lancer l'installation, il suffit de cliquer sur <code>Install</code>.</p>
<p>Normalement il devrait √™tre possible de compiler, sinon tu peut aller voir dans <code>Settings &gt; Languages &amp; Frameworks &gt; Rust</code> si tout a √©t√© bien d√©tect√© et cliqu√© sur <code>download stdlib with rustup</code> si cela t'es propos√©.</p>
<p><img src="pre_2021/elec_soft/mise_en_place//images/ide/plugin_install.png" alt="Installation du plugin pour Rust" title="Plugin pour Rust" /></p>
<h2 id="v√©rification-de-linstallation"><a class="header" href="#v√©rification-de-linstallation">V√©rification de l'installation</a></h2>
<p>Si il n'y a pas de messages d'erreur, <em><strong>BRAVO</strong></em> tu viens d'installer avec succ√®s le plugin Rust pour CLion !</p>
<h1 id="compilation-dun-projet"><a class="header" href="#compilation-dun-projet">Compilation d'un projet</a></h1>
<p>Maintenant c'est la derni√®re √©tape, le grand moment : nous allons compiler un projet.</p>
<p>C'est le moment de lancer CLion ! Une fois lanc√©, dans <code>File &gt; Open</code> choisi le dossier de <code>black-pill</code>.</p>
<p>Si tout se passe bien, tu devrais pouvoir compiler, tester et formater le code. Pour cela, il faut choisir la configuration ad√©quate, en haut √† droite de ton interface et appuyer sur le bouton <code>run</code>.</p>
<p>Si la compilation fonctionne, tu peux passer √† la suite c'est tout bon tu as tout install√© avec succ√®s !</p>
<h2 id="compilation-√†-la-mano"><a class="header" href="#compilation-√†-la-mano">Compilation √† la mano</a></h2>
<p>Tu peux aussi compiler √† la main (pratique parfois).</p>
<p>Pour cela, une fois √† la racine du projet, ex√©cute :</p>
<pre><code>cargo build --release --features = "primary" 
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pour-flasher-une-carte"><a class="header" href="#pour-flasher-une-carte">Pour flasher une carte</a></h1>
<p>Commences par c√¢bles un ST-LINK sur la carte. Sur l'image c'est une blue-pill, mais l'ordre des pins et le c√¢blage est le m√™me !</p>
<p><img src="pre_2021/elec_soft/mise_en_place/../../images/elec_soft/F103C8T6_w_ST-Link.jpg" alt="test" />
Une fois c√¢bl√©, lances OpenOCD √† la racine du projet :</p>
<pre><code>sudo openocd -f black_pill.cfg
</code></pre>
<p>Si le ST-LINK a √©t√© bien c√¢bl√©, alors OpenOCD devrait rester ouvert en tache de fond.</p>
<p>Une fois openocd en t√¢che de fond, il suffit de lancer dans un terminal le script <code>debug.sh</code> qui se trouve dans le dossier du projet pour flasher la carte.</p>
<h2 id="precautions-pour-le-deboggage"><a class="header" href="#precautions-pour-le-deboggage">Precautions pour le deboggage</a></h2>
<ul>
<li>Ne pas poser de cartes non vernies directement sur l'armature m√©tallique du robot, cela peut cr√©er des court-circuits dans la carte et l'endommager !</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="apprendre-rust"><a class="header" href="#apprendre-rust">Apprendre Rust</a></h1>
<p>Pour apprendre Rust, en parall√®le avec la formation le mieux reste de lire <a href="https://doc.rust-lang.org/book/second-edition/">The Rust Book</a> (deuxi√®me √©dition). Il s'agit du meilleur moyen d'apprendre le langage, mais ce n'est pas le seul.</p>
<p>Voici une liste de ressources non exhaustive qui te servira peut √™tre un jour :</p>
<ul>
<li><a href="https://rust-embedded.github.io/book/">The Embedded Rust Book</a> : Un bouquin expliquant comment fonctionne l'embarqu√© et la programmation sur microcontr√¥leur en Rust. <strong>Tr√®s bonne lecture</strong> :)</li>
<li><a href="http://rustbyexample.com/">Rust by example</a> : Une collection d'exemples permettant de comprendre les concepts du langage, tr√®s bonne lecture en compl√©ment de <em>The Rust Book</em>.</li>
<li><a href="https://doc.rust-lang.org/book/">The Rust Book v1</a> : A lire si le chapitre que tu cherches n'est pas dans la v2. Le livre n'est pas obsol√®te, mais il est moins bien que la v2.</li>
<li><a href="https://rust-lang-nursery.github.io/rust-cookbook/">The Cookboook</a> : Un livre de <em>recettes</em> pour des op√©rations classiques.</li>
<li><a href="https://doc.rust-lang.org/std/">La documentation de la librairie standard</a> : La r√©f√©rence de toutes les fonctions/structures/traits/m√©thodes de la librairie standard.</li>
</ul>
<p>Il existe aussi une s√©rie de posts de blogs, c'est toujours pratique pour apprendre surtout quand c'est en Fran√ßais :</p>
<ul>
<li><a href="http://blog.guillaume-gomez.fr/Rust">Tutoriel Rust</a> - Guillaume Gomez</li>
<li><a href="https://levans.fr/borrowing-and-lifetimes-in-rust-fr.html">Les emprunts et les dur√©es de vies en Rust</a> - Victor Berger</li>
<li><a href="https://github.com/Songbird0/Rust_FAQ">Retrouvez un grand nombre de Questions/R√©ponses dans cette FAQ d√©di√©e √† rust !</a> - Anthony Defranceschi/Songbird0</li>
<li><a href="https://github.com/Songbird0/FR_RBE">Traduction fran√ßaise du livre Rust by example</a> - Anthony Defranceschi/Songbird0</li>
</ul>
<p>Enfin il y a une <a href="https://github.com/ctjhoa/rust-learning">page github</a> qui recense encore plus de ressources que tu peux toujours consulter.</p>
<p>Pour la programmation embarqu√©e il y a aussi de la documentation, la plupart est recens√©e sur <a href="https://github.com/rust-embedded/awesome-embedded-rust">awesome-embedded</a>.</p>
<p>Il y enfin quelques posts de blogs bien pratiques, ainsi que de la documentation de certaines librairies :</p>
<ul>
<li><a href="https://japaric.github.io/discovery/">Une s√©rie de post d'introduction sur un stm32discovery</a> - Japaric</li>
<li><a href="http://blog.japaric.io/quickstart/">Un post qui date des d√©buts de Rust sur microcontrolleur</a> - Japaric</li>
<li><a href="http://blog.japaric.io/fearless-concurrency/">Introduction au framework RTFM</a> - Japaric</li>
<li><a href="http://blog.japaric.io/rtfm-v2/">Evolution du framework RTFM</a> - Japaric</li>
<li><a href="https://docs.rs/cortex-m-quickstart/0.3.1/cortex_m_quickstart/">La description de la librairie <code>cortex-m-quickstart</code></a></li>
<li><a href="https://docs.rs/embedded-hal/0.2.1/embedded_hal/">La description de la librairie <code>embedded-hal</code></a></li>
</ul>
<h1 id="aide"><a class="header" href="#aide">Aide</a></h1>
<p>Tu as besoin d'aide ?
Le meilleur moyen de r√©soudre ton probl√®me est d'aller sur le chan <strong>#rust-beginners</strong> sur le <a href="pre_2021/elec_soft/irc.mozilla.org">serveur IRC</a> de Mozilla.
Si tu n'as pas de client IRC, tu peux aussi passer par une <a href="https://client00.chat.mibbit.com/?server=irc.mozilla.org&amp;channel=%23rust-beginners">interface web</a>.</p>
<p>Pour des questions plus complexes, tu peux aussi poster sur <a href="https://www.reddit.com/">reddit</a> ou demander aux gens du club ! :wink:</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="communication-des-modules-avec-linformatique"><a class="header" href="#communication-des-modules-avec-linformatique">Communication des modules avec l'informatique</a></h1>
<p>L'informatique et l'√©lectronique doivent se mettre d'accord sur les trames envoy√©es pour communiquer.</p>
<p>Un r√©seau RJ45 est d√©ploy√© dans le robot et chaque carte poss√®de sa propre IP en <code>192.168.1.ID_CARTE</code> si il s'agit du robot primaire ou en <code>192.168.2.ID_CARTE</code> si il s'agit du robot secondaire.</p>
<p>Le PC embarqu√© poss√®de une adresse au m√™me format (192.168.X.254). Typiquement, la carte d√©placement du second robot poss√®de l'adresse 192.168.2.1.</p>
<p>L'informatique s‚Äôattend √† recevoir les informations de la carte <code>ID_CARTE</code> sur le port 5000 + ID_CARTE. Cette m√™me carte √©coute sur le port 50 + ID_CARTE.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="electronique-mat√©rielle-1"><a class="header" href="#electronique-mat√©rielle-1">Electronique mat√©rielle</a></h1>
<p>Cette section est r√©serv√©e √† l'√©lectronique mat√©rielle au club robot. Ici tu apprendras le n√©cessaire pour atteindre le but ultime de tout √©lectronicien au club : produire des cartes √©lectroniques qui</p>
<ul>
<li>Ne prennent pas feu</li>
<li>Actionnent des moteurs</li>
<li>Exploitent des mesures de capteurs</li>
</ul>
<p>Les trois ressources principales en plus de cette doc sont :</p>
<ol>
<li><a href="https://openclassrooms.com/fr/courses/724810-lelectronique-de-zero">Openclassrooms</a> : Tu y trouveras un cours d'√©lectronique g√©n√©rale, plut√¥t clair. C'est un tr√®s bon point de d√©part avant de se plonger dans le robot.</li>
<li>Le <a href="http://www.falstad.com/circuit/">simulateur de circuit Falstad</a> : Rapide √† prendre en main pour simuler et mieux comprendre des circuits usuel. Je te recommande <strong>tres</strong> fortement d'y faire un tour rapide maintenant pour voir ce que tu peux faire avec. Son alternative professionelle est LTSpice.</li>
<li>La <a href="https://archipel-univtoulouse.hosted.exlibrisgroup.com/primo-explore/fulldisplay?docid=33TOUL_ALMA21413566170004116&amp;context=L&amp;vid=33INSA_VU1&amp;lang=fr_FR&amp;search_scope=default_scope&amp;adaptor=Local%20Search%20Engine&amp;isFrbr=true&amp;tab=default_tab&amp;query=any,contains,Syst%C3%A8mes%20%C3%A9lectroniques%20analogiques%20Amplification%20%20Filtrage%20et%20optronique&amp;sortby=date&amp;facet=frbrgroupid,include,102068340&amp;mode=Basic&amp;offset=0">Bible</a>, r√©dig√©e par nos professeurs d'√©lectronique favoris. C'est une tr√®s bonne r√©f√©rence quand tu as envie d'en savoir plus sur un d√©tail qui n'est pas assez ou mal expliqu√© en cours ou sur openclassrooms. Un exemplaire est disponible en lecture au Club, et il est facile √† trouver dans nos BUs (cf. lien ci-dessus).</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mise-en-place-3"><a class="header" href="#mise-en-place-3">Mise en place</a></h1>
<p>Installons les logiciels pour router des cartes √©l√©ctroniques ! Au club robot nous utilisons <a href="https://en.wikipedia.org/wiki/KiCad">KiCad</a>. Certains d'entre vous connaissent peut √™tre Eagle mais la version Linux de ce dernier n'est pas au point du tout. De plus c'est un logiciel payant (on peut certes avoir des licenses √©tudiantes) alors que KiCad est un logiciel libre.</p>
<h1 id="installation-de-kicad"><a class="header" href="#installation-de-kicad">Installation de Kicad</a></h1>
<p>Tu peux installer KiCad sur les trois principaux OS : Ubuntu, Windows et OSX. Il faut faire attention √† bien installer la version 5 !</p>
<p>Pour les autres distributions Linux demande directement aux gens du club !</p>
<h2 id="linux"><a class="header" href="#linux">Linux</a></h2>
<h3 id="ubuntu"><a class="header" href="#ubuntu">Ubuntu</a></h3>
<p>Il suffit de rentrer les trois commandes suivantes pour obtenir la derni√®re version de Kicad (Kicad 5) :</p>
<p>** A Verifier **</p>
<pre><code class="language-bash">sudo add-apt-repository --yes ppa:js-reynaud/kicad-5
sudo apt update
sudo apt install kicad
</code></pre>
<p>Ces commandes sont n√©cessaires car on utilise la version 5 de Kicad qui est encore en beta.</p>
<p>Tu peux v√©rifier que l'installation a bien fonctionn√© en lan√ßant Kicad. Normalement KiCad est livr√© avec des librairies de composants. Si elles ne sont pas install√©es chez toi, rapproche-toi d'un membre du club !</p>
<h3 id="osx"><a class="header" href="#osx">OSX</a></h3>
<p>Il existe deux m√©thodes pour installer Kicad sur un Mac. La classique en allant sur http://kicad-pcb.org/download/osx/, puis en telechargeant la derni√®re version stable, ou avec Homebrew.</p>
<p>Homebrew et fonctionne √† peu pr√®s comme aptitude sur Linux. C'est un tr√®s bon outil qui permet d'installer facilement beaucoup d'applications disponibles sur Linux mais pas nativement sur mac (comme wget par exemple). Je profite juste de l'installation de Kicad pour pr√©senter cet outil tr√®s utile.
N'h√©site pas √† faire un tour sur leur site pour en savoir plus, je ne parlerai ici que du n√©c√©ssaire pour installer Kicad.</p>
<p>https://brew.sh/index_fr</p>
<p>Pour installer homebrew, il suffit d'executer cette ligne dans un terminal :</p>
<pre><code class="language-bash">/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
</code></pre>
<p>Cette ligne t√©l√©charge et √©x√©cute l'installeur pour Brew. Laisse-toi guider, il d√©crit ce qu'il fait au fur et a mesure de l'installation.</p>
<p>Une fois l'install termin√©e, il faut installer une extension de Brew appell√©e 'cask'. Elle permet d'installer proprement des applicaitons en passant par le t√©l√©chargement et la v√©rification du .app.</p>
<pre><code class="language-bash">brew install cask
</code></pre>
<p>Tout est pr√™t ! Il ne reste plus qu'√† installer la derni√®re version de Kicad. Attention le t√©l√©chargement est lourd (3GB environ).</p>
<pre><code class="language-bash">brew cask install kicad
</code></pre>
<p>Kicad est d√©sormais correctement install√© sur ton ordinateur et peut s'utiliser comme n'importe quelle autre application.
Il est recommand√© d'installer ses apps avec Homebrew autant que possible. Pour savoir si une app est disponible sur leurs d√©p√¥ts, utilise</p>
<pre><code class="language-bash">brew search [nom √† rechercher]
</code></pre>
<p>Si brew trouve des r√©sultats, un simple  <code>brew install [nom trouv√©]</code> se chargera de l'installation.</p>
<h3 id="windows"><a class="header" href="#windows">Windows</a></h3>
<p>Il suffit de r√©cup√©rer et lancer l'installeur le plus r√©cent parmis tout ceux propos√©s sur <a href="http://downloads.kicad-pcb.org/windows/nightly/">cette</a> page.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="organisation-1"><a class="header" href="#organisation-1">Organisation</a></h1>
<h2 id="organisation-des-dossiers"><a class="header" href="#organisation-des-dossiers">Organisation des dossiers</a></h2>
<p>Voici une arborescence typique d'un dossier de travail en cours d'ann√©e :</p>
<pre><code>hardware
‚îú‚îÄ‚îÄ boards
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ pump_2019_f103
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ servo_2019_f103
‚îú‚îÄ‚îÄ digikey-kicad-library
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ digikey-footprints.pretty
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ digikey-symbols
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ src
‚îî‚îÄ‚îÄ libkicad-robot
    ‚îú‚îÄ‚îÄ @Robot_symbols 
    ‚îú‚îÄ‚îÄ @Robot.3D
    ‚îú‚îÄ‚îÄ @Robot.pretty
    ‚îú‚îÄ‚îÄ datasheets
    ‚îú‚îÄ‚îÄ projets communs
 ¬†¬† ‚îî‚îÄ‚îÄ libeagle-robot

</code></pre>
<p>On y retrouve 3 dossiers :</p>
<ul>
<li>les cartes en cours de travail (le dossier <code>boards</code>)</li>
<li>la librairie du club (le dossier <code>kicad</code>)</li>
<li>la librairie de digikey (le dossier <code>digikey-kicad-library</code>)</li>
</ul>
<h3 id="dossier-boards"><a class="header" href="#dossier-boards">Dossier <code>boards</code></a></h3>
<p>Dans ce dossier, il y a pour chaque carte un dossier avec comme nom <code>&lt;fonction&gt;_&lt;ann√©e de la coupe&gt;_&lt;¬µc&gt;</code> √©crit en <a href="https://fr.wikipedia.org/wiki/Snake_case">snake_case</a>. Dans le dossier de la carte on retrouve :</p>
<ul>
<li>le projet kicad, un fichier <code>.pro</code></li>
<li>le schematic de la carte, un fichier <code>.sch</code></li>
<li>le routage de la carte, un fichier <code>.pcb</code>
NB : la liste des cartes est accessible dans les references de ce chapitre.</li>
</ul>
<h3 id="dossier-libkicad-robot"><a class="header" href="#dossier-libkicad-robot">Dossier <code>libkicad-robot</code></a></h3>
<p>On retrouve 6 dossiers importants dans celui-ci :</p>
<ul>
<li>Trois dossiers <code>@Robot</code> : les librairies de composants propres au Club</li>
<li><code>datasheets</code> : les datasheets des composants du club et autres documents importants</li>
<li><code>projets communs</code> :  des cartes et des blocs √©l√©mentaires qui servent de base aux projets</li>
<li><code>libeagle-robot</code> : les anciennes librairies du Club</li>
</ul>
<h2 id="organisation-des-projets-git"><a class="header" href="#organisation-des-projets-git">Organisation des projets git</a></h2>
<p>Chaque carte a un projet git unique afin de d√©coupler totalement les cartes du la librairie de symbole.</p>
<p>On peut ainsi utiliser l'onglet <strong>release</strong> pour uploader les typons, le plan d'implantation et le <em>bill of materials</em> afin de pouvoir retrouver toutes ces informations un jour.</p>
<p>L'onglet <strong>issue</strong> du repo sers √† suivre les probl√®mes et les choses √† faire sur la carte.</p>
<p>L'onglet <strong>projet</strong> permet de suivre l'avancement de la carte.</p>
<p>Par exemple pour la carte <a href="https://github.com/ClubRobotInsat/deplacement_2019_f103">deplacement_2019_f103</a> dans l'onglet <a href="https://github.com/ClubRobotInsat/deplacement_2019_f103/issues">issues</a> on retrouve les t√¢ches √† faire (si elles n'ont pas √©t√© toutes fa√Ætes).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation-de-la-librairie-et-des-projets-du-club-robot"><a class="header" href="#installation-de-la-librairie-et-des-projets-du-club-robot">Installation de la librairie et des projets du Club Robot</a></h1>
<p>Pour obtenir les composants du club afin de pouvoir ouvrir correctement les cartes que nous avons r√©alis√©e par le pass√©, il suffit de te pr√©parer un dossier conforme √† l'arborescence d√©crite dans la page pr√©c√©dente. Pour cela, il faut ouvrir un terminal, te placer l√† ou tu souhaites tout installer, et entrer ces commandes :</p>
<pre><code class="language-bash"># On construit l'arborescence
mkdir -pv hardware/boards
cd hardware
# On y clone les librairies du Club et de DigiKey
git clone https://github.com/ClubRobotInsat/libkicad-robot.git
git clone https://github.com/digikey/digikey-kicad-library.git
</code></pre>
<p>Ne ferme pas le terminal, on n'en a pas fini :)</p>
<p>Si tu n'as pas <code>git</code> sur ton ordinateur je te renvoie √† la section <a href="pre_2021/elec_mat/mise_en_place/git.html">correspondante</a>.</p>
<p>Il faut maintenant ouvrir un terminal et configurer <code>git</code> pour qu'il s'interface bien avec Kicad. Pour cela tu dois lancer le script <code>setup_git.sh</code> :</p>
<pre><code class="language-bash"># On se place dans le dossier o√π tu as clone le repo du club
cd kicad
# On lance le script
./setup_git.sh
</code></pre>
<p>Il faut ensuite rajouter ces librairies avec l'interface de Kicad.</p>
<h2 id="ajout-des-la-librairies-de-symboles-et-de-footprints"><a class="header" href="#ajout-des-la-librairies-de-symboles-et-de-footprints">Ajout des la librairies de symboles et de footprints</a></h2>
<ol start="0">
<li>Ouvre Kicad, puis ouvre <code>Preferences -&gt; Configure Paths...</code>. On va indiquer o√π Kicad doit chercher nos librairies. Normalement, tu obtiens une fen√™tre qui liste tous les <em>Paths</em> (chemins de fichiers, comme sur linux) g√©r√©s par Kicad. On va y ajouter le n√¥tre : clique sur <code>Add</code>, puis entre :</li>
</ol>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Value</th></tr></thead><tbody>
<tr><td>KIROBOT</td><td><code>Ton dossier **hardware**</code>/libkicad-robot</td></tr>
</tbody></table>
</div>
<ol>
<li>
<p>Ouvre ensuite l'√©diteur de symbole, pour cela clique sur le petit composant (deuxi√®me carr√© en partant de la gauche)</p>
<p><img src="pre_2021/elec_mat/mise_en_place/assets/kicad/open_symbol_editor.png" alt="Cliques sur le bouton rouge pour ouvrir l&#39;√©diteur de symbole" /></p>
</li>
<li>
<p>Ensuite, il faut rajouter la librairie contenant les <em>symboles</em> du club : <code>Preferences &gt; Manage Symbol Libraries</code>.
Dans le menu qui va s'ouvrir, clique sur <code>Browse Libraries</code> et navigue jusqu'au dossier <code>hardware/libkicad-robot/@Robot_symbols</code> et s√©l√©ctionne <code>@Robot.lib</code>
Normalement tu as le r√©sultat suivant √† la fin de cette op√©ration.
<img src="pre_2021/elec_mat/mise_en_place/assets/kicad/symbol_added.png" alt="La librairie de symboles apr√®s ajout des symboles du club robot" />
Si tu observes la m√™me chose alors tu as r√©ussi ton installation ! Tu peux maintenant ouvrir les <em>schematic</em> du club robot sans probl√®me !</p>
</li>
<li>
<p>Tu peux fermer l'√©diteur de symbole et passer sur l'√©diteur de <em>footprint</em>, c'est le quatri√®me bouton en partant de la gauche.
<img src="pre_2021/elec_mat/mise_en_place/assets/kicad/open_footprint_editor.png" alt="Cliques sur le bouton rouge pour ouvrir l&#39;√©diteur de footprint" /></p>
</li>
<li>
<p>Ouvre le gestionnaire de librairie <code>Preferences &gt; Manage footprint libraries</code> et cliques sur <code>Browse Libraries</code> dans la fen√™tre qui s'ouvre.</p>
</li>
<li>
<p>Navigue jusqu'√† arriver au r√©pertoire <code>hardware/libkicad-robot/@Robot.pretty</code> et clique sur Ok.</p>
</li>
<li>
<p>Normalement tu devrais obtenir le r√©sultat suivant :
<img src="pre_2021/elec_mat/mise_en_place/assets/kicad/footprint_added.png" alt="La librairie de footprints apr√©s ajout de celle du club" /></p>
</li>
<li>
<p>R√©p√®te les op√©rations 1 √† 6 pour ajouter √† KiCAD n'importe quelle source externe de composants. Nous utilisons aussi ponctuellement les librairies offertes par DigiKey (distributeur de composants √©lec en ligne). Importe leurs libs dans <code>hardware/digikey-kicad-library</code> (<em>ctrl-a</em> te sera utile pour les symbols).</p>
</li>
<li>
<p>Si tout s'est bien pass√© <strong>BRAVO</strong> tu peux maintenant ouvrir et modifier toutes les cartes du club robot et cr√©er les tiennes !</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="guide-dutilisation-de-kicad"><a class="header" href="#guide-dutilisation-de-kicad">Guide d'utilisation de Kicad</a></h1>
<h2 id="intro"><a class="header" href="#intro">Intro</a></h2>
<p>On parlera ici de l'utilisation de KiCAD sp√©cifique au club. Pour l'utilisation g√©n√©rale, consulte la doc inclue dans KiCAD, dans le menu aide/help. Elle est claire, et tr√®s bien compl√©t√©e sur internet par une s√©rie de vid√©os produites par <a href="https://www.youtube.com/watch?v=vaCVh2SAZY4&amp;index=9&amp;list=PLEBQazB0HUyR24ckSZ5u05TZHV9khgA1O&amp;t=0s">DigiKey</a>.</p>
<p>La r√©alisation d'une carte suit le <img src="pre_2021/elec_mat/../images/kicad/kicad_flowchart.png" alt="workflow" /> indiqu√© dans la doc de kicad.</p>
<h2 id="ouverture-dune-carte"><a class="header" href="#ouverture-dune-carte">Ouverture d'une carte</a></h2>
<p>Quand tu souhaites visualiser ou modifier une carte, ouvre (double clic) son fichier projet (.pro) ou ouvre directement son schematic avec kicad. Il se peut que des symboles soient 'cass√©s' : ils sont remplac√©s par les points d'interrogation. Dans ce cas, √©dite les : clic droit -&gt; properties -&gt; edit properties et choisis 'change' sous le champ 'Library Symbol'. Remplace alors le symbole par sa version √† jour. Si tu ne le trouve nulle part, v√©rifie si tu as bien import√© les librairies du club, et celles offertes par DigiKey.</p>
<h2 id="cr√©ation-dune-carte"><a class="header" href="#cr√©ation-dune-carte">Cr√©ation d'une carte</a></h2>
<p>Pour cr√©er une carte, il faut suivre <em>m√©ticuleusement</em> le protocole suivant pour √™tre certain de ne pas imprimer de carte inutilisable, ou juste trop difficile √† imprimer.</p>
<p><strong>1) Pose toi la question de quel template utiliser.</strong></p>
<p>Pour le moment le club n'en a qu'un seul pour une carte classique avec une blackpill et un USR-US1 (le connecteur ethernet) dessus. Copie donc le template <code>libkicad-robot/templates/carte_generique_2019_stm32f103</code> dans ton dossier <code>boards</code>. et renomme le dossier et les fichiers en suivant cette convention :</p>
<pre><code>boards
‚îú‚îÄ‚îÄ {fonction}_{ann√©e}_{microcontr√¥leur}
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ {fonction}_{ann√©e}_{microcontr√¥leur}.pro
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ {fonction}_{ann√©e}_{microcontr√¥leur}.sch
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ {fonction}_{ann√©e}_{microcontr√¥leur}.kicad_pcb
</code></pre>
<p>Dans la mesure du possible, tous les noms <em>sont_en_minuscules_s√©par√©s_par_des_underscores</em> (convention snake_case).</p>
<p><strong>2) Pr√©paraion du schematic</strong></p>
<p>Dans un premier temps, il faut remplir l'encadr√© en bas √† droite avec l'insertion de texte, c'est √† dire remplir les champs en gras (nom, pr√©nom, date, titre de la carte). La date sera actualis√©e √† chaque grosse mise √† jour.
Chaque fichier et chaque carte doit √™tre tracable en cas de besoin. Ceux qui reprendront ta carte quand tu auras quitt√© le club doivent avoir quelqu'un √† qui poser les questions !</p>
<p><strong>3) Pr√©paration du routage</strong></p>
<p>Ouvre maintenant le pcb de ta nouvelle carte et <strong>VERIFIE LES DESIGN RULES</strong>. Il va falloir bien suivre, la suite est tr√®s importante et te fera gagner <em>beaucoup</em> de temps. \n Un peu de contexte : plus une piste est large, plus elle peut conduire du courant sans chauffer. Une piste qui chauffe, ca veut dire des soudures qui fondent ou des composants qui grillent. Mais plus une piste est large, plus le routage sera difficile. Le nouveau jeu est donc de dimensionner chaque piste en fonction de son utilisation : pistes fines pour du signal, pistes larges pour la puissance.</p>
<p>Pour cela, la solution id√©ale serait justement de pouvoir indiquer √† KiCAD quelles connexions seront utilis√©es pour de la logique, et quelles connexions feront passer des gros courants. Ca tombe bien ! <em>Setup -&gt; Design rules...</em> √† √©t√© invent√© pour ca. C'est un processus en deux √©tapes.</p>
<ul>
<li>
<p>D'abord on remplit le tableau 'Net classes'. On indique √† KiCAD la liste des diff√©rents types de connexion.
La plupart du temps nous n'aurons que des pistes logiques. Tant qu'il n'y a pas de puissance, change la classe <code>default</code>en y entrant 0.381 dans <code>Clearance</code> et 0.381 dans <code>Track Width</code>.</p>
</li>
<li>
<p>Ouvre ensuite l'onglet <code>Global Design Rules</code> et remplis le tableau (en bas √† droite) :</p>
</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th></th><th>Width</th></tr></thead><tbody>
<tr><td>Track 1</td><td>0.254</td></tr>
<tr><td>Track 2</td><td>0.381</td></tr>
<tr><td>Track 3</td><td>0.762</td></tr>
</tbody></table>
</div>
<p>Ce sont les trois √©paisseurs <em>standard</em> qu'utilise le club. Quand tu choisiras ton √©paisseur de piste (en haut √† gauche de l'interface de pcbnew), tu devras utiliser la 3 quand c'est possible, puis la 2 si n√©c√©ssaire, puis la 1 <strong>sur une distance tr√®s courte</strong> dans le pire des cas.</p>
<p>Pour finir, il faut remplir compl√©ter le texte √† l'envers (nom, pr√©nom, date, titre de la carte). Il sert √† rendre ta carte encore mieux tracable, et √† aider √† l'imprimer √† l'endroit.</p>
<p>En principe, tout est pr√™t pour que tu commences √† ajuster le schematic puis √† dessiner le PCB toi-m√™me. Le chapitre suivant donne des indications et explique le fonctionnement de certains outils usuels.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="conseils--astuces-pour-r√©ussir-sa-carte"><a class="header" href="#conseils--astuces-pour-r√©ussir-sa-carte">Conseils &amp; Astuces pour r√©ussir sa carte</a></h1>
<h2 id="organisation-et-clart√©-su-schematic"><a class="header" href="#organisation-et-clart√©-su-schematic">Organisation et clart√© su schematic</a></h2>
<p>La r√®gle d'or lors du dessin d'un schematic est la <strong>lisibilit√©</strong> ! Comme il ne repr√©sente rien en r√©alit√©, il faut qu'il soir le plus lisible possible, et le plus facile √† modifier !
Deux outils sont indispensables √† maitriser (pas de vraie difficult√©) :</p>
<h3 id="place-graphic-lines-or-polygons"><a class="header" href="#place-graphic-lines-or-polygons">"Place graphic lines or polygons"</a></h3>
<p>Il te permet d'encadrer chaque partie de ton circuit. On cherche en g√©n√©ral √† l'organiser (donc diviser) en fonctions √©l√©mentaires. Par exemple, tous les connecteurs de puissance seront √† un endroit, toutes les led dans un autre, le microcontroleur sera au centre etc... Chaqun de ces bloc-fonction doit √™tre encadr√© et nomm√© avec l'outil "Place text".</p>
<h3 id="place-net-label"><a class="header" href="#place-net-label">"Place net label"</a></h3>
<p>Il est l'heure de te pr√©senter ton nouvel outil favori. Petit retour th√©orique : le potentiel √©lectrique (tension par rapport √† la masse, ou 'altitude electrique') est le m√™me le long d'un fil. C'est toujours valable si deux fils sont connect√©s ! Ils forment alors un <strong>noeud</strong> (de fils), ou <strong>net</strong> en anglais. On comprend alors que le potentiel electrique est le m√™me partout sur un noeud donn√© ! L'√©quivalent <strong>noeud &lt;=&gt; potentiel</strong> nous permet de nommer une connexion entre plusieurs parties du circuit : c'est le <strong>net label</strong>. L'opportunit√© est fantasique : tu n'as plus besoin de connecter des composants avec des fils (ce sera brouillon rapidement), mais tu peux placer un <strong>net label</strong> (appel√© label par abus de language) sur chaque pin √† connecter, et ce peu importe leur nombre ! Cet outil nous permet de rendre invisible les fils entre les diff√©rents blocs : le schematic devient beaucoup plus clair !</p>
<h2 id="ordre-des-priorit√©s-pendant-le-routage"><a class="header" href="#ordre-des-priorit√©s-pendant-le-routage">Ordre des priorit√©s pendant le routage</a></h2>
<p>Pour commencer, il faut savoir ce que tu es en train de faire. Si tu est en train de cr√©er une carte pas tr√®s compliqu√©e, ce sera une <em>'simple face'</em>, sinon nous travaillerons en <em>'double face'</em>. La diff√©rence est qu'en double face tu pourras placer beaucoup plus de pistes qu'en simple face. Les faces sur lesquelles nous travailleront sont judicieusement nomm√©es Top et Bottom, donc recto et verso.</p>
<p>Deux rappels avant de commencer √† dessiner :</p>
<ul>
<li>Deux pistes sur une m√™me face ne peuvent pas se croiser</li>
<li>Les composants traversants ne sont jamais du m√™me c√¥t√© que les pistes auxquelles ils sont connect√©s, sinon ils seront impossibles √† souder !</li>
</ul>
<p>Par d√©faut, place les <strong>composants traversants</strong> au <strong>TOP</strong> et les <strong>pistes et cms</strong> au <strong>BOTTOM</strong>.</p>
<h2 id="placement-des-composants"><a class="header" href="#placement-des-composants">Placement des composants</a></h2>
<p>Avant de connecter les composants, il faut les placer (<em>duh</em>). Il n'y a pas de r√®gle g√©n√©rale pour t'aider. Ca se fait tr√®s empiriquement. On commence au moins par placer les connecteurs et les led sur les bords de la carte. Dans la mesure du possible, il vaut mieux n'utiliser que deux arr√™tes oppos√©es : les entr√©es √† gauche du microcontroleur et les sorties √† droite. Tout sera plus simple pendant le c√¢blage. Fais comme tu l'entends, mais pense au futur utilisateur de ta carte : n'h√©site pas √† abuser du rendu 3D de ta carte pour de demander <em>comment tu peux rendre cette carte facile √† utiliser</em>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="faire-tirer-sa-carte"><a class="header" href="#faire-tirer-sa-carte">Faire tirer sa carte</a></h1>
<p>Nous avons trois m√©thodes disponibles pour faire imprimer des cartes.</p>
<p>Quand tu as ton masque en pdf, tu peux passer par le/la responsable √©lec pour le <strong>transmettre directement au GEI</strong>. Ils nous improment gratuitement nos cartes simple et double face en 24 √† 48h.</p>
<p>Si le temps presse, tu peux aussi <strong>aller directement au FabLab</strong> pour l'imprimer. Toute la proc√©dure y est tr√®s bien expliqu√©e l√†-bas dans un petit livret. N'h√©site <strong>jamais</strong> a demander de l'aide √† un membre du Club ou du FabLab : tirer une carte am√®ne √† manipuler des produits corrosifs.</p>
<p>Solution de dernier recours, nous avons quelquefois besoin de la <strong>commander sur internet</strong> (<a href="https://jlcpcb.com/">jlpcb</a> par exemple). Les cartes imprim√©es sont tr√®s propres et peuvent √™tre multicouches (plus de deux plans). Le prix est cependant plus √©lev√© qu'au FabLab, et les cartes mettent g√©n√©ralement longtemps √† venir.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="annexe--r√©f√©rences"><a class="header" href="#annexe--r√©f√©rences">Annexe : R√©f√©rences</a></h1>
<p>Ici tu trouveras des listes diverses √† consulter r√©guli√®rement lorsque tu travailles sur du hardware.
Pour le moment, cette annexe contient une liste des composants fr√©quement utilis√©s ainsi que l'ensemble des cartes √©lectroniques r√©alis√©es ou achet√©es par le Club.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="utilisation-du-module-ethernet"><a class="header" href="#utilisation-du-module-ethernet">Utilisation du module ethernet</a></h1>
<p>La communication entre la raspberry pi et les cartes se fait par ethernet (udp) depuis 2018.
Maintenant, la partie mat√©rielle de cette communication est bas√©e sur le connecteur <a href="https://www.usriot.com/download/ES1/USR-ES1-EN%20V1.3.pdf">USR-ES1</a> :</p>
<p><img src="pre_2021/elec_mat/references/../../images/components/USR-ES1_pinout.png" alt="Module Ethernet" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="annexe--liste-des-cartes-du-club"><a class="header" href="#annexe--liste-des-cartes-du-club">Annexe : liste des cartes du Club</a></h1>
<p>Voici la liste des cartes que nous avons au Club, utilis√©es ou non.</p>
<div class="table-wrapper"><table><thead><tr><th>Nom</th><th>Fonction</th><th>Statut</th><th>Stock</th><th>Lien</th></tr></thead><tbody>
<tr><td>Pompes</td><td>Contr√¥ler les pompes √† vide</td><td>En d√©veloppement</td><td>0</td><td><a href="https://github.com/ClubRobotInsat/pump_2019_f103.git">github</a></td></tr>
<tr><td>Servomoteurs</td><td>Communiquer avec et alimenter les herkulex</td><td>En d√©veloppement</td><td>0</td><td><a href="https://github.com/ClubRobotInsat/servo_2019_f103">github</a></td></tr>
<tr><td>Alim</td><td>Alimenter le robot de mani√®re s√©curis√©e</td><td>Active</td><td>2</td><td><a href="https://svn.etud.insa-toulouse.fr/roboinsat/elec/CarteAlimentation/">svn</a></td></tr>
<tr><td>Alim Raspi</td><td>Alimenter la Raspi de mani√®re s√©curis√©e et ind√©pendante du robot</td><td>Active</td><td>1</td><td></td></tr>
<tr><td>Shield</td><td>Attacher proprement la nucl√©o au robot, permettre de ne pas utiliser ses jumpers directement</td><td>En refonte</td><td>1</td><td></td></tr>
<tr><td>Pont H</td><td>Alimenter et contr√¥ler les moteurs DC</td><td>Active</td><td>6</td><td></td></tr>
<tr><td>Evitement</td><td>Asservir le moteur de la tourelle</td><td>Obsol√®te</td><td>1</td><td></td></tr>
<tr><td>D√©placement</td><td>Controler les moteurs de d√©placement</td><td>En refonte</td><td>1</td><td><a href="https://github.com/ClubRobotInsat/deplacement_2019_f103">github</a></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="annexe--liste-des-composants-utilis√©s"><a class="header" href="#annexe--liste-des-composants-utilis√©s">Annexe : liste des composants utilis√©s</a></h1>
<p>Voici une liste <strong>non exhaustive</strong> des composants qu'utilise le club.
N'h√©sitez pas √† la mettre √† jour !</p>
<h2 id="connectique"><a class="header" href="#connectique">Connectique</a></h2>
<h3 id="pinsocket-et-pinheaders"><a class="header" href="#pinsocket-et-pinheaders">Pinsocket et pinheaders</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Nom commun</th><th>R√©f√©rence</th><th>Notes</th></tr></thead><tbody>
<tr><td>Pinsocket</td><td><a href="http://suddendocs.samtec.com/catalog_english/ssw_th.pdf">Liste</a></td><td>Fixer de mani√®re r√©versible la nucl√©o √† la carte shield</td></tr>
<tr><td>Pinsocket s√©cable</td><td>BL1.36Z</td><td>Pinsocket de n'importe quelle longueur.</td></tr>
</tbody></table>
</div>
<h3 id="connexion-carte-√†-fil"><a class="header" href="#connexion-carte-√†-fil">Connexion carte √† fil</a></h3>
<h4 id="he14"><a class="header" href="#he14">HE14</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Nom commun</th><th>R√©f√©rence</th><th>Notes</th></tr></thead><tbody>
<tr><td>Connecteur Phoenix 2</td><td><a href="https://fr.farnell.com/phoenix-contact/1725656/bornier-sur-ci-2v-2-54mm/dp/3041359">1725656</a></td><td>Tr√®s fiables, 2 terminaux</td></tr>
<tr><td>Connecteur Phoenix 3</td><td><a href="https://fr.farnell.com/phoenix-contact/1725656/bornier-sur-ci-2v-2-54mm/dp/3041359">1725669</a></td><td>Tr√®s fiables, 3 terminaux</td></tr>
<tr><td>Connecteur Phoenix 5</td><td><a href="https://fr.farnell.com/phoenix-contact/1725656/bornier-sur-ci-2v-2-54mm/dp/3041359">2776439</a></td><td>Tr√®s fiables, 5 terminaux</td></tr>
<tr><td>HE14-f3</td><td>189-9441 (<a href="https://fr.rs-online.com">RS</a>)</td><td></td></tr>
<tr><td>HE14-f2</td><td>189-9435 (<a href="https://fr.rs-online.com">RS</a>)</td><td></td></tr>
<tr><td>HE14-m5</td><td>230-5082 (<a href="https://fr.rs-online.com">RS</a>)</td><td></td></tr>
<tr><td>HE14-m3</td><td>230-5060 (<a href="https://fr.rs-online.com">RS</a>)</td><td></td></tr>
<tr><td>HE14-m2</td><td>230-5054 (<a href="https://fr.rs-online.com">RS</a>)</td><td></td></tr>
</tbody></table>
</div>
<h3 id="autres"><a class="header" href="#autres">Autres</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Nom commun</th><th>R√©f√©rence</th><th>Notes</th></tr></thead><tbody>
<tr><td>Terminal Batterie vert</td><td></td><td></td></tr>
<tr><td>Connecteur MXS</td><td></td><td></td></tr>
</tbody></table>
</div>
<h2 id="puissance"><a class="header" href="#puissance">Puissance</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Nom commun</th><th>R√©f√©rence</th><th>Notes</th></tr></thead><tbody>
<tr><td>Bouton ARU</td><td></td><td>Contr√¥ler l'alim du robot</td></tr>
<tr><td>R√©gulateur logique</td><td>PTH08080W</td><td>Passer de Vbat √† 5v</td></tr>
<tr><td>Buck r√©glable</td><td>LM2576</td><td>Diminuer Vbat, utilis√© pour avoir les 7.4V des herkulex</td></tr>
<tr><td>Gros interrupteur</td><td>MR02</td><td></td></tr>
<tr><td>Petit interrupteur</td><td></td><td></td></tr>
<tr><td>Fusible automobile</td><td></td><td></td></tr>
<tr><td>Fusible tube</td><td></td><td></td></tr>
</tbody></table>
</div>
<h2 id="microcontr√¥leurs"><a class="header" href="#microcontr√¥leurs">Microcontr√¥leurs</a></h2>
<h2 id="communication-2"><a class="header" href="#communication-2">Communication</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Nom commun</th><th>R√©f√©rence</th><th>Notes</th></tr></thead><tbody>
<tr><td>Transcriever CAN</td><td>MCP2551</td><td></td></tr>
<tr><td>Recepteur IR</td><td>HR12020104</td><td></td></tr>
<tr><td>Magn√©tom√®tre</td><td>HMC 5883L</td><td></td></tr>
<tr><td>Acc√©l√©rom√®tre 3 axes</td><td>MPU-6050</td><td></td></tr>
<tr><td>Module XBee</td><td>4214A-XBee</td><td></td></tr>
</tbody></table>
</div>
<h2 id="capteurs-1"><a class="header" href="#capteurs-1">Capteurs</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Nom commun</th><th>R√©f√©rence</th><th>Notes</th></tr></thead><tbody>
<tr><td>Webcam</td><td>COMedia 3088</td><td></td></tr>
<tr><td>Detecteur IR</td><td>SHARP</td><td></td></tr>
<tr><td>Gros bouton poussoir</td><td></td><td></td></tr>
<tr><td>Petit bouton poussoir</td><td></td><td></td></tr>
</tbody></table>
</div>
<h1 id="cms"><a class="header" href="#cms">CMS</a></h1>
<h2 id="r√©sistances"><a class="header" href="#r√©sistances">R√©sistances</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Nom</th><th>Valeur</th><th style="text-align: center">Package 0805</th><th style="text-align: center">Package 1206</th></tr></thead><tbody>
<tr><td>R√©sistance</td><td>0 R</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>47 R</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>50 R</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>100 R</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>150 R</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>169 R</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>220 R</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>240 R</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>300 R</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>330 R</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>348 R</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>470 R</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>499 R</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>620 R</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>1 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>1,2 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>1,5 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>2,2 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>2,26 kR</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>2,8 kR</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>3,3 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>4,3 kR</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>4,7 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>6,8 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>8,2 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>10 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>11,5 kR</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>12 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>15 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>20 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>22 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>33 kR</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>39 kR</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>43 kR</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>47 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>68 kR</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>75 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>100 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>180 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>200 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>250 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>470 kR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>R√©sistance</td><td>1 MR</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>R√©sistance</td><td>2,2 MR</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
</tbody></table>
</div>
<h2 id="condensateurs"><a class="header" href="#condensateurs">Condensateurs</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Valeur</th><th style="text-align: center">Package 0805</th><th style="text-align: center">Package 1206</th></tr></thead><tbody>
<tr><td>22 pf</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>560 pf</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>1 nf</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>1,2 nf</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>2,2 nf</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>4,7 nf</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>10 nf</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>12 nf</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>12 nf</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>90 nf</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"></td></tr>
<tr><td>100 nf</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>220 nf</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>470 nf</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>920 nf</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>1 ¬µf</td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
<tr><td>10 ¬µf</td><td style="text-align: center"></td><td style="text-align: center"><img src="pre_2021/elec_mat/references/../../images/icons/green_tick.png" alt="X" /></td></tr>
</tbody></table>
</div>
<h2 id="autres-1"><a class="header" href="#autres-1">Autres</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Nom</th><th style="text-align: center">Package</th><th style="text-align: center">Quantit√©</th><th style="text-align: left">Autres</th></tr></thead><tbody>
<tr><td>Led Jaune</td><td style="text-align: center">1206</td><td style="text-align: center">4</td><td style="text-align: left">2V</td></tr>
<tr><td>Led Vertes</td><td style="text-align: center">1206</td><td style="text-align: center">3</td><td style="text-align: left">2V</td></tr>
<tr><td>Led Rouges</td><td style="text-align: center">1206</td><td style="text-align: center">50+</td><td style="text-align: left">2V</td></tr>
<tr><td>Diode Rectif Schottk</td><td style="text-align: center">2512</td><td style="text-align: center">10+</td><td style="text-align: left">30v, 1A, ref SS13B</td></tr>
<tr><td>Diode Mesure courant</td><td style="text-align: center">1206</td><td style="text-align: center">3</td><td style="text-align: left">0.01R , ref LVK12RO10FER</td></tr>
<tr><td>Optocoupleur</td><td style="text-align: center">8SOIC</td><td style="text-align: center">5</td><td style="text-align: left">ref HCPL-06360-000E</td></tr>
<tr><td>Optocoupleur</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: left">ref H11D1</td></tr>
<tr><td>R√©sistance 0.1R</td><td style="text-align: center">2512</td><td style="text-align: center">20</td><td style="text-align: left">2W, 5%</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="cablage-du-robot"><a class="header" href="#cablage-du-robot">Cablage du Robot</a></h1>
<p>Pour le cablage de la carte d√©placement, il y a le sch√©ma suivant :</p>
<p><img src="pre_2021/elec_mat/../images/cablage_robot.png" alt="" title="Cablage du robot" /></p>
<p>Les conventions couleurs sont celles d√©crites sur le c√¥t√© des roues codeuses, n'h√©sitez pas √† vous y r√©ferer !</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="documents-de-r√©f√©rence"><a class="header" href="#documents-de-r√©f√©rence">Documents de r√©f√©rence</a></h1>
<p>Cette section contiens la documentation pour chaque carte electronique.</p>
<p>Cette documentation est compos√©e de :</p>
<ul>
<li>liste des composants sp√©ciaux et leur datasheet</li>
<li>format du protocole de communication</li>
</ul>
<p><a href="pre_2021/reference/reference/commun.html">Commun</a> contiens tout ce qui est commun √† toute les cartes.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="communs"><a class="header" href="#communs">Communs</a></h1>
<h1 id="sommaire-1"><a class="header" href="#sommaire-1">Sommaire</a></h1>
<ol>
<li><a href="pre_2021/reference/commun.html#communication">Communication</a></li>
<li><a href="pre_2021/reference/commun.html#microcontroleur">Microcontr√¥leur</a></li>
<li><a href="pre_2021/reference/commun.html#black-pill">Black-Pill</a></li>
<li><a href="pre_2021/reference/commun.html#quartz">Quartz</a></li>
</ol>
<h2 id="communication-3"><a class="header" href="#communication-3">Communication</a></h2>
<p>Pour la communication on utilise sur nos cartes un composants tout fait : le w5500.</p>
<p><a href="pre_2021/reference/../datasheets/w5500/w5500.pdf">Datasheet du w5500</a>.</p>
<p>Ce composant est mont√© sur une minicarte toute fa√Æte que l'on ach√®te chez <a href="https://www.makerfabs.com/Mini-Ethernet-Board-W5500.html">makerfabs</a>. (si le lien meurs, cherchez "mini ethernet board w5500").</p>
<p><img src="pre_2021/reference/../images/components/w5500.jpg" alt="Image de la mini carte" /></p>
<p><a href="pre_2021/reference/../datasheets/w5500/w5500_board_sizes.pdf">Dimension de la carte</a></p>
<p><a href="pre_2021/reference/../datasheets/w5500/w5500_board_schem.pdf">Schematic de la carte</a></p>
<p><img src="pre_2021/reference/../datasheets/w5500/w5500_board_pcb.png" alt="PCB de la carte" /></p>
<p>Cot√© logiciel, il existe une librairie sur <a href="https://crates.io/crates/w5500">crates.io</a>.</p>
<hr />
<h2 id="microcontroleur"><a class="header" href="#microcontroleur">Microcontroleur</a></h2>
<p>On utilise en ce moment le <a href="https://www.st.com/en/microcontrollers/stm32f103.html?querycriteria=productId=LN1565">stm32f103</a>.</p>
<p>Il viens en plusieurs d√©clinaisons (ce sont les lettres qui viennent derri√®re le nom du microcontr√¥leur). Les principales diff√©rences entre ces d√©clinaisons sont :</p>
<ul>
<li>Taille de la RAM</li>
<li>Taille de la flash</li>
<li>Nombre de timers</li>
</ul>
<p><a href="pre_2021/reference/../datasheets/stm32f103/f103_ref_manual.pdf">Manuel de r√©f√©rence de la famille des cortex M1</a></p>
<p><a href="pre_2021/reference/../datasheets/stm32f103/cortex_m1_ref_manual.pdf">Datasheet de la puce</a></p>
<hr />
<h2 id="black-pill"><a class="header" href="#black-pill">Black-Pill</a></h2>
<p>Pour le prototypage on utilise un <a href="pre_2021/reference/commun.html#microcontroleur">stm32f103</a> mont√© sur un PCB d√©j√† rout√©.
La carte s'appelle <a href="https://robotdyn.com/stm32-arm-arduino-mini-system-dev-board-blue-pill-with-arduino-bootloader.html">black-pill</a>.</p>
<p><a href="pre_2021/reference/../datasheets/black-pill/black-pill-pinout.pdf">Pinout de la carte</a></p>
<p><a href="pre_2021/reference/../datasheets/black-pill/black-pill-schematic.pdf">Schematic de la carte</a></p>
<p><a href="https://wiki.stm32duino.com/index.php?title=Black_Pill">Plus d'informations sur la carte</a></p>
<hr />
<h2 id="quartz"><a class="header" href="#quartz">Quartz</a></h2>
<p>Le microcontroleur a besoin d'un signal d'horloge fix√© pour pouvoir fonctionner correctement. Ce signal est g√©n√©r√© par un <a href="https://fr.wikipedia.org/wiki/Quartz_(%C3%A9lectronique)">quartz</a> qu'il faut choisir selon plusieurs crit√®res.</p>
<p>Le quartz a √©galement besoin de composants externes pour fonctionner correctement : il faut ajouter 2 condensateurs de m√™me valeur et √©ventuellement une r√©sistance, selon le sch√©ma suivant :</p>
<p><img src="pre_2021/reference/../images/components/Schema_quartz.png" alt="Schema_quartz" /></p>
<p>Le condensateur <a href="https://www.codecogs.com/eqnedit.php?latex=C_S" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_S" title="C_S" /></a> correspond √† la capacit√© parasite due aux fils. On peut l'approximer √† 5 pF dans les calculs.</p>
<p><strong>1. La marge de gain</strong></p>
<p>Pour faire naitre les oscillations dans le cristal, il faut s'assurer que la transconductance interne du microcontroleur (<a href="https://www.codecogs.com/eqnedit.php?latex=g_m" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g_m" title="g_m" /></a>) est au moins 5 fois sup√©rieure √† celle du quartz choisi.
La marge de gain se calcule gr√¢ce a la formule suivante :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=Gain_{margin}=\frac{g_m}{g_{mcrit}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Gain_{margin}=\frac{g_m}{g_{mcrit}}" title="Gain_{margin}=\frac{g_m}{g_{mcrit}}" /></a></p>
<p>Avec <a href="https://www.codecogs.com/eqnedit.php?latex=g_{mcrit}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g_{mcrit}" title="g_{mcrit}" /></a> donn√© par la formule :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=g_{mcrit}&space;=&space;4*ESR*(2\pi&space;F)^2*(C_0&space;&plus;&space;C_L)^2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g_{mcrit}&space;=&space;4*ESR*(2\pi&space;F)^2*(C_0&space;&plus;&space;C_L)^2" title="g_{mcrit} = 4*ESR*(2\pi F)^2*(C_0 + C_L)^2" /></a></p>
<p>O√π :</p>
<ul>
<li><a href="https://www.codecogs.com/eqnedit.php?latex=\textrm{ESR}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\textrm{ESR}" title="\textrm{ESR}" /></a> = <em>Equivalent Series Resistor</em> : la r√©sistance s√©rie √©quivalente du quartz (donn√©e par le fabriquant, elle d√©pend de la fr√©quence de fonctionnement).</li>
<li><a href="https://www.codecogs.com/eqnedit.php?latex=\textrm{F}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\textrm{F}" title="\textrm{F}" /></a> = Fr√©quence de fonctionnement du quartz (donn√©e par le fabriquant).</li>
<li><a href="https://www.codecogs.com/eqnedit.php?latex=C_0" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_0" title="C_0" /></a> = <em>Shunt capacitance</em> : c'est la valeur de la capacit√© r√©sultante des √©lectrodes du quartz (donn√©e par le fabriquant).</li>
<li><a href="https://www.codecogs.com/eqnedit.php?latex=C_L" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_L" title="C_L" /></a> = <em>Load capacitance</em> (donn√©e par le fabriquant)</li>
</ul>
<p>La valeur de <a href="https://www.codecogs.com/eqnedit.php?latex=g_m" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g_m" title="g_m" /></a> se trouve dans la datasheet du microcontr√¥leur.</p>
<p>Si la marge de gain calcul√©e est bien sup√©rieure √† 5, on peut passer √† l'√©tape suivante. Sinon, il faut choisir un autre quartz avec un <a href="https://www.codecogs.com/eqnedit.php?latex=g_m" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g_m" title="g_m" /></a> plus petit.</p>
<p><strong>2. Choix des condensateurs externes <a href="https://www.codecogs.com/eqnedit.php?latex=C_{L1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_{L1}" title="C_{L1}" /></a> et <a href="https://www.codecogs.com/eqnedit.php?latex=C_{L2}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_{L2}" title="C_{L2}" /></a></strong></p>
<p>On choisit les condensateurs de mani√®re √† respecter la relation :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=C_L-C_S&space;=&space;\frac{C_{L1}*C_{L2}}{C_{L1}&plus;C_{L2}]}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_L-C_S&space;=&space;\frac{C_{L1}*C_{L2}}{C_{L1}&plus;C_{L2}]}" title="C_L-C_S = \frac{C_{L1}*C_{L2}}{C_{L1}+C_{L2}]}" /></a></p>
<p>Si on prend <a href="https://www.codecogs.com/eqnedit.php?latex=C_{L1}=C_{L2}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_{L1}=C_{L2}" title="C_{L1}=C_{L2}" /></a>, on peut choisir <a href="https://www.codecogs.com/eqnedit.php?latex=C_{L1}=C_{L2}=2(C_L-C_S)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_{L1}=C_{L2}=2(C_L-C_S)" title="C_{L1}=C_{L2}=2(C_L-C_S)" /></a>.</p>
<p><strong>3. Choix d'une r√©sistance externe <a href="https://www.codecogs.com/eqnedit.php?latex=R_{Ext}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?R_{Ext}" title="R_{Ext}" /></a></strong></p>
<p>Le quartz ne peut dissiper qu'une certaine puissance maximale donn√©e par le fabriquant : c'est le <em>Drive Level</em> du cristal. Si jamais la puissance dissip√©e par le quartz d√©passe cette valeur, celui-ci peut √™tre endommag√© et griller.</p>
<p>Pour √©viter cela, on peut choisir d'ajouter une r√©sistance externe qui va dissiper la puissance en trop. pour savoir si on a besoin de cette r√©sistance, il y a 2 mani√®res de proc√©der :</p>
<ul>
<li>
<p><strong>M√©thode 1 :</strong> Mesurer le courant <a href="https://www.codecogs.com/eqnedit.php?latex=I_Q" target="_blank"><img src="https://latex.codecogs.com/gif.latex?I_Q" title="I_Q" /></a> qui traverse le quartz pendant son fonctionnement √† l'aide d'une sonde et d'un oscilloscope. On obtient ensuite le courant maximal admissible (en valeur pic-√†-pic) par la formule :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=I_{Qmax_{pp}}&space;=&space;2\sqrt{\frac{2D_L}{ESR}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?I_{Qmax_{pp}}&space;=&space;2\sqrt{\frac{2D_L}{ESR}}" title="I_{Qmax_{pp}} = 2\sqrt{\frac{2D_L}{ESR}}" /></a></p>
<p>Si le courant mesur√© est plus important, il faut ajouter <a href="https://www.codecogs.com/eqnedit.php?latex=R_{Ext}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?R_{Ext}" title="R_{Ext}" /></a>. Sinon, on a trouv√© un quartz qui convient bravo !</p>
</li>
<li>
<p><strong>M√©thode 2 :</strong> Mesurer la tension aux bornes de <a href="https://www.codecogs.com/eqnedit.php?latex=C_{L1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_{L1}" title="C_{L1}" /></a> et en d√©duire le courant qui travers le quartz. Attention pour cette m√©thode il faut utiliser une sonde qui a une capacit√© en entr√©e inf√©rieure √† 1 pF. Le <em>Drive Level</em> est alors donn√© par la formule :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=D_L&space;=&space;\frac{ESR*(\pi*F*C_{tot})^2)*V_{pp}^2}{2}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?D_L&space;=&space;\frac{ESR*(\pi*F*C_{tot})^2)*V_{pp}^2}{2}" title="D_L = \frac{ESR*(\pi*F*C_{tot})^2)*V_{pp}^2}{2}" /></a></p>
<p>O√π <a href="https://www.codecogs.com/eqnedit.php?latex=C_{tot}&space;=&space;C_{L1}&plus;\frac{{C_S}}{2}&plus;C_{sonde}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_{tot}&space;=&space;C_{L1}&plus;\frac{{C_S}}{2}&plus;C_{sonde}" title="C_{tot} = C_{L1}+\frac{{C_S}}{2}+C_{sonde}" /></a> et <a href="https://www.codecogs.com/eqnedit.php?latex=V_{pp}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?V_{pp}" title="V_{pp}" /></a> est la valeur de tension pic-√†-pic mesur√©e √† l'oscilloscope.</p>
<p>Si le <em>Drive Level</em> calcul√© est sup√©rieure √† celui donn√© par le fabriquant, il faut ajouter <a href="https://www.codecogs.com/eqnedit.php?latex=R_{Ext}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?R_{Ext}" title="R_{Ext}" /></a>. Sinon, on a trouv√© un quartz qui convient bravo !</p>
</li>
</ul>
<p>Calcul de <a href="https://www.codecogs.com/eqnedit.php?latex=R_{Ext}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?R_{Ext}" title="R_{Ext}" /></a> :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=R_{Ext}&space;=&space;\frac{1}{2\pi&space;FC_{L2}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?R_{Ext}&space;=&space;\frac{1}{2\pi&space;FC_{L2}}" title="R_{Ext} = \frac{1}{2\pi FC_{L2}}" /></a></p>
<p><strong>ATTENTION :</strong> si on a ajout√© <a href="https://www.codecogs.com/eqnedit.php?latex=R_{Ext}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?R_{Ext}" title="R_{Ext}" /></a> il faut recalculer les valeurs de marges de gain en la prenant en compte :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=g_{mcrit}&space;=&space;4*(ESR&plus;R_{Ext})*(2\pi&space;F)^2*(C_0&plus;C_L)^2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g_{mcrit}&space;=&space;4*(ESR&plus;R_{Ext})*(2\pi&space;F)^2*(C_0&plus;C_L)^2" title="g_{mcrit} = 4*(ESR+R_{Ext})*(2\pi F)^2*(C_0+C_L)^2" /></a></p>
<p>V√©rifier que la marge de gain est toujours sup√©rieure √† 5. Si ce n'est pas le cas, il faut choisir un autre quartz. Sinon, on a trouv√© un quartz qui convient bravo !</p>
<p><strong>Exemple de calcul :</strong> Si on veut associer un quartz √† 8 MHZ au microcontr√¥leur <a href="pre_2021/reference//datasheets/stm32f103/STM32F103x8.pdf">STM32F103C8T6</a>. On trouve un quartz qui a la fr√©quence de travaille demand√©e sur un site de confiance : <a href="https://fr.farnell.com/fox-electronics/foxsdlf-080-20/crystal-8-0mhz-20pf-smd/dp/2063972">celui-ci</a> par exemple (<a href="pre_2021/reference/datasheets/quartz/Quartz_8Mhz.pdf">datasheet</a>).</p>
<p>D'apr√®s les 2 datasheets, les valeurs dont on a besoin pour les calculs sont les suivantes :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=g_m&space;=&space;25\,mA/V\\&space;\indent&space;F&space;=&space;8\,&space;MHz\\&space;\indent&space;C_0&space;=&space;7\,&space;pF\\&space;\indent&space;ESR&space;=&space;80&space;\,\Omega&space;\\&space;\indent&space;C_L&space;=&space;20&space;pF\\" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g_m&space;=&space;25\,mA/V\\&space;\indent&space;F&space;=&space;8\,&space;MHz\\&space;\indent&space;C_0&space;=&space;7\,&space;pF\\&space;\indent&space;ESR&space;=&space;80&space;\,\Omega&space;\\&space;\indent&space;C_L&space;=&space;20&space;pF\\" title="g_m = 25\,mA/V\\ \indent F = 8\, MHz\\ \indent C_0 = 7\, pF\\ \indent ESR = 80 \,\Omega \\ \indent C_L = 20 pF\\" /></a></p>
<p>On peut donc calculer notre marge de gain :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=g_{mcrit}&space;=&space;5.894.10^{-4}&space;\,A/V" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g_{mcrit}&space;=&space;5.894.10^{-4}&space;\,A/V" title="g_{mcrit} = 5.894.10^{-4} \,A/V" /></a> donc <a href="https://www.codecogs.com/eqnedit.php?latex=Gain_{margin}&space;=&space;\frac{25}{0.5894}&space;=&space;42.4&space;>>&space;5" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Gain_{margin}&space;=&space;\frac{25}{0.5894}&space;=&space;42.4&space;>>&space;5" title="Gain_{margin} = \frac{25}{0.5894} = 42.4 >> 5" /></a></p>
<p>Cette valeur de marge de gain √©tant largement suffisante, on peut calculer les valeurs de nos condensateurs :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=C_{L1}=C_{L2}=2(20-5)=30\,&space;pF" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_{L1}=C_{L2}=2(20-5)=30\,&space;pF" title="C_{L1}=C_{L2}=2(20-5)=30\, pF" /></a></p>
<p>Si jamais on devait ajouter une r√©sistance externe, il faudrait que sa valeur soit de :</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=R_{Ext}&space;=&space;\frac{1}{2\pi&space;*8.10^6*30.10^{-12}}=663&space;\,\Omega" target="_blank"><img src="https://latex.codecogs.com/gif.latex?R_{Ext}&space;=&space;\frac{1}{2\pi&space;*8.10^6*30.10^{-12}}=663&space;\,\Omega" title="R_{Ext} = \frac{1}{2\pi *8.10^6*30.10^{-12}}=663 \,\Omega" /></a></p>
<p>On aurait alors une marge de gain de 5 : il faudrait donc choisir un autre quartz ayant un ESR plus faible ou bien un <a href="https://www.codecogs.com/eqnedit.php?latex=C_L" target="_blank"><img src="https://latex.codecogs.com/gif.latex?C_L" title="C_L" /></a> plus petit.</p>
<p>Pour plus de pr√©cision, voir le <a href="pre_2021/reference//datasheets/quartz/Oscillator_choice_guide">guide du choix d'un quartz fourni par ST</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="carte-d√©placement"><a class="header" href="#carte-d√©placement">Carte d√©placement</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="carte-servomoteur"><a class="header" href="#carte-servomoteur">Carte servomoteur</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="carte-√©vitement"><a class="header" href="#carte-√©vitement">Carte √©vitement</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="carte-capteur-couleur"><a class="header" href="#carte-capteur-couleur">Carte capteur couleur</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="carte-pompe-√†-vide"><a class="header" href="#carte-pompe-√†-vide">Carte pompe √† vide</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="communication-test"><a class="header" href="#communication-test">Communication (test)</a></h1>
<p>Dans cette partie, on va parler un peu de la "<strong>communication</strong>" du Club (on s'adresse aux membres int√©ress√©s par cet aspect mais aussi et surtout au <em>pr√©sident</em> et √† son <em>secr√©taire</em> !)</p>
<h3 id="communication-interne"><a class="header" href="#communication-interne">Communication interne</a></h3>
<p>De fait, les gens au Club ont besoin de communiquer <em>entre eux</em> (pratique pour faire un projet √† plusieurs) : on utilisera <a href="https://gitter.im/club-robot-insat/">Gitter</a> pour √ßa ! Il existe aussi un groupe <a href="https://www.facebook.com/groups/809109805874317/?ref=bookmarks">Facebook</a> qui date, avec pas mal d'anciens dessus : n'h√©sitez pas √† demander √† vous y ajouter, et si vous avez des infos √† partager avec des tr√®s vieux, allez-y !
On utilise enfin le <a href="https://drive.google.com/drive/">drive</a> associ√© √† l'adresse gmail du Club, pour stocker les documents relatifs au secr√©tariat, √† la tr√©sorie, des photos, etc.</p>
<h3 id="communication-externe"><a class="header" href="#communication-externe">Communication externe</a></h3>
<p>Ensuite, la communication du Club avec <em>l'ext√©rieur</em> est √©galement primordiale. On entend par l√† :</p>
<ul>
<li>communication (publications) sur notre <strong>page <a href="https://www.facebook.com/ClubRobotINSAT/">Facebook</a></strong></li>
<li>r√©ponse aux messages &amp; questions re√ßus <em>via</em> <strong>messenger</strong></li>
<li>r√©ponse aux messages &amp; questions re√ßus par <strong>e-mails</strong></li>
<li>communication (e-mails) avec nos <strong>sponsors</strong> : les informer r√©guli√®rement des avanc√©es du projet, etc.</li>
<li>communication (e-mails) avec l'<strong>INSA</strong> (GEI, service communication, GM, etc.) : idem</li>
<li>communication (publications) sur notre <strong>site <a href="https://etud.insa-toulouse.fr/~club_robot/">web</a></strong> (car oui il existe un site web ! (qui date lui aussi, qu'on essaie de garder √† jours mais que de jeunes gens motiv√©s pourraient tr√®s bien refaire un jour !))</li>
</ul>
<p><em>Tout au long de l'ann√©e</em>, pas mal de choses sont √† promouvoir autour du Club (√©v√©nements, vie quotidienne, etc) et on en parle <a href="pre_2021/com//com/ext">ici</a>, avec une petite check-liste pour ne jamais √™tre perdu !</p>
<h3 id="pleins-dimages-"><a class="header" href="#pleins-dimages-">Pleins d'images !</a></h3>
<p>Pour tous ces aspects de communication, de nombreuses <a href="pre_2021/com/">ressources</a> (images, documents, etc) existent, et on vous les pr√©sente <a href="pre_2021/com/">ici</a> ! Vous y trouverez des <strong>logos</strong>, de jolies <strong>infographies</strong>, plein de choses (voir bient√¥t des tutos peut-√™tre^^) qui vous permettront de pr√©senter le Club sous son meilleur jour ! (m√™me s'il y fait beau tous les jours :) )</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interne-entre-nous"><a class="header" href="#interne-entre-nous">Interne (entre nous)</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gitter"><a class="header" href="#gitter">Gitter</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="messengerfacebook"><a class="header" href="#messengerfacebook">Messenger/Facebook</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="externe"><a class="header" href="#externe">Externe</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="site"><a class="header" href="#site">Site</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="page-facebook"><a class="header" href="#page-facebook">Page Facebook</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ressources--images"><a class="header" href="#ressources--images">Ressources &amp; images</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
