<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Communication avec le hardware - Documentation Club Robot Insa Toulouse</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../outils_communs/index.html"><strong aria-hidden="true">2.</strong> ‚öôÔ∏è Outils Communs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../outils_communs/git.html"><strong aria-hidden="true">2.1.</strong> Git</a></li><li class="chapter-item expanded "><a href="../outils_communs/dual_boot.html"><strong aria-hidden="true">2.2.</strong> Dual Boot</a></li><li class="chapter-item expanded "><a href="../outils_communs/ide.html"><strong aria-hidden="true">2.3.</strong> IntelliJ et STM32Cube</a></li></ol></li><li class="chapter-item expanded "><a href="../management/index.html"><strong aria-hidden="true">3.</strong> üßë‚Äçüíº Organisation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../management/gestion_de_projet.html"><strong aria-hidden="true">3.1.</strong> Gestion de projet</a></li><li class="chapter-item expanded "><a href="../management/gestion_de_lequipe.html"><strong aria-hidden="true">3.2.</strong> Gestion de l'√©quipe</a></li><li class="chapter-item expanded "><a href="../management/gestion_de_la_communication.html"><strong aria-hidden="true">3.3.</strong> Gestion de la communication</a></li><li class="chapter-item expanded "><a href="../management/gestion_de_la_documentation.html"><strong aria-hidden="true">3.4.</strong> Gestion de la documentation</a></li></ol></li><li class="chapter-item expanded "><a href="../regles_cdf_2024.html"><strong aria-hidden="true">4.</strong> üìè R√®gles Coupe de France 2024</a></li><li class="chapter-item expanded "><a href="../architecture.html"><strong aria-hidden="true">5.</strong> üìà Architecture du projet</a></li><li class="chapter-item expanded "><a href="../informatique/index.html"><strong aria-hidden="true">6.</strong> üíª Informatique</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../informatique/mise_en_place/index.html"><strong aria-hidden="true">6.1.</strong> Mise en place</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../informatique/mise_en_place/connexion_a_la_raspberry.html"><strong aria-hidden="true">6.1.1.</strong> Connexion √† la Raspberry</a></li><li class="chapter-item expanded "><a href="../informatique/mise_en_place/ide.html"><strong aria-hidden="true">6.1.2.</strong> IDE</a></li><li class="chapter-item expanded "><a href="../informatique/mise_en_place/repertoire_de_travail.html"><strong aria-hidden="true">6.1.3.</strong> R√©pertoire de travail</a></li><li class="chapter-item expanded "><a href="../informatique/mise_en_place/python.html"><strong aria-hidden="true">6.1.4.</strong> Python</a></li><li class="chapter-item expanded "><a href="../informatique/mise_en_place/ros2_dev_container_setup.html"><strong aria-hidden="true">6.1.5.</strong> ROS2 dev environment</a></li></ol></li><li class="chapter-item expanded "><a href="../informatique/architecture.html"><strong aria-hidden="true">6.2.</strong> Architecture du code</a></li><li class="chapter-item expanded "><a href="../informatique/communication.html" class="active"><strong aria-hidden="true">6.3.</strong> Communication avec le hardware</a></li><li class="chapter-item expanded "><a href="../informatique/lidar.html"><strong aria-hidden="true">6.4.</strong> D√©tection de l'adversaire : LIDAR</a></li><li class="chapter-item expanded "><a href="../informatique/robot.html"><strong aria-hidden="true">6.5.</strong> Cr√©ation d'un robot</a></li><li class="chapter-item expanded "><a href="../informatique/ros2-random-issues.html"><strong aria-hidden="true">6.6.</strong> ROS2 issues</a></li></ol></li><li class="chapter-item expanded "><a href="../elec_soft/index.html"><strong aria-hidden="true">7.</strong> üë®‚Äçüíª Electronique Logicielle</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../elec_soft/index.html"><strong aria-hidden="true">7.1.</strong> Code embarqu√©</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../elec_soft/code/c.html"><strong aria-hidden="true">7.1.1.</strong> Langage C</a></li></ol></li><li class="chapter-item expanded "><a href="../elec_soft/stm32/index.html"><strong aria-hidden="true">7.2.</strong> STM32</a></li><li class="chapter-item expanded "><a href="../elec_soft/stm32cubeide/index.html"><strong aria-hidden="true">7.3.</strong> STM32CubeIDE</a></li><li class="chapter-item expanded "><a href="../elec_soft/stmlib/index.html"><strong aria-hidden="true">7.4.</strong> STMLIB</a></li><li class="chapter-item expanded "><a href="../elec_soft/elecsoft_checklist.html"><strong aria-hidden="true">7.5.</strong> Elecsoft Checklist 1o1 üò¢</a></li></ol></li><li class="chapter-item expanded "><a href="../elec_hard/index.html"><strong aria-hidden="true">8.</strong> ‚ö° Electronique Mat√©rielle (Elec-hard)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../elec_hard/introduction.html"><strong aria-hidden="true">8.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../elec_hard/Etapes-design.html"><strong aria-hidden="true">8.2.</strong> Proc√©d√© de design</a></li><li class="chapter-item expanded "><a href="../elec_hard/PCB.html"><strong aria-hidden="true">8.3.</strong> Qu'est-ce qu'un PCB ?</a></li><li class="chapter-item expanded "><a href="../elec_hard/KiCad.html"><strong aria-hidden="true">8.4.</strong> Une introduction au KiCad</a></li><li class="chapter-item expanded "><a href="../elec_hard/Fabrication.html"><strong aria-hidden="true">8.5.</strong> Fabrication</a></li><li class="chapter-item expanded "><a href="../elec_hard/design-rules.html"><strong aria-hidden="true">8.6.</strong> R√®gles de jeu - checklist</a></li><li class="chapter-item expanded "><a href="../elec_hard/autres/index.html"><strong aria-hidden="true">8.7.</strong> Autres</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../elec_hard/autres/Moteur-Pas_a_pas.html"><strong aria-hidden="true">8.7.1.</strong> Moteur pas √† pas</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../mecanique/index.html"><strong aria-hidden="true">9.</strong> ü¶æ M√©canique</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../mecanique/utilisation-de-creo.html"><strong aria-hidden="true">9.1.</strong> Guide d'utilisation Creo</a></li><li class="chapter-item expanded "><a href="../mecanique/installation-de-creo.html"><strong aria-hidden="true">9.2.</strong> Guide d'installation de Creo</a></li><li class="chapter-item expanded "><a href="../mecanique/tips-de-meca.html"><strong aria-hidden="true">9.3.</strong> Quelques Tips √† connaitre</a></li></ol></li><li class="chapter-item expanded "><a href="../retour_dexperiences/index.html"><strong aria-hidden="true">10.</strong> üí°Retour d'exp√©riences</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../retour_dexperiences/retour_dexperiences/cdf_2024.html"><strong aria-hidden="true">10.1.</strong> Ann√©e 2023-2024</a></li><li class="chapter-item expanded "><a href="../retour_dexperiences/retour_dexperiences/cdf_2023.html"><strong aria-hidden="true">10.2.</strong> Ann√©e 2022-2023</a></li><li class="chapter-item expanded "><a href="../retour_dexperiences/retour_dexperiences/cdf_2022.html"><strong aria-hidden="true">10.3.</strong> Ann√©e 2021-2022</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/doc-pre-2021-index.html"><strong aria-hidden="true">11.</strong> üìö Doc pre-2021</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/intro.html"><strong aria-hidden="true">11.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../pre_2021/outils_communs/index.html"><strong aria-hidden="true">11.2.</strong> Outils Communs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/outils_communs/dual_boot.html"><strong aria-hidden="true">11.2.1.</strong> Dual Boot</a></li><li class="chapter-item expanded "><a href="../pre_2021/outils_communs/git.html"><strong aria-hidden="true">11.2.2.</strong> Git</a></li><li class="chapter-item expanded "><a href="../pre_2021/outils_communs/ide.html"><strong aria-hidden="true">11.2.3.</strong> CLion</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/info/index.html"><strong aria-hidden="true">11.3.</strong> Informatique</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/info/mise_en_place/index.html"><strong aria-hidden="true">11.3.1.</strong> Mise en place</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/info/mise_en_place/ide.html"><strong aria-hidden="true">11.3.1.1.</strong> IDE</a></li><li class="chapter-item expanded "><a href="../pre_2021/info/mise_en_place/repertoire_de_travail.html"><strong aria-hidden="true">11.3.1.2.</strong> R√©pertoire de travail</a></li><li class="chapter-item expanded "><a href="../pre_2021/info/mise_en_place/compilation.html"><strong aria-hidden="true">11.3.1.3.</strong> Compilation</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/info/outils/index.html"><strong aria-hidden="true">11.3.2.</strong> Prise en main des outils</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/info/outils/cmake.html"><strong aria-hidden="true">11.3.2.1.</strong> CMake</a></li><li class="chapter-item expanded "><a href="../pre_2021/info/outils/petrilab.html"><strong aria-hidden="true">11.3.2.2.</strong> PetriLab</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/info/explications/index.html"><strong aria-hidden="true">11.3.3.</strong> Explications du code</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/info/explications/racine.html"><strong aria-hidden="true">11.3.3.1.</strong> Architecture de la racine</a></li><li class="chapter-item expanded "><a href="../pre_2021/info/explications/architecture.html"><strong aria-hidden="true">11.3.3.2.</strong> Vue globale du projet</a></li><li class="chapter-item expanded "><a href="../pre_2021/info/explications/communication.html"><strong aria-hidden="true">11.3.3.3.</strong> Communication avec le hardware</a></li><li class="chapter-item expanded "><a href="../pre_2021/info/explications/lidar.html"><strong aria-hidden="true">11.3.3.4.</strong> D√©tection de l'adversaire : LIDAR</a></li><li class="chapter-item expanded "><a href="../pre_2021/info/explications/robot.html"><strong aria-hidden="true">11.3.3.5.</strong> Cr√©ation d'un robot</a></li><li class="chapter-item expanded "><a href="../pre_2021/info/explications/simu.html"><strong aria-hidden="true">11.3.3.6.</strong> Architecture du simulateur</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/elec_soft/index.html"><strong aria-hidden="true">11.4.</strong> Electronique Logicielle</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/elec_soft/organisation/index.html"><strong aria-hidden="true">11.4.1.</strong> Organisation du code</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_soft/mise_en_place/index.html"><strong aria-hidden="true">11.4.2.</strong> Mise en place</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/elec_soft/mise_en_place/compile.html"><strong aria-hidden="true">11.4.2.1.</strong> Compilation</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_soft/mise_en_place/repo.html"><strong aria-hidden="true">11.4.2.2.</strong> R√©pertoire de travail</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_soft/mise_en_place/ide.html"><strong aria-hidden="true">11.4.2.3.</strong> IDE</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_soft/mise_en_place/flash.html"><strong aria-hidden="true">11.4.2.4.</strong> Flashage</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/elec_soft/apprendre_rust.html"><strong aria-hidden="true">11.4.3.</strong> Apprendre Rust</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_soft/modules/index.html"><strong aria-hidden="true">11.4.4.</strong> Communication des modules avec l'info</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/index.html"><strong aria-hidden="true">11.5.</strong> Electronique mat√©rielle</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/mise_en_place/tools.html"><strong aria-hidden="true">11.5.1.</strong> Mise en place</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/mise_en_place/folders.html"><strong aria-hidden="true">11.5.1.1.</strong> Organisation</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/mise_en_place/install_git.html"><strong aria-hidden="true">11.5.1.2.</strong> Installation</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/kicad.html"><strong aria-hidden="true">11.5.2.</strong> Pr√©parer ta carte</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/tips&tricks.html"><strong aria-hidden="true">11.5.3.</strong> Conseils et outils usuels</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/production.html"><strong aria-hidden="true">11.5.4.</strong> Tirer une carte</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/references/index.html"><strong aria-hidden="true">11.5.5.</strong> R√©f√©rences</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/references/ethernet.html"><strong aria-hidden="true">11.5.5.1.</strong> Utilisation du module ethernet</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/references/ref_cartes.html"><strong aria-hidden="true">11.5.5.2.</strong> Annexe : liste des cartes du Club</a></li><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/references/ref_composants.html"><strong aria-hidden="true">11.5.5.3.</strong> Annexe : liste des composants usuels</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/elec_mat/cablage.html"><strong aria-hidden="true">11.5.6.</strong> Cablage Robot</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/reference/index.html"><strong aria-hidden="true">11.6.</strong> Documents de r√©f√©rence</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/reference/commun.html"><strong aria-hidden="true">11.6.1.</strong> Communs</a></li><li class="chapter-item expanded "><a href="../pre_2021/reference/deplacement.html"><strong aria-hidden="true">11.6.2.</strong> Carte d√©placement</a></li><li class="chapter-item expanded "><a href="../pre_2021/reference/servomoteur.html"><strong aria-hidden="true">11.6.3.</strong> Carte servomoteur</a></li><li class="chapter-item expanded "><a href="../pre_2021/reference/evitement.html"><strong aria-hidden="true">11.6.4.</strong> Carte √©vitement</a></li><li class="chapter-item expanded "><a href="../pre_2021/reference/couleur.html"><strong aria-hidden="true">11.6.5.</strong> Carte capteur couleur</a></li><li class="chapter-item expanded "><a href="../pre_2021/reference/pompe.html"><strong aria-hidden="true">11.6.6.</strong> Carte pompe √† vide</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/com/index.html"><strong aria-hidden="true">11.7.</strong> Communication (test)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/com/int/index.html"><strong aria-hidden="true">11.7.1.</strong> Interne (entre nous)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/com/int/gitter.html"><strong aria-hidden="true">11.7.1.1.</strong> Gitter</a></li><li class="chapter-item expanded "><a href="../pre_2021/com/int/fb.html"><strong aria-hidden="true">11.7.1.2.</strong> Messenger/Facebook</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/com/ext/index.html"><strong aria-hidden="true">11.7.2.</strong> Externe</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pre_2021/com/ext/site.html"><strong aria-hidden="true">11.7.2.1.</strong> Site</a></li><li class="chapter-item expanded "><a href="../pre_2021/com/ext/fb.html"><strong aria-hidden="true">11.7.2.2.</strong> Page Facebook</a></li></ol></li><li class="chapter-item expanded "><a href="../pre_2021/com/res/md.html"><strong aria-hidden="true">11.7.3.</strong> Ressources & images</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Documentation Club Robot Insa Toulouse</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="communication-avec-le-hardware-can-bus"><a class="header" href="#communication-avec-le-hardware-can-bus">Communication avec le hardware: CAN Bus</a></h1>
<p>La communication avec le hardware est essentielle pour assurer le bon fonctionnement du robot. Cette section se concentre sur le bus CAN, un choix strat√©gique en raison de sa robustesse et de sa rapidit√©.</p>
<h2 id="quest-ce-que-le-bus-can-"><a class="header" href="#quest-ce-que-le-bus-can-">Qu'est ce que le Bus CAN ?</a></h2>
<p>Le bus CAN (Controller Area Network) est un bus de communication s√©rie largement utilis√© dans l'industrie. Il offre une communication rapide et fiable avec plusieurs modules simultan√©ment. Pour en savoir plus sur son fonctionnement, consultez ces documents:</p>
<ul>
<li><a href="https://www.ti.com/lit/an/sloa101b/sloa101b.pdf?ts=1633140726383&amp;ref_url=https%3A%2F%2Fwww.google.com%2F">Description g√©n√©rale du fonctionnement</a></li>
<li><a href="https://www.csselectronics.com/pages/can-bus-simple-intro-tutoria">tutoriel explicatif</a>.</li>
</ul>
<h2 id="mat√©riel-utilis√©-pour-le-bus-can"><a class="header" href="#mat√©riel-utilis√©-pour-le-bus-can">Mat√©riel utilis√© pour le bus CAN</a></h2>
<p>CAN Transceiver : Composant interm√©diaire pour produire les signaux CANL et CANH et les transporter dans le r√©seau.</p>
<p>On utilise 2 mod√®les. On utilise le <strong>MCP2515</strong> et le <strong>MCP2551</strong>.</p>
<p>Datasheets:</p>
<ul>
<li><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/20001667G.pdf">Datasheet MCP2551</a></li>
<li><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/MCP2515-Stand-Alone-CAN-Controller-with-SPI-20001801J.pdf">Datasheet MCP2515</a></li>
</ul>
<h3 id="diff√©rence-entre-mcp2515-et-mcp2551"><a class="header" href="#diff√©rence-entre-mcp2515-et-mcp2551">Diff√©rence entre MCP2515 et MCP2551</a></h3>
<p>Le <strong>MCP2515</strong> est un contr√¥leur CAN qui permet de communiquer avec le bus CAN via SPI. Il est utilis√© pour envoyer et recevoir des messages CAN. Il est connect√© √† la Raspberry Pi via SPI.</p>
<p>Le <strong>MCP2551</strong> est un transceiver CAN plus simple qui permet de convertir les signaux TX et RX en signaux CANH et CANL. Il est compris dans le MCP2515 mais on l'utilise aussi pour communiquer avec la STM32.</p>
<h2 id="utilisation-du-bus-can"><a class="header" href="#utilisation-du-bus-can">Utilisation du bus CAN</a></h2>
<h3 id="param√®tres-dalimentation-du-bus"><a class="header" href="#param√®tres-dalimentation-du-bus">Param√®tres d'alimentation du bus</a></h3>
<ul>
<li>Alimentation : <strong>5V</strong></li>
<li>Courant : 100mA (en m√©moire dans M3)</li>
<li>Ne pas oublier de mettre un bouchon d'imp√©dance (50 OU 120 Ohm) en fin du cable CAN</li>
</ul>
<h3 id="connexion-du-mcp2551-pour-stm32"><a class="header" href="#connexion-du-mcp2551-pour-stm32">Connexion du MCP2551 (Pour STM32)</a></h3>
<p><img src="../images/info/CAN_BUS_MCP2551_Connexion.png" alt="Connexion MCP2551" /></p>
<p><strong>R√©glage du slope-rate</strong> :</p>
<p>Pour changer le slope-rate on change la valeur de R connecter sur RS.</p>
<h3 id="connexion-du-mcp2515-spican---raspberry-pi"><a class="header" href="#connexion-du-mcp2515-spican---raspberry-pi">Connexion du MCP2515 (SPI+CAN -&gt; Raspberry Pi)</a></h3>
<p>Connecter les pins du transceiver SI, SO, SCK, INT et CS comme ci dessous.</p>
<p>:warning: Le VCC doit √™tre sur du <strong>5V</strong> contrairement √† ce sch√©ma, ne pas oublier le ground.</p>
<p><img src="../images/info/CAN_Raspberry_Transreceiver_Connexion.png" alt="Connexion entre Raspberry et transreceiver" /></p>
<p><img src="../images/info/CAN_Transreceiver_Pinout.png" alt="CAN Transreceiver pinout" /></p>
<p>Fichier <code>/boot/config.txt</code> √† mettre pour activer la connexion SPI avec le MCP au moment de boot dans la rpi:</p>
<pre><code># For more options and information see
# http://rptl.io/configtxt
# Some settings may impact device functionality. See link above for details

# Uncomment some or all of these to enable the optional hardware interfaces
#dtparam=i2c_arm=on
#dtparam=i2s=on

dtparam=spi=on

# Enable audio (loads snd_bcm2835)
dtparam=audio=on

# Additional overlays and parameters are documented
# /boot/firmware/overlays/README

# Automatically load overlays for detected cameras
camera_auto_detect=1

# Automatically load overlays for detected DSI displays
display_auto_detect=1

# Automatically load initramfs files, if found
auto_initramfs=1

# Enable DRM VC4 V3D driver
dtoverlay=vc4-kms-v3d
max_framebuffers=2

# Don't have the firmware create an initial video= setting in cmdline.txt.
# Use the kernel's default instead.
disable_fw_kms_setup=1

# Run in 64-bit mode
arm_64bit=1

# Disable compensation for displays with overscan
disable_overscan=1

# Run as fast as firmware / board allows
arm_boost=1

[cm4]
# Enable host mode on the 2711 built-in XHCI USB controller.
# This line should be removed if the legacy DWC2 controller is required
# (e.g. for USB device mode) or if USB support is not required.
otg_mode=1

[all]
dtoverlay=mcp2515-can0,oscillator=16000000,interrupt=25,spimaxfrequency=500000
dtoverlay=spi0-hw-cs

</code></pre>
<h3 id="exemple-de-connexion-entre-deux-stm32"><a class="header" href="#exemple-de-connexion-entre-deux-stm32">Exemple de connexion entre deux STM32</a></h3>
<p>‚ö†Ô∏è
Regarder plus en d√©tail la page d√©di√©e √† la communication entre STM32 pour plus d'informations.</p>
<p><img src="../images/info/CAN_BUS_STMs.jpg" alt="Connexion entre deux STM32" /></p>
<h2 id="tutoriel-pour-la-mise-en-place-du-bus-can-sur-la-raspberry-pi"><a class="header" href="#tutoriel-pour-la-mise-en-place-du-bus-can-sur-la-raspberry-pi">Tutoriel pour la mise en place du bus CAN sur la Raspberry Pi</a></h2>
<p><strong>Liste des √©tapes √† suivre</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"/>
Faire le circuit de la figure ci-dessus entre deux STM32</li>
<li><input disabled="" type="checkbox"/>
S'assurer que le bus CAN marche entre les deux STM32</li>
<li><input disabled="" type="checkbox"/>
Connecter le MCP2515 √† la Raspberry Pi comme sur la figure ci-dessus</li>
<li><input disabled="" type="checkbox"/>
Installer les paquets n√©cessaires sur la Raspberry Pi</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que l'interface can0 est bien pr√©sente au d√©marrage de la raspi avec <code>ifconfig</code></li>
<li><input disabled="" type="checkbox"/>
V√©rifier que la Raspberry Pi re√ßoit bien les messages envoy√©s par les STM32 et vice-versa</li>
</ul>
<h3 id="liste-des-potentiels-probl√®mes"><a class="header" href="#liste-des-potentiels-probl√®mes">Liste des potentiels probl√®mes</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
V√©rifier que le bus CAN est bien aliment√© (bouton on/off et branchements‚Ä¶)</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les fils sont bien branch√©s</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les r√©sistances de terminaison sont bien pr√©sentes</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les ground sont bien connect√©s entre eux</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que le montage est correct</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les STM32 sont bien aliment√©s</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les STM32 sont bien programm√©s pour envoyer et recevoir des messages CAN</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les signaux TX et RX sont bien connect√©s aux pins RX et TX des STM32</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les signaux sont bien pr√©sents sur le BUS CAN (oscilloscope ou serial analyzer)</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les bonnes donn√©es sont envoy√©es et re√ßues par les STM32</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les signaux envoy√©s par les STM32 sont bien re√ßus par la Raspberry Pi</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les modules SPI et CAN sont bien activ√©s sur la Raspberry Pi</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que les paquets n√©cessaires sont bien install√©s sur la Raspberry Pi</li>
<li><input disabled="" type="checkbox"/>
V√©rifier que l'interface can0 est bien pr√©sente au d√©marrage de la raspi avec <code>ifconfig</code></li>
<li><input disabled="" type="checkbox"/>
V√©rifier que la Raspberry Pi re√ßoit bien les messages envoy√©s par les STM32 et vice-versa</li>
</ul>
<h2 id="v√©rification-du-bon-fonctionnement-du-bus-can-sur-la-raspberry-pi"><a class="header" href="#v√©rification-du-bon-fonctionnement-du-bus-can-sur-la-raspberry-pi">V√©rification du bon fonctionnement du bus CAN sur la Raspberry Pi</a></h2>
<h3 id="v√©rification-de-linterface-can0"><a class="header" href="#v√©rification-de-linterface-can0">V√©rification de l'interface can0:</a></h3>
<ul>
<li>V√©rifier que l‚Äôinterface can0 est bien pr√©sente au d√©marrage de la raspi avec <code>ifconfig</code></li>
<li>On peut aussi v√©rifier dans les messages de d√©marrage du kernel que tout s‚Äôest bien pass√© avec <code>dmesg | grep can</code> et <code>dmesg | grep mcp</code></li>
<li>Sinon, red√©marrer la raspi <code>sudo reboot</code></li>
</ul>
<h3 id="format-des-messages"><a class="header" href="#format-des-messages">Format des messages</a></h3>
<ul>
<li><code>candump any</code> pour recevoir (en boucle)</li>
<li><code>cansend can0 000#00.00.00.00.00.00.00.00</code> pour envoyer (attention, donn√©es en hexa).</li>
</ul>
<h2 id="protocole-de-test-de-liam"><a class="header" href="#protocole-de-test-de-liam">Protocole de test de Liam</a></h2>
<p>Le Bus CAN fonctionne, mais comment le tester?</p>
<p>Tout d'abord, il faut la raspberry pi avec ubuntu ou raspbian install√© dessus (soit USB soit carte SD)
Un module qui fait office d'interface CAN est deja connect√© √† la raspberry pi</p>
<p>J'utilise une alim (celle de mon telephone, le chargeur) pour alimenter la raspberry. Ensuite j'utilise un cable micro HDMI pour afficher le terminal qu'il me faut pour mettre en place le bus CAN</p>
<p>Lorsque le terminal est activ√©, apres avoir renseign√© le login et mdp (pi et robotcdf respectivement), il faut mettre en place l'interface CAN avec la commande suivante :
sudo ip link set can0 up type can bitrate 125000</p>
<p>Le bitrate depend de nous, si on le change il faut s'assurer que les STM32 ont le meme bitrate associ√© √† leurs interfaces CAN.</p>
<p>Lorsque l'interface est UP , on peut brancher CANH et CANL de la raspi a un bus CAN compos√© de plusieurs STM32.
Nous avons pour l'instant deux cartes , une avec seulement une stm, une autre carte avec une stm et tout ce qu'il faut pour driver les moteurs a courant continu.</p>
<p>Si l'interface n'est pas UP, il faut verifier l'erreur en utilisant la commande dmesg . Dans mon cas, l'erreur etait due aux fils qui √©taient de mauvaise qualit√© et n'interconnectaient pas bien la raspi et le module CAN.</p>
<p>Il est dorenavant possible d'interagir avec le bus CAN en utilisant l'utilitaire can-utils :</p>
<p>On peut lancer par exemple : candump can0 pour observer le traffic sur le Bus CAN.
cansend can0 013#01.01.01.01.01.01.01.01 par exemple pour envoyer des donnees sur le bus CAN
( Dans le cas du code que j'ai ecrit sur la stm32, ceci permet d'ordonner √† la STM32 d'activer les moteurs )</p>
<p>Le code sur la STM32 utilise un filtre sur l'ID 013 et verifie le contenu du premier octet de la trame CAN.</p>
<p>En conclusion : Ne pas faire confiance aux breadboards, ni aux fils (jumper wires) qui ne garantissent pas des connexions fiables.
Il faut aussi faire attention quant a la configuration du filtre sur la stm32.
Attention egalement a l'oscillateur utilis√© sur la stm32, il faut bien definir l'oscillation sur le bus CAN (Interface FDCAN)</p>
<h2 id="documentation-diverse"><a class="header" href="#documentation-diverse">Documentation diverse</a></h2>
<p>Explorez ces ressources pour une compr√©hension plus approfondie du bus CAN et de son utilisation.</p>
<ul>
<li>
<p><a href="https://forums.raspberrypi.com/viewtopic.php?t=141052">Guide rapide</a></p>
</li>
<li>
<p><a href="https://www.beyondlogic.org/adding-can-controller-area-network-to-the-raspberry-pi/">Adding CAN to the Raspberry PI</a></p>
</li>
<li>
<p><a href="https://projects-raspberry.com/how-to-connect-raspberry-pi-to-can-bus/">How to connect Raspberry Pi to CAN bus</a></p>
</li>
<li>
<p><a href="https://forums.raspberrypi.com/viewtopic.php?t=311606"> Not able to setup can0. - Raspberry Pi Forums</a></p>
</li>
<li>
<p><a href="https://github.com/raspberrypi/linux/issues/4183">MCP251x failes setup CAN-bus communication with error=110 ¬∑ Issue #4183 ¬∑ raspberrypi/linux</a></p>
</li>
</ul>
<h2 id="notes"><a class="header" href="#notes">Notes</a></h2>
<ul>
<li>Description g√©n√©rale du fonctionnement:  <a href="https://www.ti.com/lit/an/sloa101b/sloa101b.pdf?ts=1633140726383&amp;ref_url=https%253A%252F%252Fwww.google.com%252F">https://www.ti.com/lit/an/sloa101b/sloa101b.pdf?ts=1633140726383&amp;ref_url=https%3A%2F%2Fwww.google.com%2F</a></li>
</ul>
<p>si √ßa marche pas, v√©rifier qu‚Äôil y a bien deux dispositifs sur le bus</p>
<p><a href="https://www.csselectronics.com/pages/can-bus-simple-intro-tutorial">CAN Bus Explained - A Simple Intro [2022 | The #1 Tutorial]</a></p>
<p><a href="https://github.com/TVAROBOT/STM32">GitHub - TVAROBOT/STM32: CAN bus on STM32F103C8T6 "Blue pill" uVision and CubeMX</a></p>
<p><a href="../ToDo%20d9dc46c3b25c4135a14d9b95735317f5/Decide%20communication%20protocol%20d89cb22bfdd24c7198646a51b15ae670/CAN%20Bus%20b5e77c9cfda440c08deaae066f118232.html">CAN Bus</a></p>
<p>datasheet : <a href="https://ww1.microchip.com/downloads/en/DeviceDoc/MCP2515-Stand-Alone-CAN-Controller-with-SPI-20001801J.pdf">https://ww1.microchip.com/downloads/en/DeviceDoc/MCP2515-Stand-Alone-CAN-Controller-with-SPI-20001801J.pdf</a></p>
<p><a href="https://forums.raspberrypi.com/viewtopic.php?t=141052">[quick-guide] CAN bus on raspberry pi with MCP2515 - Raspberry Pi Forums</a></p>
<p><a href="https://www.beyondlogic.org/adding-can-controller-area-network-to-the-raspberry-pi/">Adding CAN to the Raspberry PI</a></p>
<p><a href="https://projects-raspberry.com/how-to-connect-raspberry-pi-to-can-bus/"></a></p>
<p>apparemment c‚Äôest un probl√®me de fils, j‚Äôai les m√™mes erreurs qu‚Äôici :</p>
<p><a href="https://forums.raspberrypi.com/viewtopic.php?t=311606">[SOLVED] Not able to setup can0. - Raspberry Pi Forums</a></p>
<p><a href="https://github.com/raspberrypi/linux/issues/4183">MCP251x failes setup CAN-bus communication with error=110 ¬∑ Issue #4183 ¬∑ raspberrypi/linux</a></p>
<p>utilisation : cansend can0 <id>#{data}</p>
<p>id sur 3 nombres</p>
<p><a href="https://manpages.debian.org/testing/can-utils/candump.1.en.html">candump(1) - can-utils - Debian testing - Debian Manpages (apt install can-utils)</a></p>
<p>candump any re√ßoit en boucle</p>
<p>finalement on va laisser tomber spidev et utiliser bash directement</p>
<p>librairie python : spidev (jamais utilis√©)</p>
<p><a href="https://pypi.org/project/spidev/">https://pypi.org/project/spidev/</a></p>
<p><a href="https://www.sigmdel.ca/michel/ha/rpi/dnld/draft_spidev_doc_fr.pdf">https://www.sigmdel.ca/michel/ha/rpi/dnld/draft_spidev_doc_fr.pdf</a></p>
<p><a href="https://raspberrypi-aa.github.io/session3/spi.html">https://raspberrypi-aa.github.io/session3/spi.html</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../informatique/architecture.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../informatique/lidar.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../informatique/architecture.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../informatique/lidar.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
